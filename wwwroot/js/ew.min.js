/*!
 * JavaScript for ASP.NET
 */
!function(e,t,a){"use strict";var n=e=>e&&"object"==typeof e&&"default"in e?e:{default:e},i=n(e),l=n(t),r=n(a);let o=r.default.DateTime;var s={__proto__:null,userLevelId:function(e){return e&&!ew.checkInteger(e.value)?{userLevelId:ew.language.phrase("UserLevelIDInteger")}:parseInt(e.value,10)<1&&{userLevelId:ew.language.phrase("UserLevelIDIncorrect")}},userLevelName:function(e){return function(t){let a=document.getElementById("x_"+e);if(a&&t){let e=t.value.trim(),n=parseInt(a.value.trim(),10);if(0===n&&!ew.sameText(e,"Default"))return{userLevelName:ew.language.phrase("UserLevelDefaultName")};if(-1===n&&!ew.sameText(e,"Administrator"))return{userLevelName:ew.language.phrase("UserLevelAdministratorName")};if(-2===n&&!ew.sameText(e,"Anonymous"))return{userLevelName:ew.language.phrase("UserLevelAnonymousName")};if(n>0&&["anonymous","administrator","default"].includes(e.toLowerCase()))return{userLevelName:ew.language.phrase("UserLevelNameIncorrect")}}return!1}},required:function(e){return function(t){var a;let n=l.default(t),i=n.closest("#r_"+(null==(a=n.data("field"))?void 0:a.substring(2)));return i[0]||(i=n.closest("[id^=el]")),"none"!=i.css("display")&&(!(!t||ew.hasValue(t))&&{required:ew.language.phrase("EnterRequiredField").replace("%s",e)})}},fileRequired:function(e){return function(t){let a=document.getElementById("fn_"+t.id);return!(!a||ew.hasValue(a))&&{fileRequired:ew.language.phrase("EnterRequiredField").replace("%s",e)}}},mismatchPassword:function(e){let t;e.id.startsWith("c_")?t=e.id.replace(/^c_/,"x_"):"cpwd"==e.id&&(t="npwd");let a=document.getElementById(t);return e.value!==a.value&&{mismatchPassword:ew.language.phrase("MismatchPassword")}},between:function(e){let t,a;return e.id.startsWith("y_")?(t=document.getElementById(e.id.replace(/^y_/,"x_")),a=document.getElementById(e.id.replace(/^y_/,"z_"))):e.id.endsWith("_value_1")&&(t=document.getElementById(e.id.replace(/_value_1$/,"_value_0")),a=document.getElementById(e.id.replace(/_value_1$/,"_operator"))),!(!ew.hasValue(t)||"BETWEEN"!=l.default(a).val().toUpperCase()||ew.hasValue(e))&&{between:ew.language.phrase("EnterValue2")}},passwordStrength:function(e){let t=l.default(e);return!(ew.isMaskedPassword(e)||!t.hasClass("ew-password-strength")||t.data("validated"))&&{passwordStrength:ew.language.phrase("PasswordTooSimple")}},username:function(e){return function(t){return!(e||!t.value.match(new RegExp("["+ew.escapeRegExChars(ew.INVALID_USERNAME_CHARACTERS)+"]")))&&{username:ew.language.phrase("InvalidUsernameChars")}}},password:function(e){return function(t){return!(e||ew.ENCRYPTED_PASSWORD||!t.value.match(new RegExp("["+ew.escapeRegExChars(ew.INVALID_PASSWORD_CHARACTERS)+"]")))&&{password:ew.language.phrase("InvalidPasswordChars")}}},email:function(e){let t=ew.getValue(e);return!ew.checkEmail(t)&&{email:ew.language.phrase("IncorrectEmail")}},emails:function(e,t){return function(a){let n=ew.getValue(a);return!ew.checkEmails(n,e)&&{emails:t}}},datetime:function(e){return function(t){let a=ew.getValue(t);return!ew.checkDate(a,e)&&{datetime:ew.language.phrase("IncorrectDate").replace(/%s/g,e)}}},time:function(e){return function(t){let a=ew.getValue(t);return!ew.checkTime(a,e)&&{time:ew.language.phrase("IncorrectTime").replace(/%s/g,e)}}},float:function(e){let t=ew.getValue(e);return!ew.checkNumber(t)&&{float:ew.language.phrase("IncorrectFloat")}},range:function(e,t){return function(a){let n=ew.getValue(a);return!ew.checkRange(n,e,t)&&{range:ew.language.phrase("IncorrectRange").replace("%1",e).replace("%2",t)}}},integer:function(e){let t=ew.getValue(e);return!ew.checkInteger(t)&&{integer:ew.language.phrase("IncorrectInteger")}},phone:function(e){let t=ew.getValue(e);return!ew.checkPhone(t)&&{phone:ew.language.phrase("IncorrectPhone")}},zip:function(e){let t=ew.getValue(e);return!ew.checkZip(t)&&{zip:ew.language.phrase("IncorrectZip")}},creditCard:function(e){let t=ew.getValue(e);return!ew.checkCreditCard(t)&&{creditCard:ew.language.phrase("IncorrectCreditCard")}},ssn:function(e){let t=ew.getValue(e);return!ew.checkSsn(t)&&{ssn:ew.language.phrase("IncorrectSSN")}},guid:function(e){let t=ew.getValue(e);return!ew.checkGuid(t)&&{guid:ew.language.phrase("IncorrectGUID")}},regex:function(e){return function(t){let a=ew.getValue(t);return!ew.checkByRegEx(a,e)&&{regex:ew.language.phrase("IncorrectField")}}},url:function(e){let t=ew.getValue(e);return!ew.checkUrl(t)&&{url:ew.language.phrase("IncorrectUrl")}},custom:function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];return function(t){if("function"==typeof e){let n=ew.getValue(t);if(e(n,...a))return{custom:ew.language.phrase("IncorrectField")}}return!1}},captcha:function(e){return!(!e||ew.hasValue(e))&&{captcha:ew.language.phrase("EnterValidateCode")}},recaptcha:function(e){var t;return!(!e||ew.hasValue(e)||""!==(null==(t=grecaptcha)?void 0:t.getResponse(e.dataset.id)))&&{recaptcha:ew.language.phrase("ClickReCaptcha")}},minDate:function(e){return function(t){let a,n=ew.getValue(t),i=t.dataset.formatPattern;if((e="function"==typeof e?e():e)instanceof HTMLElement){let t=e.value,n=e.dataset.formatPattern;e.value&&e.dataset.formatPattern&&(a=ew.parseDate(t,n))}else e instanceof Date?a=o.fromJSDate(e,{zone:"utc"}):e instanceof o&&(a=e);if(n&&i&&a){if(ew.parseDate(n,i)<a)return{minDate:ew.language.phrase("IncorrectMinDate").replace("%s",ew.formatDateTime(a,ew.DATE_FORMAT+" "+ew.TIME_FORMAT))}}return!1}},maxDate:function(e){return function(t){let a,n=ew.getValue(t),i=t.dataset.formatPattern;if((e="function"==typeof e?e():e)instanceof HTMLElement){let t=e.value,n=e.dataset.formatPattern;e.value&&e.dataset.formatPattern&&(a=ew.parseDate(t,n))}else e instanceof Date?a=o.fromJSDate(e,{zone:"utc"}):e instanceof o&&(a=e);if(n&&i&&a){if(ew.parseDate(n,i)>a)return{maxDate:ew.language.phrase("IncorrectMaxDate").replace("%s",ew.formatDateTime(a,ew.DATE_FORMAT+" "+ew.TIME_FORMAT))}}return!1}},min:function(e){return function(t){let a,n=ew.parseNumber(ew.getValue(t));return(e="function"==typeof e?e():e)instanceof HTMLElement?a=ew.parseNumber(ew.getValue(e)):"string"==typeof e?a=ew.parseNumber(e):"number"==typeof e&&(a=e),"number"==typeof n&&"number"==typeof a&&n<a&&{min:ew.language.phrase("IncorrectMin").replace("%s",a)}}},max:function(e){return function(t){let a,n=ew.parseNumber(ew.getValue(t));return(e="function"==typeof e?e():e)instanceof HTMLElement?a=ew.parseNumber(ew.getValue(e)):"string"==typeof e?a=ew.parseNumber(e):"number"==typeof e&&(a=e),"number"==typeof n&&"number"==typeof a&&n>a&&{max:ew.language.phrase("IncorrectMax").replace("%s",a)}}}};function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function u(e){var t=function(e,t){if("object"!==d(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!==d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===d(t)?t:String(t)}function c(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function f(e,t,a){return t&&c(e.prototype,t),a&&c(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},h(e,t)}function m(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,h(e,t)}function g(e,t,a){return(t=u(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}l.default.batchSettings={type:"POST",contentType:"application/json",processData:!1,dataType:"json",toJSON:JSON.stringify,parse:e=>e},l.default.batchSetup=function(e){return l.default.extend(l.default.batchSettings,e)};var w=l.default.batch=function(e,t){return this instanceof w?("object"==typeof e&&(t=e,e=void 0),this.options=l.default.extend({},l.default.batchSettings,t),this.parent=l.default.ajaxSetup()._batch,this.requests=[],e&&this.add(e),this):new w(e,t)};l.default.extend(w.prototype,{add:function(e){var t;return l.default.ajaxSetup({_batch:this.parent||this}),null!=(t=e.name)&&t.startsWith("bound ")?e():e.call(l.default.ajaxSetup()._batch),this.parent||l.default.ajaxSetup({_batch:null}),this},clear:function(){this.requests=[]},send:function(e){e=e||{};var t=this;if(this.parent&&e.success){var a=this.parent.options.success;this.parent.options.success=function(t,n,i){e.success(t,n,i),a&&a(t,n,i)}}else if(this.requests.length){var n=l.default.map(this.requests,(function(e){return e.settings.data})),i=e.success,r=this.options.success;return e.success=function(e,a,n){t._deliver.call(t,e,a),r&&r(e,a,n),i&&i(e,a,n)},(e=l.default.extend({},this.options,e)).data||(e.data=l.default.batchSettings.toJSON(n)),l.default.ajax(e)}},_addRequest:function(e,t){this.requests.push({xhr:e,settings:t})},_deliver:function(e,t){var a,n,r=this,o=l.default.batchSettings.parse(e);null!=o&&null!=(a=o.error)&&a.description?i.default.alert(null==o||null==(n=o.error)?void 0:n.description):l.default.each(o,(function(e,a){var n;if(r.requests[e]){var i,l=r.requests[e];if(l.xhr.statusText=t,"success"===t)null==(i=l.settings.success)||i.call(l.xhr,a,t);null==(n=l.settings.complete)||n.call(l.xhr,t)}}))}});var v=l.default.ajax;function b(e,t){let a=this,n=l.default(a);this._initiated=!1,this.id=e,this.element=document.getElementById(e),this.$element=l.default(this.element),this.pageId=t,this.htmlForm=null,this.initSearchPanel=!1,this.modified=!1,this.emptyRow=null,this.multiPage=null,this.autoSuggests={},this.lists={},this.batch=new w,this.formKeyCountName="",this.submitWithFetch=!1,this.enableOnInit=!1,this.filterList=null,this.disableForm=function(){document.body.style.cursor="wait";let e=this.getForm();l.default(e.elements).filter(":submit:not(.dropdown-toggle), .ew-submit").prop("disabled",!0).addClass("disabled"),this.trigger("disabled")},this.enableForm=function(){let e=this.getForm(),t=l.default(e.elements);t.filter(".ew-disabled-element").removeClass("ew-disabled-element").prop("disabled",!1),t.filter(".ew-enabled-element").removeClass("ew-enabled-element").prop("disabled",!0),t.filter(":submit:not(.dropdown-toggle), .ew-submit").not(".ew-disabled").prop("disabled",!1).removeClass("disabled"),this.trigger("enabled"),document.body.style.cursor="default"},this.appendHidden=function(e){var t=this.getForm(),a=l.default(t),n=l.default(e).closest(".ew-form"),i=n.attr("id")+"$"+e.name;if(!a.find("input:hidden[name='"+i+"']")[0]){var r=n.find('[name="'+e.name+'"]').serializeArray();r.length?r.forEach((function(e,t){l.default('<input type="hidden" name="'+i+'">').val(e.value).appendTo(a)})):l.default('<input type="hidden" name="'+i+'">').val("").appendTo(a)}},this.canSubmit=async function(e){var t,n,i=this.getForm(),r=l.default(i);if(this.disableForm(),this.updateTextArea(),null!=(t=await(null==(n=this.validate)?void 0:n.call(this,e)))&&!t||r.find(".is-invalid")[0])this.enableForm();else{r.find("input[name^=sv_], input[name^=p_], [name*=_query_builder_rule_], .ew-template input, .ew-custom-option").prop("disabled",!0).addClass("ew-disabled-element"),r.find("[data-readonly=1][disabled]").prop("disabled",!1).addClass("ew-enabled-element");var o=r.find("input[name=detailpage]").map((function(e,t){return r.find("#"+t.value)[0]}));o.length>1&&o.each((function(e,t){l.default(t).find(":input").each((function(e,n){if(/^(fn_)?(x|o)\d*_/.test(n.name)){var i=o.not(t).find(":input[name='"+n.name+"']");i.length&&(a.appendHidden(n),i.each((function(){a.appendHidden(this)})))}}))}));let t={form:i,result:!0},n=l.default.Event("beforesubmit",{originalEvent:e});r.trigger(n,[t]);let s=await t.result;if(!n.isDefaultPrevented()&&(!0===s||l.default.isObject(s)&&s.value))return!0}return!1},this.submit=async function(e){var t,a;let n=this.getForm(),i=null==e||null==(t=e.originalEvent)||null==(a=t.submitter)?void 0:a.formAction;if(i&&(i=ew.parseUrl(i).pathname,n.setAttribute("action",i)),await this.canSubmit(e)){if(this.submitWithFetch){let e=n.getAttribute("action"),t=n.method.toUpperCase(),a=l.default(n).serialize();return ew.fetch(e,{method:t,body:a}).finally((()=>this.enableForm()))}n.submit()}else this.enableForm()},this.getList=function(e){var t,a;if(l.default.isObject(e)){let t=e;(e=t.name||t.id).includes("query_builder_rule")&&(e=t.dataset.field)}if(e=e.replace(/^(sv_)?[xy](\d*|\$rowindex\$)_|\[\]$/g,""),this.lists[e])return this.lists[e];let n=null==(t=this.getElement(e))||null==(a=t.dataset.field)?void 0:a.replace(/^x_|\[\]$/g,"");return n?this.lists[n]:{}},this.compileTemplates=function(){let e=Object.values(this.lists);for(let t of e)t.template&&l.default.isString(t.template)&&(t.template=l.default.templates(t.template))},this.getOptionTemplate=function(e){return e.template&&l.default.isString(e.template)&&(e.template=l.default.templates(e.template)),e.template},this.getForm=function(){var e,t;this.htmlForm||("FORM"==(null==(e=this.element)?void 0:e.tagName)?this.htmlForm=this.element:"DIV"==(null==(t=this.element)?void 0:t.tagName)&&(this.htmlForm=this.element.closest("form")));return this.htmlForm},this.getElement=function(e){return e?ew.getElement(e,this.$element):this.$element[0]},this.getElements=function(e){return ew.getElements(e,this.$element)},this.fixId=function(e,t,a){let n="",i=e.split(" ");i.length>1&&(n=i[0],a="",e=i[1]);let r=l.default.isNumber(a)?"x"+a+"_":"x_";return e=e.startsWith("x_")?e.replace(/^x_/,r):r+e,t&&!e.endsWith("[]")&&(e+="[]"),n?n+" "+e:e},this.updateList=function(e,t,a,n){var i;null!=t||(t=l.default.isString(e)?null==(i=Object.entries(this.lists).find((t=>t[0]==e.replace(/^x_/,""))))?void 0:i[1]:this.getList(e)),t.template&&l.default.isString(t.template)&&(t.template=l.default.templates(t.template));let r=this.element,o=t.parentFields.slice().map((e=>this.fixId(e,!1,a))),s=t.ajax&&!t.lookupOptions.length;return e=l.default.isString(e)?this.fixId(e,t.multiple,a):e,!s||n?ew.updateOptions.call(this,e,o,s,!1):[e,o.map((e=>ew.getOptionValues(e,r))),s,!1]},this.updateLists=function(e,t){var n;if(null===e)return;if("grid"==this.pageId&&!l.default.isNumber(e)&&!l.default.isUndefined(e))return;let i=this.getForm();if("confirm"==(null==i||null==(n=i.querySelector("input#confirm"))?void 0:n.value))return;let r=Object.entries(this.lists).map((t=>{let[a,n]=t;return"[name='"+this.fixId(a,n.multiple,e)+"']"})).join();if(r&&this.element.querySelector(r)&&Object.entries(this.lists).map((t=>{let[a,n]=t;return this.updateList(a,n,e)})).filter((e=>Array.isArray(e))).forEach((e=>this.batch.add(ew.updateOptions.bind(this,...e)))),this.batch.requests.length){if(void 0===e||t){let e=[],t=ew.ajaxBatchSize>0?ew.ajaxBatchSize:1;for(;this.batch.requests.length>t;){let a=new w;a.requests=this.batch.requests.splice(0,t),e.push(a.send({url:ew.getApiUrl(ew.API_LOOKUP_ACTION)}))}this.batch.requests.length>0&&e.push(this.batch.send({url:ew.getApiUrl(ew.API_LOOKUP_ACTION)})),l.default.when(...e).then((()=>l.default(document).trigger("updatedone",[{source:a,target:i}]))).fail((e=>console.log(e))).always((()=>this.batch.clear()))}}else l.default(document).trigger("updatedone",[{source:a,target:i}])},this.createAutoSuggest=function(e){var t=Object.assign({limit:ew.AUTO_SUGGEST_MAX_ENTRIES,form:this},ew.autoSuggestSettings,e);a.autoSuggests[e.id]=new ew.AutoSuggest(t)},this.initEditors=function(){var e=this.getForm();l.default(e.elements).filter("textarea.editor").each((function(e,t){var a=l.default(t).data("editor");!a||a.active||a.name.includes("$rowindex$")||a.create()}))},this.updateTextArea=function(e){var t=this.getForm();l.default(t.elements).filter("textarea.editor").each((function(t,a){var n=l.default(a).data("editor");return!(n&&(!e||n.name==e))||(n.save(),!e&&void 0)}))},this.destroyEditor=function(e){var t=this.getForm();l.default(t.elements).filter("textarea.editor").each((function(t,a){var n=l.default(a).data("editor");return!(n&&(!e||n.name==e))||(n.destroy(),!e&&void 0)}))},this.onError=function(e,t){return ew.onError(this,e,t)},this.initUpload=function(){var e=this.getForm();l.default(e.elements).filter("input:file:not([name*='$rowindex$'])").each((function(e){l.default.later(ew.AJAX_DELAY*e,null,ew.upload,this)}))},this.setupFilters=function(e,t){let n=this.id,i=this.filterList?this.filterList.data:null,r=l.default(".ew-save-filter[data-form="+n+"]").toggleClass("disabled",!i),o=l.default(".ew-delete-filter[data-form="+n+"]").toggleClass("disabled",!t.length).toggleClass("dropdown-toggle",!!t.length),s=o.parent("li").toggleClass("dropdown-submenu dropdown-hover",!!t.length).toggleClass("disabled",!t.length),d=r.parent("li").toggleClass("disabled",!i),u=function(e,t){ew.CLIENT_SEARCH_FILTER?localStorage.setItem(ew.PROJECT_NAME+"_"+e+"_filters",JSON.stringify(t)):ew.SERVER_SEARCH_FILTER&&(document.body.style.cursor="wait",l.default.ajax(ew.currentPage(),{type:"POST",dataType:"json",data:{ajax:"savefilters",filters:JSON.stringify(t)}}).done((function(e){var n;null!=(n=e[0])&&n.success&&(a.filterList.filters=t)})).always((function(){document.body.style.cursor="default"})))};if(d.off("click.ew").on("click.ew",(function(e){if(d.hasClass("disabled"))return!1;ew.prompt({input:"text",html:ew.language.phrase("EnterFilterName")},(e=>{(e=ew.sanitize(e))&&(t.push([e,i]),u(n,t))}),!0)})).prevAll().remove(),o.next("ul.dropdown-menu").remove(),t.length){let e=l.default('<ul class="dropdown-menu"></ul>');t.forEach(((a,i,r)=>{l.default('<li><a class="dropdown-item" data-index="'+i+'" data-ew-action="none">'+a[0]+"</a></li>").on("click",(function(e){let i=this.querySelector("a[data-index]").dataset.index;ew.prompt(ew.language.phrase("DeleteFilterConfirm").replace("%s",a[0]),(e=>{e&&(r.splice(i,1),u(n,t))}))})).appendTo(e),l.default('<li><a class="dropdown-item ew-reset-filter-list" data-index="'+i+'" data-ew-action="none">'+a[0]+"</a></li>").insertBefore(d).on("click",(function(e){let t={cmd:"resetfilter",filter:JSON.stringify(a[1])};ew.refresh(ew.fetch(ew.setLayout(ew.currentPage(),!1),{method:"POST",body:t}))}))})),l.default('<li class="dropdown-divider"></li>').insertBefore(d),s.append(e)}},this.on=function(){n.on(...arguments)},this.one=function(){n.one(...arguments)},this.off=function(){n.off(...arguments)},this.trigger=function(){n.trigger(...arguments)},this.init=function(){if(!this._initiated){var e=this.getForm();if(e){var t=l.default(e);this.compileTemplates(),/s(ea)?rch$/.test(this.id)&&(this.initSearchPanel&&!ew.hasFormData(e)&&l.default("#"+this.id+"_search_panel").removeClass("show"),l.default(".ew-table .ew-search-operator").text().trim()||l.default(".ew-table .ew-search-operator").parent("td").hide(),t.find("select[id^=z_]").each((function(){"BETWEEN"!=l.default(this).trigger("change").val()&&t.find("#w_"+this.id.substring(2)).trigger("change")}))),this.multiPage&&this.multiPage.render(),loadjs.ready(["editor"],(()=>setTimeout(this.initEditors.bind(this),0))),this.updateLists(),this.initUpload(),this.$element.is("form")&&(this.$element.find(".ew-detail-pages .ew-nav a[data-bs-toggle=tab]").on("shown.bs.tab",(function(e){var t=l.default(e.target.getAttribute("href")),a=t.find(".table-responsive.ew-grid-middle-panel"),n=t.closest(".container-fluid");a.width()>=n.width()?a.width(n.width()+"px"):a.width("auto")})),t.off("submit.ew").on("submit.ew",(function(t){let n={form:e,result:a.submit(t)},i=l.default.Event("aftersubmit",{originalEvent:t});return a.trigger(i,[n]),!1})),t.find("[data-field], .ew-priv").on("change",(function(){ew.CONFIRM_CANCEL&&(a.modified=!0)})),t.find("#btn-cancel[data-href]").on("click",(function(){a.updateTextArea();var n=this.dataset.href;a.modified&&ew.hasFormData(e)?ew.prompt(ew.language.phrase("ConfirmCancel"),(e=>{e&&(t.find("#btn-action").prop("disabled",!0),window.location=n)})):(t.find("#btn-action").prop("disabled",!0),window.location=n)}))),this._initiated=!0,this.$element.data("form",this),(this.enableOnInit||Array.from(e.elements).find((e=>e.matches("button.disabled.enable-on-init"))))&&this.enableForm(),this.trigger("initiated")}}},ew.forms.add(this)}l.default.ajax=function(e,t){"object"==typeof e&&(t=e,e=void 0);var a=(t=t||{}).beforeSend;return t.beforeSend=function(e,t){if(a){var n=a(e,t);if(!1===n)return n}if(t._batch)return t._batch._addRequest(e,t),!1},v.call(this,e,t)};let y=function(){function e(e,t,a){if(g(this,"name",""),g(this,"validators",[]),g(this,"_validate",!0),this.name=e,Array.isArray(t))for(let e of t)this.addValidator(e);else"function"==typeof t&&this.addValidator(t);this.invalid=a}var t=e.prototype;return t.addValidator=function(e){"function"==typeof e&&this.validators.push(e)},t.addError=function(e){if(e){var t;let a=null!=(t=this._error)?t:{};this._error={...a,...e},this.invalid=!0}},t.clearErrors=function(){this._error=null,this.invalid=!1},t.clearValidators=function(){this.validators=[]},t.validate=function(){let e=!0;if(this.clearErrors(),this._element&&this.shouldValidate&&Array.isArray(this.validators)){for(let t of this.validators){let a=t(this._element);!1!==a&&(this.addError(a),e=!1)}this.updateFeedback()}return e},t.resetInvalid=function(){var e,t,a,n;this.clearErrors(),null!=(e=this._element)&&null!=(t=e.classList)&&t.contains("is-invalid")&&!this._error&&this.addError({server:null==(a=this._element.closest(ew.fieldContainerSelector))||null==(n=a.querySelector(".invalid-feedback"))?void 0:n.innerHTML})},t.updateFeedback=function(){let e=this.errorMessage;if(this._element&&e){var t;let a=null==(t=this._element.closest(ew.fieldContainerSelector))?void 0:t.querySelector(".invalid-feedback");a&&(a.innerHTML=e),ew.setInvalid(this._element)}},t.focus=function(e){this._element&&ew.setFocus(this._element,e)},t.canFocus=function(){var e,t;let a=this._element;return a&&!(a.hidden&&"SELECTION-LIST"==!a.tagName||a.readonly||a.disabled||"hidden"==a.type||"none"==(null==(e=a.style)?void 0:e.display)||null!=(t=a.classList)&&t.contains("d-none"))},f(e,[{key:"error",get:function(){return this._error}},{key:"errorMessage",get:function(){return this._error?Array.from(Object.values(this._error)).join("<br>"):""}},{key:"shouldValidate",get:function(){return!this._checkbox||this._checkbox.checked}},{key:"element",get:function(){return this._element},set:function(e){var t,a;this._element=e,this._checkbox=null!=(t=this._element)&&null!=(a=t.id)&&a.match(/^[xy]_/)?document.getElementById(this._element.id.replace(/^[xy]_/,"u_").replace(/\[\]$/,"")):null}},{key:"value",get:function(){return this._element?ew.getValue(this._element):""}},{key:"focused",get:function(){return this._element&&this._element==document.activeElement}}]),e}(),_=function(e){function t(t,a){var n;return g(p(n=e.call(this,t,a)||this),"row",{}),g(p(n),"fields",{}),g(p(n),"validateRequired",!0),g(p(n),"autoFocus",!0),g(p(n),"autoFocusPreventScroll",!0),n.on("initiated",(function(){this.getForm().classList.contains("ew-wait")?this.one("enabled",(function(){this.setInvalid(),this.tryFocus()})):(this.setInvalid(),this.tryFocus())})),n}m(t,e);var a=t.prototype;return a.addField=function(e,t,a){e in this.fields||(this.fields[e]=new y(e,t,a))},a.getField=function(e){return this.fields[e]},a.addFields=function(e){if(Array.isArray(e))for(let t of e)Array.isArray(t)&&this.addField.apply(this,t)},a.addError=function(e,t){var a;t&&(this._error=null!=(a=this._error)?a:{},this._error[e]=t)},a.addCustomError=function(e,t,a){if(e in this.fields){let n=this.fields[e],i={custom:t};n.addError(i),this.setFieldElement(e,a),n.updateFeedback(),this.addError(e,i)}return!1},a.setFocus=function(e){let a=this.makeVisible(e)?t.focusDelay:0;if(e&&e!=document.activeElement&&e.focus){let n=!e.closest(".modal-body")&&t.autoFocusPreventScroll&&this.autoFocusPreventScroll;setTimeout((()=>{e.focus({preventScroll:n})}),a),this._focused=!0}},a.focus=function(){if(this.canFocus())for(let[t,a]of Object.entries(this.fields)){var e;if((a.invalid||null!=(e=this._error)&&e[t])&&(this.getFocusable(a),a.canFocus())){this.setFocus(a.element);break}}},a.getFocusable=function(e){null!=e.element||(e.element=this.getFieldElements(e.name)),e.canFocus()||(e.element=this.getFieldElements(e.name,0)),e.canFocus()||(e.element=this.getFieldElements(e.name,1))},a.tryFocus=function(e){if(!this.canFocus())return;if(!e&&(!t.autoFocus||!this.autoFocus||this._focused))return;if(!e&&this.invalid)return void this.focus();if(["add","edit"].includes(this.pageId)){let e=this.getForm(),t=Array.from(e.querySelectorAll("input[name=detailpage]")).find((e=>{var t;return null==(t=ew.forms.get(e.value))?void 0:t.invalid}));if(t)return void t.focus()}for(let[t,a]of Object.entries(this.fields))if(("string"!=typeof e||e===t)&&(a.element=null,this.getFocusable(a),a.canFocus()))return void this.setFocus(a.element);let a=this.element[ew.TABLE_BASIC_SEARCH];this.id.endsWith("srch")&&a&&a!=document.activeElement&&(a.focus({preventScroll:t.autoFocusPreventScroll&&this.autoFocusPreventScroll}),this._focused=!0)},a.canFocus=function(){var e,t;let a=this.element;return a&&!(a.hidden||"hidden"==a.type||"none"==(null==(e=a.style)?void 0:e.display)||null!=(t=a.classList)&&t.contains("d-none"))},a.makeVisible=function(e){if(this.multiPage)return this.multiPage.gotoPageByElement(e),!0;if(this.$element.is("div")){let e=this.$element.closest(".tab-pane");if(e[0]&&!e.hasClass("active"))return e.closest(".ew-nav").find("a[data-bs-toggle=tab][href='#"+e.attr("id")+"']").trigger("click"),!0}return!1},a.validateFields=function(e){null!=e||(e=this.getCurrentRowIndex()),e<2&&(this.value=null),this.row={},this._error=null;let t=!0;for(let a of Object.values(this.fields))a.element=this.getFieldElements(a.name,e),this.row[a.name]=a.value,a.element&&!a.validate()&&(this.addError(a.name,a.error),t=!1);if(this.value){Array.isArray(this.value)||(this.value=[this.value]);let t=parseInt(e,10)||0;t=t>1?t-1:0,this.value[t]={...this.row}}else this.value={...this.row};return this.focus(),t},a.validate=async function(e){var t,a,n,i;if(!this.validateRequired)return!0;let l=this.getForm();if("confirm"==(null==(t=l.querySelector("#confirm"))?void 0:t.value))return!0;if("update"==this.pageId&&!ew.updateSelected(l))return ew.alert(ew.language.phrase("NoFieldSelected")),!1;let r=0,o=l.querySelector(".ew-inline-insert"),s=(null==(a=l.querySelector("#action"))?void 0:a.value)||(null==(n=null!=(i=null==e?void 0:e.currentTarget)?i:o)?void 0:n.dataset.action),d=o?0:this.keyCount,u="gridinsert"==s||["insert","confirm"].includes(s)&&d,c=o?0:d||1;for(let e=o?0:1;e<=c;e++){var f,p;let t=d>=0?String(e):"";if(l.dataset.rowindex=t,["list","grid"].includes(this.pageId)){if(u&&this.emptyRow(t))continue;r++}if(!this.validateFields(t))return!1;if(null!=(f=await(null==(p=this.customValidate)?void 0:p.call(this,l)))&&!f)return this.focus(),!1}if(delete l.dataset.rowindex,"list"==this.pageId&&u&&0==r)return ew.alert({html:ew.language.phrase("NoAddRecord"),returnFocus:!1}),this.tryFocus(!0),!1;if(["add","edit"].includes(this.pageId)){let t=l.querySelectorAll("input[name=detailpage]");for(let a of t){var h;let t=ew.forms.get(a.value);if(null!=(h=await(null==t||null==t.validate?void 0:t.validate(e)))&&!h)return!1}}return!0},a.getCurrentRowIndex=function(){var e;return null!=(e=this.getForm().dataset.rowindex)?e:""},a.getValue=function(e){null!=e||(e=this.getCurrentRowIndex());let t={};for(let a of Object.values(this.fields)){null!=a.element||(a.element=this.getFieldElements(a.name,e)),t[a.name]=a.value}return t},a.getFieldValue=function(e,t){let a=this.getField(e);return a?(null!=t||(t=this.getCurrentRowIndex()),null!=a.element||(a.element=this.getFieldElements(a.name,t)),a.value):null},a.getFieldElements=function(e,t){return null!=t||(t=this.getCurrentRowIndex()),this.getElements("x"+t+"_"+e)||this.getElements("x"+t+"_"+e+"[]")||this.getElements(e)},a.setFieldElement=function(e,t){let a=this.getField(e);return a&&(a.element=this.getFieldElements(a.name,t)),null==a?void 0:a.element},a.setInvalid=function(e){let t=this.getForm();if("undefined"==typeof e&&this.formKeyCountName){let e=t.querySelector(".ew-inline-insert"),a=e?0:this.keyCount,n=e?0:a||1;for(let t=e?0:1;t<=n;t++){let e=a>=0?String(t):"";this.setInvalid(e)}}else{null!=e||(e="");for(let t of Object.values(this.fields))t.element=this.getFieldElements(t.name,e),e&&t.resetInvalid(),t.invalid&&(this.addError(t.name,t.error),this._focused||this.focus(),ew.setInvalid(t.element));["add","edit"].includes(this.pageId)&&t.querySelectorAll("input[name=detailpage]").forEach((e=>{var t;return null==(t=ew.forms.get(e.value))?void 0:t.setInvalid()}))}},f(t,[{key:"error",get:function(){return this._error}},{key:"invalid",get:function(){return this._error||Object.values(this.fields).some((e=>e.invalid))}},{key:"keyCount",get:function(){var e;let t=this.formKeyCountName?null==(e=this.getForm().querySelector("#"+this.formKeyCountName))?void 0:e.value:void 0;return parseInt(t,10)}}]),t}(b);g(_,"autoFocus",!0),g(_,"autoFocusPreventScroll",!0),g(_,"focusDelay",200);let E=function(){function e(){g(this,"lists",{}),g(this,"fields",[]),g(this,"validateRequired",!1),g(this,"multiPage",!1),g(this,"submitWithFetch",!1),g(this,"initSearchPanel",!1),g(this,"enableOnInit",!1)}var t=e.prototype;return t.setId=function(e){return this.id=e,this},t.setPageId=function(e){return this.pageId=e,this},t.setLists=function(e){return e&&"object"==typeof e&&!Array.isArray(e)&&(this.lists=e),this},t.setQueryBuilderLists=function(e){if(e&&"object"==typeof e&&!Array.isArray(e)){for(let[t,a]of Object.entries(e))e[t]={...a,autoFillTargetFields:[],childFields:[],filterFieldVars:[],filterFields:[],parentFields:[]};this.lists=e}return this},t.addList=function(e,t){return this.lists[e]=t,this},t.setFields=function(e){return Array.isArray(e)&&(this.fields=e),this},t.addField=function(e,t,a){return this.fields.find((t=>t[0]==e))||this.fields.push([e,t,a]),this},t.addFields=function(e){return Array.isArray(e)&&(this.fields=[...this.fields,...e]),this},t.setValidate=function(e){return this.validate=e,this},t.setCustomValidate=function(e){return this.customValidate=e,this},t.setValidateRequired=function(e){return this.validateRequired=e,this},t.setSubmit=function(e){return this.submit=e,this},t.setFormKeyCountName=function(e){return this.formKeyCountName=e,this},t.setEmptyRow=function(e){return this.emptyRow=e,this},t.setMultiPage=function(e){return this.multiPage=e,this},t.setSubmitWithFetch=function(e){return this.submitWithFetch=e,this},t.setFilterList=function(e){return this.filterList=e,this},t.setInitSearchPanel=function(e){return this.initSearchPanel=e,this},t.setEnableOnInit=function(e){return this.enableOnInit=e,this},t.build=function(){let e=new ew.Form(this.id,this.pageId);return Array.isArray(this.fields)&&e.addFields(this.fields),"function"==typeof this.validate&&(e.validate=this.validate),"function"==typeof this.customValidate&&(e.customValidate=this.customValidate),"function"==typeof this.emptyRow&&(e.emptyRow=this.emptyRow),"function"==typeof this.submit&&(e.submit=this.submit),this.formKeyCountName&&(e.formKeyCountName=this.formKeyCountName),this.multiPage&&(e.multiPage=new ew.MultiPage(this.id)),this.enableOnInit&&(e.enableOnInit=!0),this.submitWithFetch&&(e.submitWithFetch=!0,e.on("aftersubmit",((e,t)=>ew.refresh(null==t?void 0:t.result,null==t?void 0:t.context)))),this.filterList&&(e.filterList=this.filterList),this.lists&&(e.lists=this.lists),e.validateRequired=!!this.validateRequired,e.initSearchPanel=!!this.initSearchPanel,e.lists=this.lists,e},e}(),A=function(){function e(e){var t,a;g(this,"_isAutoSuggest",null),this.elementId=e.id,this.form=e.form,l.default.isString(this.form)&&(this.form=ew.forms.get(this.form)),this.element=this.form.getElement(this.elementId),this.formElement=this.form.getElement(),this.list=this.form.getList(this.element);let n=this.elementId.match(/^[xy](\d*|\$rowindex\$)_/),i=n?n[1]:"";this.parentFields=null!=(t=null==(a=this.list.parentFields)?void 0:a.slice().map((e=>1==e.split(" ").length?e.replace(/^x_/,"x"+i+"_"):e)))?t:[],this.limit=e.limit,this.debounce=e.debounce,this.data=e.data,this.recordCount=0,this.action=e.action||"autosuggest"}var t=e.prototype;return t.formatResult=function(e){return this.form.compileTemplates(),this.list.template&&!this.isAutoSuggest?this.list.template.render(e,ew.jsRenderHelpers):ew.displayValue(e,this.element)||e[0]},t.generateRequest=function(){var e=Object.assign({},this.data,{name:this.element.name,page:this.list.page,field:this.list.field,language:ew.LANGUAGE_ID},ew.getUserParams("#p_"+this.elementId,this.formElement));return null!=e.ajax||(e.ajax=this.action),this.parentFields.length>0&&this.parentFields.forEach(((t,a)=>e["v"+(a+1)]=ew.getOptionValue(t,this.formElement))),e},t.getUrl=function(e,t){let a=new URLSearchParams({q:e||"",n:this.limit,rnd:ew.random(),start:l.default.isNumber(t)?t:-1});return ew.getApiUrl(ew.API_LOOKUP_ACTION,a.toString())},t.prepare=function(e,t){return{url:this.getUrl(e,t),type:"POST",dataType:"json",data:this.generateRequest()}},t.transform=function(e){let t=[];return"OK"==(null==e?void 0:e.result)&&(this.recordCount=e.totalRecordCount,t=e.records),t},t.toSelect2Data=function(e){if(Array.isArray(e)){if(e.every((e=>e.hasOwnProperty("gf")))){return[...new Set(e.map((e=>e.gf)))].map((t=>({text:t,children:e.filter((e=>e.gf==t)).map((e=>({id:e.lf,text:this.formatResult({lf:e.lf,df:e.df,df2:e.df2,df3:e.df3,df4:e.df4})})))})))}return e.map((e=>({id:e.lf,text:this.formatResult({lf:e.lf,df:e.df,df2:e.df2,df3:e.df3,df4:e.df4})})))}return e},f(e,[{key:"isAutoSuggest",get:function(){return null!=this._isAutoSuggest||(this._isAutoSuggest=ew.isAutoSuggest(this.element)),this._isAutoSuggest}},{key:"options",get:function(){return this.list.lookupOptions}}]),e}(),S=function(e){function t(t){var a;if((a=e.call(this,t)||this).input=a.form.getElement("sv_"+a.elementId),!a.input||a.elementId.includes("$rowindex$"))return p(a);let n=p(a),i=l.default(a.input),r=l.default(a.element);a.minWidth=t.minWidth,a.maxHeight=t.maxHeight,a.highlight=t.highlight,a.hint=t.hint,a.minLength=t.minLength,a.templates=Object.assign({},t.templates),a.classNames=Object.assign({},t.classNames),a.delay=t.delay,a.debounce=t.debounce,a.display=t.display||"text",a.forceSelection=t.forceSelect,a.lineHeight=t.lineHeight,a.paddingY=t.paddingY,a.lookupAllDisplayFields=t.lookupAllDisplayFields,a.$input=i,a.$element=r,r.data("autosuggest",p(a)),i.val()&&r.val()&&a.element.add(r.val(),i.val(),!0),i.on("typeahead:select",((e,t)=>{n.setValue(t[n.display])})).on("change",(()=>{let e=i.data("tt-typeahead");if(null!=e&&e.isOpen()&&!e.menu.empty()){let t=e.menu.getActiveSelectable();if(t){let e=t.index(),a=n.element.options[e].text;i.typeahead("val",a)}}n.setValue()})).on("blur",(()=>{let e=i.data("tt-typeahead");null!=e&&e.isOpen()&&e.menu.close()})).on("focus",(()=>{i.attr("placeholder",i.data("placeholder")).removeClass("is-invalid"),r.removeClass("is-invalid")}));let o,s=!a.options.length,d=!1,u=n.list.template||n.templates.suggestion;u&&l.default.isString(u)&&(u=l.default.templates(u)),u&&(n.templates.suggestion=u.render.bind(u)),s&&!n.templates.footer&&(n.templates.footer='<div class="tt-footer dropdown-item"><div class="spinner-border spinner-border-sm text-primary" role="status"><span class="visually-hidden">'+ew.language.phrase("LoadingMore")+"</span></div></div>");let c=(e,t,n)=>{if(s)o&&o.cancel(),o=l.default.later(a.debounce,null,(()=>{a.recordCount=0,l.default.ajax(a.prepare(e)).done((e=>n(a.transform(e))))}));else{let n=a.getSyncResults(e);t(a.transform({result:"OK",totalRecordCount:n.length,records:n}))}};return l.default((function(){let e=[{highlight:n.highlight,minLength:n.minLength,hint:n.hint,classNames:n.classNames},{name:n.form.id+"-"+n.elementId,source:c,async:s,templates:n.templates,display:n.display,limit:s?n.limit:1/0}];r.trigger("typeahead",[e]),n.typeahead=i.typeahead.apply(i,e).off("blur.tt").data("tt-typeahead");let t=n.typeahead.menu.$node,a=t.find(".tt-dataset"),o=()=>t.find(".tt-suggestion").outerHeight(!1);if(n.minWidth&&t.css("min-width",n.minWidth),i.on("typeahead:rendered",((e,i)=>{let l=i.length,r=n.count;if(r>=n.limit){let e=o();e&&a.css("max-height",e*n.limit)}l>0&&a.scrollTop(o()*(r-l)),s&&t.find(".tt-footer").toggle(n.recordCount>r)})),s){let e;a.on("scroll",(()=>{var i;null==(i=e)||i.cancel(),e=l.default.later(n.delay,null,(()=>{let i=t.find(".tt-footer");if(!i.is(":hidden")&&!d){var l;if(a.offset().top+a.outerHeight(!1)+20>i.offset().top+i.outerHeight(!1))d=!0,n.getMore().always((()=>d=!1));else null==(l=e)||l.cancel()}}))}))}})),a}m(t,e);var a=t.prototype;return a.setValue=function(e){e||(e=this.$input.val());let t=this.element.options.findIndex((t=>t.text==e));if(t<0){if(this.forceSelection&&e)return this.$input.typeahead("val","").addClass("is-invalid"),this.$element.next(".invalid-feedback").html(ew.language.phrase("ValueNotExist")),void this.$element.addClass("is-invalid").val("").trigger("change")}else this.element.options[t].selected=!0,/s(ea)?rch$/.test(this.formElement.id)&&!this.forceSelection||(e=this.element.options[t].value);e!==this.$element.attr("value")&&this.$element.attr("value",e).trigger("change")},a.transform=function(t){let a=e.prototype.transform.call(this,t).map((t=>Object.assign({},t,{text:e.prototype.formatResult.call(this,t)})));return this.element.options=a.map((e=>new ew.SelectionListOption(e.text,e.lf||e[0]))),a},a.getSyncResults=function(e){if(this.options.length){let t=this.options.filter((t=>{if(this.lookupAllDisplayFields){let a=[t.df,t.df2,t.df3,t.df4].map((e=>String(e).toLowerCase())).join(" ");return e.toLowerCase().split(" ").filter((e=>""!==e)).every((e=>a.includes(e)))}return String(t.df).toLowerCase().startsWith(e)}));return this.recordCount=t.length,t}return[]},a.getMore=function(){let e=this.typeahead.menu,t=this.count,a=this.prepare(e.query,t);return l.default.ajax(a).done((t=>e.datasets[0]._append(e.query,this.transform(t))))},f(t,[{key:"count",get:function(){return this.typeahead.menu.$node.find(".tt-suggestion.tt-selectable").length||0}}]),t}(A),T=function(){function e(){g(this,"_forms",{})}var t=e.prototype;return t.get=function(e){var t;if(!e)return null;let a=l.default.isString(e)?e:null==(t=ew.getForm(e))?void 0:t.id;return this._forms[a]},t.add=function(e){this._forms[e.id]&&this._forms[e.id]!==e&&delete this._forms[e.id],this._forms[e.id]=e},t.ids=function(){return Object.keys(this._forms)},e}(),O=ew.language.phrase("select2");var I={errorLoading:function(){return O.errorLoading},inputTooLong:function(e){var t=e.input.length-e.maximum;return O.inputTooLong.replace("%s",t)},inputTooShort:function(e){var t=e.minimum-e.input.length;return O.inputTooShort.replace("%s",t)},loadingMore:function(){return'<div class="spinner-border spinner-border-sm text-primary" role="status"><span class="visually-hidden">'+O.loadingMore+"</span></div>"},maximumSelected:function(e){return O.maximumSelected.replace("%s",e.maximum)},noResults:function(){return O.noResults},searching:function(){return'<div class="spinner-border spinner-border-sm text-primary" role="status"><span class="visually-hidden">'+O.searching+"</span></div>"},removeAllItems:function(){return O.removeAllItems},removeItem:function(){return O.removeItem},search:function(){return O.search}};let x=l.default.fn.select2.amd.require._defined["select2/utils"],C=function(){function e(){}var t=e.prototype;return t.render=function(e){var t=l.default('<div class="select2-results__options '+this.options.get("containerClass")+'" role="listbox"></div>');return this.options.get("multiple")&&t.attr("aria-multiselectable","true"),this.$results=t,t},t.displayMessage=function(e,t){var a=this.options.get("escapeMarkup");this.clear(),this.hideLoading();var n=l.default('<div role="alert" aria-live="assertive" class="select2-results__option"></div>');if(t.message.includes("<")&&t.message.includes(">"))n.append(t.message);else{var i=this.options.get("translations").get(t.message);n.append(a(i(t.args)))}n[0].className+=" select2-results__message",this.$results.append(n)},t.append=function(e,t){if(this.hideLoading(),null!=t.results&&0!==t.results.length){t.results=this.sort(t.results);for(var a=this.options.get("columns"),n=t.results.length,i=this.$results.find("."+this.options.get("rowClass")).last(),r=0;r<t.results.length;r++){var o=t.results[r],s=this.option(o);if(i.length&&i.children().length!=a||(i=l.default('<div class="'+this.options.get("rowClass")+'"></div>'),this.$results.append(i)),i.append(s),r==n-1)for(var d=a-i.children().length,u=0;u<d;u++)i.append('<div class="'+this.options.get("cellClass")+'"></div>')}}else 0===this.$results.children().length&&(this.$element.data("updating")&&t.pagination.more?(this.trigger("results:message",{message:'<div class="spinner-border spinner-border-sm text-primary ew-select-spinner" role="status"><span class="visually-hidden">'+ew.language.phrase("Loading")+"</span></div> "+ew.language.phrase("Loading")}),this.$element.one("updated",(()=>this.$element.select2("close").select2("open")))):this.trigger("results:message",{message:"noResults"}))},t.option=function(e,t){var a=document.createElement("div");a.classList.add("select2-results__option"),a.classList.add("select2-results__option--selectable"),this.options.get("cellClass").split(" ").forEach((e=>a.classList.add(e)));var n={role:"option","aria-selected":"false"},i=window.Element.prototype.matches||window.Element.prototype.msMatchesSelector||window.Element.prototype.webkitMatchesSelector;for(var l in(null!=t.element&&i.call(t.element,":disabled")||null==t.element&&t.disabled)&&(n["aria-disabled"]="true",a.classList.remove("select2-results__option--selectable"),a.classList.add("select2-results__option--disabled")),null==t.id&&a.classList.remove("select2-results__option--selectable"),null!=t._resultId&&(a.id=t._resultId),t.title&&(a.title=t.title),n){var r=n[l];a.setAttribute(l,r)}return this.template(t,a),x.StoreData(a,"data",t),a},e}(),P=l.default.fn.select2.amd.require._defined["select2/utils"],N=function(){function e(){}return e.prototype.bind=function(e,t,a){var n,i=this;e.call(this,t,a),null==(n=t.listeners["results:select"])||n.pop(),this.$results.off("mouseup"),t.on("results:select",(function(e){var t=i.getHighlightedResults();if(0!==t.length){var a=P.GetData(t[0],"data");t.hasClass("select2-results__option--selected")?i.trigger("unselect",{originalEvent:e,data:a}):i.trigger("select",{originalEvent:e,data:a})}})),this.$results.on("mousedown",".select2-results__option--selectable",(function(e){this._mousedown=!0})),this.$results.on("mouseup",".select2-results__option--selectable",(function(e){if(this._mousedown){var t=l.default(this),a=P.GetData(this,"data");t.hasClass("select2-results__option--selected")?i.trigger("unselect",{originalEvent:e,data:a}):i.trigger("select",{originalEvent:e,data:a})}}))},e}(),R=function(){function e(){}return e.prototype.bind=function(e,t,a){var n,i=this;e.call(this,t,a),null==(n=t.listeners.close)||n.pop(),t.on("close",(function(){i.$search.attr("tabindex",-1).removeAttr("aria-controls").removeAttr("aria-activedescendant")}))},e}(),L=$.fn.select2.amd.require._defined["select2/keys"];L.PRINT_SCREEN=44;let F=function(){function e(){}return e.prototype.handleSearch=function(e,t){var a=t.which;if(![L.TAB,L.SHIFT,L.CTRL,L.ALT,L.PRINT_SCREEN].includes(a)){if(!this._keyUpPrevented){var n=this.$search.val();this.trigger("query",{term:n})}this._keyUpPrevented=!1}},e}(),k=function(e){function t(t,a,n){return e.call(this,t,a,n)||this}m(t,e);var a=t.prototype;return a._attachPositioningHandler=function(e,t){var a=this,n=["scroll.select2."+t.id,"resize.select2."+t.id,"orientationchange.select2."+t.id],i=()=>{a._positionDropdown(),a._resizeDropdown()};l.default(window).on(n.join(" "),i),t.$element.closest(".modal").on("scroll.select2."+t.id,i)},a._detachPositioningHandler=function(e,t){var a=["scroll.select2."+t.id,"resize.select2."+t.id,"orientationchange.select2."+t.id];l.default(window).off(a.join(" ")),t.$element.closest(".modal").off("scroll.select2."+t.id)},a._showDropdown=function(e){this.$dropdownContainer.appendTo(this.$dropdownParent),null!=this._popper||(this._popper=Popper.createPopper(this.$container[0],this.$dropdownContainer[0],{placement:ew.IS_RTL?"bottom-end":"bottom-start",modifiers:[{name:"flip",enabled:!0},{name:"preventOverflow",enabled:!0}]})),this._positionDropdown(),this._resizeDropdown()},a._positionDropdown=function(){var e;null==(e=this._popper)||e.update()},a.destroy=function(t){var a;e.prototype.destroy.call(this,t),null==(a=this._popper)||a.destroy(),this._popper=null},t}(l.default.fn.select2.amd.require._defined["select2/dropdown/attachBody"]),D=function(){function e(e,t,a){g(this,"$modal",null),a.set("dropdownParent",l.default(document.body)),e.call(this,t,a)}var t=e.prototype;return t.bind=function(e,t,a){let n=this;e.call(this,t,a),t.on("open",(function(){n._showDropdown(),n._bindContainerResultHandlers(t)})),this.$dropdownContainer.on("mousedown",(function(e){e.stopPropagation()}))},t.position=function(e,t,a){t.attr("class",a.attr("class")),t.removeClass("select2"),this.$container=a},t.render=function(e){let t=l.default("<span></span>"),a=e.call(this);return t.append(a),this.$dropdownContainer=t,t},t._bindContainerResultHandlers=function(e,t){if(this._containerResultsHandlersBound)return;let a=this;t.$modal=this.$modal,t.on("results:all",(function(){var e;a._updateDropdown(),null==(e=a.$search[0])||e.focus()})),t.on("results:append",(function(){a._updateDropdown()})),t.on("results:message",(function(){a._updateDropdown()})),t.on("select",(function(e){var t;let n=null==(t=e.originalEvent)?void 0:t.currentTarget;null==n||n.classList.add("select2-results__option--selected"),a._updateDropdown()})),t.on("unselect",(function(e){var t;let n=null==(t=e.originalEvent)?void 0:t.currentTarget;null==n||n.classList.remove("select2-results__option--selected"),a._updateDropdown()})),this._containerResultsHandlersBound=!0},t._updateDropdown=function(){this.$modal.find(this.$dropdownContainer)[0]||this.$modal.find(".modal-body").children().detach().end().append(this.$dropdownContainer)},t._showDropdown=function(e){let t=this,a=this.$element.val();this.$dropdownContainer.appendTo(this.options.get("dropdownParent")),null!=this.$modal||(this.$modal=l.default("#ew-modal-lookup-dialog")),this._updateDropdown(),this.$modal.find(".modal-title").empty().append(ew.language.phrase("LookupTitle").replace("%s",this.$element.data("caption"))),this.$modal.find(".modal-footer button[data-value]").off().on("click",(function(){l.default(this).data("value")||t.$element.val(a).trigger("change")})),this.$modal.modal("show").on("hidden.bs.modal",(function(e){t.$container.removeClass("select2-container--open")})).draggable(this.options.get("draggableOptions"))},e}(),M=function(e){function t(t,a,n){return e.call(this,t,a,n)||this}m(t,e);var a=t.prototype;return a.bind=function(e,t,a){var n=this;e.call(this,t,a),t.on("open",(function(){n._showDropdown(),n._bindContainerResultHandlers(t)})),t.on("close",(function(){n._hideDropdown()})),this.$dropdownContainer.on("mousedown",(function(e){e.stopPropagation()}))},a._positionDropdown=function(){var e;null==(e=this._popper)||e.update()},a._resizeDropdown=function(){var e={width:this.$container.outerWidth(!1)+"px"};this.options.get("dropdownAutoWidth")&&(e.minWidth=e.width,e.position="relative",e.width="auto"),this.$dropdown.css(e)},a._showDropdown=function(e){var t;this.$dropdownContainer.appendTo(this.$dropdownParent);let a=this,n=this.$element.val(),i=l.default("#ew-filter-dropdown-footer").contents().clone();i.find(".ew-filter-btn[data-value]").off("click.ew").on("click.ew",(function(e){l.default(this).data("value")?l.default(a.$element[0].form).triggerHandler("submit"):a.$element.val(n).trigger("change"),a.$element.select2("close")})),i.find(".ew-filter-clear").off("click.ew").on("click.ew",(e=>a.$element.data("select2").selection._handleClear(e)));let r=this.$dropdownContainer.find(".ew-filter-dropdown");r.find(".ew-filter-btn")[0]||r.append(i);var o=document.querySelector(".ew-filter-dropdown-btn[data-table="+this.$element.data("table")+"][data-field="+this.$element.data("field")+"]"),s=null!=(t=o.closest(".ew-table-header-cell"))?t:o.closest(".ew-table-header-btn");null!=this._popper||(this._popper=Popper.createPopper(s,this.$dropdownContainer[0],{placement:ew.IS_RTL?"bottom-end":"bottom-start",modifiers:[{name:"flip",enabled:!0},{name:"preventOverflow",enabled:!0}]})),this._positionDropdown(),this._resizeDropdown()},a.position=function(e,t,a){t.attr("class",a.attr("class")),t[0].classList.remove("select2"),t[0].classList.add("select2-container--open"),this.$container=a},a.destroy=function(t){var a;e.prototype.destroy.call(this,t),null==(a=this._popper)||a.destroy(),this._popper=null},t}(l.default.fn.select2.amd.require._defined["select2/dropdown/attachBody"]),j=function(e){function t(t,a,n){return e.call(this,t,a,n)||this}m(t,e);var a=t.prototype;return a.bind=function(e,t,a){var n=this;e.call(this,t,a),t.on("open",(function(){n._showDropdown(),n._bindContainerResultHandlers(t)})),t.on("close",(function(){n._hideDropdown()})),this.$dropdownContainer.on("mousedown",(function(e){e.stopPropagation()}))},a._showDropdown=function(e){this.$dropdownContainer.appendTo(this.$dropdownParent),null!=this._popper||(this._popper=Popper.createPopper(this.$element.parent().find(".select2-container")[0],this.$dropdownContainer[0],{placement:ew.IS_RTL?"bottom-end":"bottom-start",modifiers:[{name:"flip",enabled:!0},{name:"preventOverflow",enabled:!0}]})),this._positionDropdown(),this._resizeDropdown()},a._positionDropdown=function(){var e;null==(e=this._popper)||e.update()},a.position=function(e,t,a){t.attr("class",a.attr("class")),t[0].classList.remove("select2"),t[0].classList.add("select2-container--open"),this.$container=a},a.destroy=function(t){var a;e.prototype.destroy.call(this,t),null==(a=this._popper)||a.destroy(),this._popper=null},t}(l.default.fn.select2.amd.require._defined["select2/dropdown/attachBody"]),U=l.default.fn.select2.amd.require._defined,B=U["select2/selection/allowClear"],V=U["select2/utils"],K=function(e){function t(){return e.apply(this,arguments)||this}return m(t,e),t.prototype._handleClear=function(e,t){if(!this.isDisabled()){var a=this.$selection.find(".select2-selection__clear");if(0!==a.length){t.stopPropagation();var n=V.GetData(a[0],"data"),i=this.$element.val();this.$element.val(this.placeholder.id);var l={data:n};if(this.trigger("clear",l),l.prevented)this.$element.val(i);else{for(var r=0;r<n.length;r++)if(l={data:n[r]},this.trigger("unselect",l),l.prevented)return void this.$element.val(i);this.$element.trigger("input").trigger("change")}}}},t}(B),q=function(){function e(){}return e.prototype.bind=function(e,t,a){e.call(this,t,a),this.$selection.on("click",".select2-selection__choice__remove",(function(e){e.stopPropagation()}))},e}(),H=function(){function e(){}return e.prototype.option=function(e,t){var a,n=t.text,i=null==(a=t.element)?void 0:a.innerHTML,l=e.call(this,t);return n.startsWith("<")&&n.endsWith(">")?l.html(n):i&&i!=n&&l.html(i),l},e}(),W=$.fn.select2.amd.require._defined,G=W["select2/results"],Y=W["select2/selection/single"],z=W["select2/selection/multiple"],J=W["select2/selection/placeholder"],X=W["select2/selection/allowClear"],Z=W["select2/selection/search"],Q=W["select2/selection/eventRelay"],ee=W["select2/utils"],te=W["select2/translation"],ae=W["select2/data/select"],ne=W["select2/data/array"],ie=W["select2/data/ajax"],le=W["select2/data/tags"],re=W["select2/data/tokenizer"],oe=W["select2/data/minimumInputLength"],se=W["select2/data/maximumInputLength"],de=W["select2/data/maximumSelectionLength"],ue=W["select2/dropdown"],ce=W["select2/dropdown/search"],fe=W["select2/dropdown/hidePlaceholder"],pe=W["select2/dropdown/infiniteScroll"],he=W["select2/dropdown/minimumResultsForSearch"],me=W["select2/dropdown/selectOnClose"],ge=W["select2/dropdown/closeOnSelect"],we=W["select2/dropdown/dropdownCss"],ve=W["select2/dropdown/tagsSearchHighlight"],be=W["select2/defaults"];be.apply=function(e){return null==(e=$.extend(!0,{},this.defaults,e)).dataAdapter&&(null!=e.ajax?e.dataAdapter=ie:null!=e.data?e.dataAdapter=ne:e.dataAdapter=ae,e.dataAdapter=ee.Decorate(e.dataAdapter,H),e.minimumInputLength>0&&(e.dataAdapter=ee.Decorate(e.dataAdapter,oe)),e.maximumInputLength>0&&(e.dataAdapter=ee.Decorate(e.dataAdapter,se)),e.maximumSelectionLength>0&&(e.dataAdapter=ee.Decorate(e.dataAdapter,de)),e.tags&&(e.dataAdapter=ee.Decorate(e.dataAdapter,le)),null==e.tokenSeparators&&null==e.tokenizer||(e.dataAdapter=ee.Decorate(e.dataAdapter,re))),null==e.resultsAdapter&&(e.resultsAdapter=G,e.columns>0&&e.customOption?(e.resultsAdapter=ee.Decorate(e.resultsAdapter,C),e.iconClass&&e.multiple&&e.templateResult==ew.selectOptions.templateResult&&(e._templateResult=e.templateResult,e.templateResult=t=>t.loading?t.text:'<div class="form-check-input ew-dropdown-check-input"></div><label class="'+e.iconClass+' ew-dropdown-check-label">'+e._templateResult(t)+"</label>")):(e.modal||e.filter)&&(e.resultsAdapter=ee.Decorate(e.resultsAdapter,N)),null!=e.ajax&&(e.resultsAdapter=ee.Decorate(e.resultsAdapter,pe)),null!=e.placeholder&&(e.resultsAdapter=ee.Decorate(e.resultsAdapter,fe)),e.selectOnClose&&(e.resultsAdapter=ee.Decorate(e.resultsAdapter,me)),e.tags&&(e.resultsAdapter=ee.Decorate(e.resultsAdapter,ve))),null==e.dropdownAdapter&&(e.modal||e.filter?(e.dropdownAdapter=ee.Decorate(ue,ce),e.dropdownAdapter=ee.Decorate(e.dropdownAdapter,F),e.dropdownAdapter=ee.Decorate(e.dropdownAdapter,R)):(e.dropdownAdapter=ue,e.multiple||(e.dropdownAdapter=ee.Decorate(e.dropdownAdapter,ce),e.dropdownAdapter=ee.Decorate(e.dropdownAdapter,F))),0!==e.minimumResultsForSearch&&(e.dropdownAdapter=ee.Decorate(e.dropdownAdapter,he)),e.closeOnSelect&&(e.dropdownAdapter=ee.Decorate(e.dropdownAdapter,ge)),null!=e.dropdownCssClass&&(e.dropdownAdapter=ee.Decorate(e.dropdownAdapter,we)),e.dropdownAdapter=ee.Decorate(e.dropdownAdapter,e.modal?D:e.filter?M:e.dropdown?j:k)),null==e.selectionAdapter&&(e.multiple?(e.selectionAdapter=z,e.selectionAdapter=ee.Decorate(e.selectionAdapter,q)):e.selectionAdapter=Y,null!=e.placeholder&&(e.selectionAdapter=ee.Decorate(e.selectionAdapter,J)),e.allowClear&&(e.selectionAdapter=ee.Decorate(e.selectionAdapter,e.filter?K:X)),e.multiple&&(e.selectionAdapter=ee.Decorate(e.selectionAdapter,Z)),e.selectionAdapter=ee.Decorate(e.selectionAdapter,Q)),e.translations=new te(I),e.dir=ew.IS_RTL?"rtl":"ltr",e};let ye=new URL(window.location),_e=new T,Ee=l.default(document),Ae=l.default("body"),Se=".row, [id^=el_], [class^=el_]";function Te(e){var t;let a=null!=(t=null==e?void 0:e.target)?t:document,n={...ew.tooltipOptions,container:"body",trigger:ew.IS_MOBILE?"manual":"hover"};l.default(a).find(".ew-icon").closest(".btn, .ew-home, .ew-row-link:not(.dropdown-item)").each((function(){let e=l.default(this);if(e.hasClass("dropdown-toggle")){let t=e.closest(".btn-group");1==t.children(".btn").length&&(t.tooltip({...n,title:this.dataset.title||this.title}).on("mouseleave",(e=>{var t;return null==(t=bootstrap.Tooltip.getInstance(e.currentTarget))?void 0:t.hide()})),e.next(".dropdown-menu").on("mouseover",(e=>e.stopPropagation())))}else e.tooltip(n)}))}function Oe(e){var t,a=null!=(t=null==e?void 0:e.target)?t:document;l.default.fn.pStrength&&"undefined"!=typeof ew.MIN_PASSWORD_STRENGTH&&l.default(a).find(".ew-password-strength").each((function(){var e=l.default(this);e.data("pStrength")||e.pStrength({changeBackground:!1,backgrounds:[],passwordValidFrom:ew.MIN_PASSWORD_STRENGTH,onPasswordStrengthChanged:function(e,t){var a=l.default("[id='"+this.attr("data-password-strength")+"']"),n=a.find(".progress-bar");if(this.val()&&!ew.isMaskedPassword(this)){var i=t+"%",r=ew.MIN_PASSWORD_STRENGTH,o=t>=r;t<.25*r?n.addClass("bg-danger").removeClass("bg-warning bg-info bg-success"):t<.5*r?n.addClass("bg-warning").removeClass("bg-danger bg-info bg-success"):t<.75*r?n.addClass("bg-primary").removeClass("bg-danger bg-warning bg-success"):n.addClass("bg-success").removeClass("bg-danger bg-warning bg-info"),n.css("width",i),t>.5*r&&(i=ew.language.phrase("PasswordStrength").replace("%p",i)),n.html(i),a.removeClass("d-none"),this.data("validated",o),o&&wt(this[0])}else a.addClass("d-none"),this.data("validated",null);a.width(this.outerWidth())}})})),l.default.fn.pGenerator&&l.default(a).find(".ew-password-generator").each((function(){var e=l.default(this);e.data("pGenerator")||e.pGenerator({passwordLength:ew.GENERATE_PASSWORD_LENGTH,uppercase:ew.GENERATE_PASSWORD_UPPERCASE,lowercase:ew.GENERATE_PASSWORD_LOWERCASE,numbers:ew.GENERATE_PASSWORD_NUMBER,specialChars:ew.GENERATE_PASSWORD_SPECIALCHARS,onPasswordGenerated:function(e){l.default("#"+this.attr("data-password-confirm")).val(e),l.default("#"+this.attr("data-password-field")).val(e).trigger("change").trigger("focus").triggerHandler("click")}})}))}function Ie(e,t){var a=ew.PATH_BASE+ew.API_URL,n=(t instanceof URLSearchParams?t:new URLSearchParams(t)).toString();if(l.default.isString(e))a+=e||"";else if(Array.isArray(e)){var i=e.map((function(e){return encodeURIComponent(e)})).join("/");a+=i||""}return a+(n?"?"+n:"")}function xe(e){var t,a;let n,i,l;[n,l]=e.split("#"),[n,i]=n.split("?"),!i&&n.includes("=")&&([n,i]=["",n]);let r={url:e,pathname:null!=(t=n)?t:"",hash:null!=(a=l)?a:"",searchParams:new URLSearchParams(i)};return Object.defineProperty(r,"search",{value:i,writable:!1,enumerable:!0}),r}function Ce(e){try{return new URLSearchParams(e)}catch(e){return console.log(e),new URLSearchParams}}function Pe(e){return xe(e).searchParams}function Ne(e){let t=xe(e);for(var a=arguments.length,n=new Array(a>1?a-1:0),i=1;i<a;i++)n[i-1]=arguments[i];return t.searchParams=Re(t.searchParams,...n),ke(t)}function Re(){let e=new URLSearchParams;for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];for(const t of a)if(l.default.isObject(t)||l.default.isString(t)&&t){(t instanceof URLSearchParams?t:Ce(t)).forEach(((t,a)=>e.has(a)&&a.endsWith("[]")?e.append(a,t):e.set(a,t)))}return e}function Le(e,t,a){return Ne(e,{[t]:a})}function Fe(e){let t=xe(e);for(var a=arguments.length,n=new Array(a>1?a-1:0),i=1;i<a;i++)n[i-1]=arguments[i];return n.forEach((e=>t.searchParams.delete(e))),ke(t)}function ke(e){let t=e.searchParams.toString();return e.pathname+(e.pathname&&t?"?":"")+t+(e.hash?"#"+e.hash:"")}function De(e,t){return e&&"#"!=e?Ne(e,{[ew.PAGE_LAYOUT]:String(t)}):e}function Me(e){let t=xe(e),a=t.searchParams;return a.forEach(((e,t)=>{e=decodeURIComponent(e),["<>","<=",">=",">","<"].includes(e)?a.set(t,e):a.set(t,ew.sanitize(e))})),ke(t)}function je(e){var t;let a=l.default(null!=(t=null==e?void 0:e.target)?t:document);a.find("a.ew-export-link[href]:not(.ew-email):not(.ew-print):not(.ew-xml)").on("click",(function(e){let t=this.href;t&&"#"!=t&&Be(t,rt()),e.preventDefault()})),a.find("a.ew-export-link[href].ew-print, a.ew-export-link[href].ew-xml").each((function(){let e=new URL(this.href);e.searchParams.set(ew.TOKEN_NAME_KEY,ew.TOKEN_NAME),e.searchParams.set(ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN),this.href=e.pathname+e.search}))}function $e(e){var t,a=null!=(t=null==e?void 0:e.target)?t:document,n=l.default(a),i=n.find("input[type=checkbox].ew-multi-select"),r=function(e){var t=i.filter("[name^='"+e+"_']"),a=t.length,n=t.filter(":checked").length;l.default("input[type=checkbox]#"+e).prop("checked",n==a).prop("indeterminate",n!=a&&0!=n)};i.on("click",(e=>r(e.target.name.split("_")[0]))),n.find("input[type=checkbox].ew-priv:not(.ew-multi-select)").each(((e,t)=>r(t.id)))}function Ue(e){var t,a;return e&&((null==(t=e.error)?void 0:t.description)||(null==(a=e.error)?void 0:a.message)||l.default.isString(e.error)&&e.error||e.failureMessage||!1===e.success&&e.message||null)}function Be(e,t){let a=e.includes("export=html")||e.includes(Ie([ew.API_EXPORT_ACTION,"html"])),n=window.parent.Swal;return t=Re(t,[[ew.TOKEN_NAME_KEY,ew.TOKEN_NAME],[ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN]]),n.fire({...ew.sweetAlertSettings,showConfirmButton:!1,html:"<p>"+ew.language.phrase("Exporting")+"</p>",allowOutsideClick:!1,allowEscapeKey:!1,willOpen:()=>{n.showLoading(),qt(e,{method:t?"POST":"GET",body:t||null}).then((async t=>{let i=t.headers.get("Content-Type");if(null!=i&&i.includes("json")){var l;let a=null!=(l=Ue(await t.json()))?l:ew.language.phrase("FailedToExport");a&&(n.hideLoading(),n.update({html:"<div class='text-danger'>"+a+"</div>",showConfirmButton:!0}),Ee.trigger("export",[{type:"fail",url:e}]))}else{let i=a?await t.text():await t.blob(),l=URL.createObjectURL(a?new Blob([i],{type:"text/html"}):i),r=document.createElement("a"),o=t.headers.get("Content-Disposition"),s=null==o?void 0:o.match(/\bfilename=((['"])(.+)\2|([^;]+))/i);r.style.display="none",r.href=l,s&&(r.download=s[3]||s[4]),document.body.appendChild(r),r.click(),Ee.trigger("export",[{type:"done",url:e,objectUrl:l}]),URL.revokeObjectURL(l),n.close()}})).catch((t=>{n.hideLoading(),n.update({html:"<div class='text-danger'>"+t+"</div>",showConfirmButton:!0}),Ee.trigger("export",[{type:"fail",url:e}])})).finally((()=>{Ee.trigger("export",[{type:"always",url:e}])}))}})}function Ve(e){var t;ew.LAZY_LOAD&&((null!=(t=null==e?void 0:e.target)?t:document).querySelectorAll("img.ew-lazy").forEach(((e,t)=>{ew.LAZY_LOAD_DELAY>0?setTimeout((()=>e.src=e.dataset.src),t*ew.LAZY_LOAD_DELAY):e.src=e.dataset.src})),Ee.trigger("lazyload"))}function Ke(e){var t;if(ew.USE_COLORBOX){var a=null!=(t=null==e?void 0:e.target)?t:document,n=Object.assign({},ew.lightboxSettings,{title:ew.language.phrase("LightboxTitle"),current:ew.language.phrase("LightboxCurrent"),previous:ew.language.phrase("LightboxPrevious"),next:ew.language.phrase("LightboxNext"),close:ew.language.phrase("LightboxClose"),xhrError:ew.language.phrase("LightboxXhrError"),imgError:ew.language.phrase("LightboxImgError")});l.default(a).find(".ew-lightbox").each((function(){var e=l.default(this);e.colorbox(Object.assign({rel:e.data("rel")},n))}))}}function qe(e){var t;if(!ew.EMBED_PDF)return;let a=null!=(t=null==e?void 0:e.target)?t:document,n=Object.assign({},ew.PDFObjectOptions);l.default(a).find(".ew-pdfobject").not(":has(.pdfobject)").each((function(){let e=l.default(this),t=e.data("url"),a=e.html();t&&PDFObject.embed(t,this,Object.assign(n,{fallbackLink:a}))}))}function He(e){var t;let a=null!=(t=null==e?void 0:e.target)?t:document,n=l.default(a);n.find("input[data-bs-toggle=tooltip], textarea[data-bs-toggle=tooltip], select[data-bs-toggle=tooltip]").each((function(){let e=l.default(this);e.tooltip({...ew.tooltipOptions,html:!0,...e.data()})})),n.find("a.ew-tooltip-link").each(ea),n.find(".ew-tooltip").tooltip(ew.tooltipOptions),n.find(".ew-popover").popover(ew.popoverOptions)}function We(e){if(l.default.isString(e))try{return JSON.parse(e)}catch(e){return}return e}function Ge(e){let t=l.default(e).closest("[id^=r_], [id^=xs_]"),a=e.id.substring(2),n=t.find(".ew-search-field"),i=t.find(".ew-search-field2"),r=i.find("[name='y_"+a+"'], [name='y_"+a+"[]']").length,o=t.find(".ew-search-cond"),s=o.length,d=t.find(".ew-search-and"),u=t.find(".ew-search-operator").find("[name='z_"+a+"']").val(),c=t.find(".ew-search-operator2"),f=c.find("[name='w_"+a+"']").val(),p=u.includes("BETWEEN"),h=["IS NULL","IS NOT NULL","IS EMPTY","IS NOT EMPTY"].includes(u),m=["IS NULL","IS NOT NULL","IS EMPTY","IS NOT EMPTY"].includes(f),g=!r||p,w=h,v=!p&&(!s||m);o.toggleClass("d-none",g).find(":input").prop("disabled",g),d.toggleClass("d-none",!p),c.toggleClass("d-none",g).find(":input").prop("disabled",g),n.toggleClass("d-none",w).find(":input").prop("disabled",w),i.toggleClass("d-none",v).find(":input").prop("disabled",v)}function Ye(e){var t;let a=null!=(t=null==e?void 0:e.target)?t:document,n=ew.forms.ids();for(let e of n)(null!=a.matches&&a.matches("#"+e)||a.querySelector("#"+e))&&_e.get(e).init()}function ze(e){return"function"==typeof e}function Je(e,t,a){let n=l.default.isObject(e)?e:{};e=l.default.isString(e)?e:"",a=l.default.isString(t)?t:a,n=l.default.extend(!0,{},ew.sweetAlertSettings,{html:e,confirmButtonText:ew.language.phrase("OKBtn"),customClass:{htmlContainer:"ew-swal2-html-container text-"+(a||"danger")}},n);let i={config:n,type:a,show:!0};if(Ee.trigger("alert",[i]),i.show)return Swal.fire(i.config).then((e=>ze(t)?t(e.isConfirmed):e))}function Xe(e,t){var a;let n=l.default.isObject(e)?e:{};return n=l.default.extend(!0,{},ew.sweetAlertSettings,{html:l.default.isString(e)?e:"",showCancelButton:!0,confirmButtonText:ew.language.phrase("OKBtn"),cancelButtonText:ew.language.phrase("CancelBtn")},n),n.input&&(null!=(a=n).inputValidator||(a.inputValidator=e=>{if(!e)return ew.language.phrase("EnterValue")})),Swal.fire(n).then((e=>ze(t)?t(e.value):e))}function Ze(e){e=Object.assign({},ew.toastOptions,e),Ee.Toasts("create",e);var t=e.position;return l.default("#toastsContainer"+t[0].toUpperCase()+t.substring(1)).children().first()}function Qe(e,t,a){if(!e)return;t||(t="danger"),a||(a=ew.language.phrase(t));let n={message:e,type:t,title:a,show:!0};return Ee.trigger("toast",[n]),n.show?(({message:e,type:t,title:a}=n),Ze({class:"ew-toast bg-"+t,title:a,body:e,autohide:"success"==t&&ew.autoHideSuccessMessage,delay:"success"==t?ew.autoHideSuccessMessageDelay:500})):void 0}function et(e){if(e instanceof _)return e.$element[0];var t=l.default(e),a=t.closest(".ew-form");return a[0]||(a=t.closest(".ew-grid, .ew-multi-column-grid").find(".ew-form")),a[0]}function tt(e,t,a,n){var i,r,o=this.$element?this.$element[0]:this.form||(null==(i=e)?void 0:i.form);if(o&&((this.htmlForm?this:_e.get(o.id))&&(this.form&&l.default.isUndefined(e)?e=_e.get(this).getList(this).childFields.slice():l.default.isString(e)&&(e=It(e,o)),e&&(!Array.isArray(e)||0!=e.length)))){var s=this,d=new w;if(Array.isArray(e)&&l.default.isString(e[0])){for(var u=[],c=0,f=e.length;c<f;c++){var p=e[c].split(" ");if(1==p.length&&s.form){var h=jt(s,!1).match(/^([xy]\d*_)/);h&&(e[c]=e[c].replace(/^([xy]\d*_)/,h[1]))}var m=It(e[c],o),g=[];if(!ht(m)&&!ut(m))if(u.push(m),2==p.length&&Array.isArray(m)){var v=l.default(m);v.each((function(){if(!g.includes(this.name)){g.push(this.name);var e=v.filter("[name='"+this.name+"']"),i=e.attr("type"),l=["radio","checkbox"].includes(i)?e.get():e[0];d.add(at.bind(s,l,t,a,n))}}))}else d.add(at.bind(s,m,t,a,n))}e=u;var b=_e.get(s).getList(s);Array.isArray(null==b?void 0:b.autoFillTargetFields)&&b.autoFillTargetFields[0]&&d.add(Qt.bind(null,s))}else{if(ht(e)||ut(e))return;d.add(at.bind(s,e,t,a,n))}return null==(r=d.send({url:ew.getApiUrl(ew.API_LOOKUP_ACTION)}))?void 0:r.then((function(){Ee.trigger("updatedone",[{source:s,target:e}])}))}}function at(e,t,a,n){void 0===n&&(n=!0);var i=jt(e,!1);if(i){var r=et(e);if(r&&r.id){var o=_e.get(r.id);if(o){var s=this,d=Array.from(arguments),u=Ft(e),c=i.match(/^([xy])(\d*)_/),f=c?c[1]:"",p=c?c[2]:"",h=[],m=o.getList(e),g=l.default(e).data("updating",!0);if(!g.data("hidden")){if(l.default.isUndefined(t)&&(t=m.parentFields.slice(),""!=p))for(var w=0,v=t.length;w<v;w++){var b=t[w].split(" ");1==b.length&&(t[w]=t[w].replace(/^x_/,"x"+p+"_"))}if(Array.isArray(t)&&t.length>0)if(Array.isArray(t[0]))h=t;else if(l.default.isString(t[0]))for(w=0,v=t.length;w<v;w++)h.push(Ft(t[w],r));ct(e)||Mt(e);var y=function(t){var a=jt(e);t.forEach((function(t){let n={data:t,parents:h,valid:!0,name:a,form:r};Ee.trigger("addoption",[n]),n.valid&&Vt(e,t,r)})),null==e.render||e.render(),Kt(e,u,n),n&&!e.options&&e.length&&g.first().triggerHandler("click")};l.default.isUndefined(a)&&(a=m.ajax);var _=function(){/(srch|search|summary|crosstab)$/.test(r.id)&&"x"==f&&!p&&(d[0]=i.replace(/^x_/,"y_"),tt.apply(s,d))};if(!l.default.isBoolean(a)||Array.isArray(m.lookupOptions)&&m.lookupOptions.length>0){var E=m.lookupOptions;return y(E),_(),g.first().trigger("updated",[{target:e}]),E}var A=jt(e),S=Object.assign({page:m.page,field:m.field,ajax:"updateoption",language:ew.LANGUAGE_ID,name:A},nt("#p_"+i,r));ct(e)&&s.htmlForm?S.v0=u[0]||sa():(e.options&&!e.list&&!pt(e)||dt(e))&&(S.v0=u[0]?e.multiple?u.join(ew.MULTIPLE_OPTION_SEPARATOR):u[0]:sa());w=0;for(var T=h.length;w<T;w++)S["v"+(w+1)]=h[w].join(ew.MULTIPLE_OPTION_SEPARATOR);return null==e.showLoading||e.showLoading(),l.default.ajax(Ie(ew.API_LOOKUP_ACTION),{method:"POST",dataType:"json",data:S,async:a,processData:!1,success:t=>{let a=Ue(t);if(a)return void Je(a);let n=t.records||[];return y(n),_(),g.first().trigger("updated",[Object.assign({},t,{target:e})]),n},error:(e,t,a)=>Je(a),complete:()=>g.data("updating",!1)})}}}}}function nt(e,t){e=e.replace(/\[\]$/,"");var a={},n=((t=l.default.isString(t)?/^#/.test(t)?t:"#"+t:t)?l.default(t).find(e):l.default(e)).val();n&&new URLSearchParams(n).forEach((function(e,t){a[t]=e}));return a}function it(e,t,a){var n;let i=document.getElementById(e);null!=(n=i.children[0])&&n.matches("div[id^=ct_]")&&(i=i.children[0]);let l={customexport:t,data:i.innerHTML,[ew.TOKEN_NAME_KEY]:ew.TOKEN_NAME,[ew.ANTIFORGERY_TOKEN_KEY]:ew.ANTIFORGERY_TOKEN,...rt()};"email"==t?aa(a,Re(ye.searchParams,l)):Be(Ie([ew.API_EXPORT_ACTION,t,a]),l)}function lt(e){return e&&["1","y","t","true"].includes(String(e).toLowerCase())}function rt(){let e=Array.from(Object.entries(window.exportCharts)).map((e=>{let[t,a]=e;return{chartEngine:"Chart.js",streamType:"base64",stream:a.toBase64Image(),fileName:t+".png"}}));return e.length?{charts:JSON.stringify(e)}:null}async function ot(e){let{evt:t,url:a,export:n,custom:i,exportSelected:r,emailForm:o}=e,s=t.currentTarget.form;if(r&&(r=s&&!!s.querySelector("input[type=checkbox][name='key_m[]']")),r&&!bt(s))return Je(ew.language.phrase("NoRecordSelected")),!1;let d=s?l.default(s):l.default('<form class="ew-export-form" method="post"></form>').appendTo(Ae),u=d.attr("target"),c=d.attr("action"),f=[[ew.TOKEN_NAME_KEY,ew.TOKEN_NAME],[ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN]];try{if(i){var p;document.body.style.cursor="wait";let e="ew-export-frame";a=Ne(a,{export:n,custom:1},l.default(o).serialize()),null==(p=document.querySelector("iframe[name='"+e+"']"))||p.remove();let t=l.default("<iframe>").attr("name",e).addClass("d-none").appendTo(Ae);d.attr({action:a,target:e}),f.forEach((e=>{let[t,a]=e;return d.find('input[name="'+t+'"]').val(a)[0]||l.default("<input>").attr({type:"hidden",name:t,value:a}).appendTo(d)})),t.one("load",(()=>document.body.style.cursor="default")).one("load",(()=>d.attr({action:c,target:u}))),d.trigger("submit")}else a=Le(a,"export",n),"print"==n?d.attr("action",a).trigger("submit"):Be(a,Re(d.serialize(),rt()))}finally{s||d.remove()}return!1}function st(e){var t=l.default(e);return t.is(":hidden")&&t.data("editor")}function dt(e){var t;return null==e||null==(t=e.dataset)?void 0:t.modalLookup}function ut(e){var t;return null==e||null==(t=e.dataset)?void 0:t.filter}function ct(e){var t=l.default(e);return t.is(":hidden")&&t.data("autosuggest")}function ft(e){return null==e||null==e.matches?void 0:e.matches("select.select2-hidden-accessible")}function pt(e){return(null==e||null==e.matches?void 0:e.matches("select:not(.select2-hidden-accessible)"))&&"select-one"==e.type}function ht(e){return(null==e||null==e.matches?void 0:e.matches("input:not([type=checkbox]):not([type=radio])"))&&!ct(e)}function mt(e){return null==e||null==e.matches?void 0:e.matches("input[type=checkbox][data-boolean]")}function gt(e,t){if(e){var a=l.default(e);if(!Pt(a)){if(st(e))return a.data("editor").focus();!e.options&&e.length?e=a[0]:ct(e)&&(e=e.input),e.focus(t)}}}function wt(e){if(!e)return;let t=l.default(e);if(Pt(t))return;!e.options&&e.length&&(e=t[0]);let a=t.closest(Se),n=()=>a.find(".is-valid").removeClass("is-valid");if(ct(e))a.find(".ew-auto-suggest").removeClass("is-invalid").addClass("is-valid").one("click keydown paste",n);else if(st(e))t.removeClass("is-invalid").addClass("is-valid"),t.data("editor").instance.once("change",n);else if(dt(e))t.removeClass("is-invalid").addClass("is-valid").one("select2:open",n);else if(["checkbox","radio"].includes(e.type))t.removeClass("is-invalid").addClass("is-valid").one("click keydown",n);else{let e=ew.MOBILE_DETECT.version("Safari")&&!ew.MOBILE_DETECT.version("Chrome")?"change keydown paste":"click keydown paste";t.parent().one(e,n),t.add(t.closest(".input-group")).removeClass("is-invalid").addClass("is-valid")}}function vt(e){var t;let a=null==e?void 0:e.closest(".os-host");a?null==(t=OverlayScrollbars(a))||t.scroll(e):null==e||e.scrollIntoView()}function bt(e){return!(null==e||!e.querySelector("input[type=checkbox][name='key_m[]']:checked"))}function yt(e){null!=e&&e.form&&l.default(e.form.elements).filter("input[type=checkbox][name^="+e.name+"_], [type=checkbox][name="+e.name+"]").not(e).not(":disabled").prop("checked",e.checked)}function _t(e){let t=l.default(e).find("input[type=checkbox][name='key_m[]']:checked").closest("[data-rowindex]").map(((e,t)=>t.dataset.rowindex)).get();l.default(null==e?void 0:e.rows).filter(((e,a)=>a.classList.contains("table-active")&&!t.includes(a.dataset.rowindex))).removeClass("table-active ew-table-selected-row").triggerHandler("change")}function Et(e){if(!(null==e?void 0:e.closest(".ew-table")))return;let t=l.default(e).closest(".ew-table > tbody > tr");t.siblings("[data-rowindex='"+t.data("rowindex")+"']").addBack().removeClass("table-active").triggerHandler("change")}function At(e){let t=null==e?void 0:e.closest(".ew-table");if(!t)return;_t(t);let a=l.default(e).closest(".ew-table > tbody > tr");a.siblings("[data-rowindex='"+a.data("rowindex")+"']").addBack().addClass("table-active").triggerHandler("change")}function St(){let e,t;l.default.isNumber(arguments[0])?e=arguments[1]:arguments[0]instanceof HTMLTableElement&&(e=arguments[0],t=arguments[1]);let a=l.default(e),n=l.default(e.rows);if(!e||!e.rows||!t&&e.dataset.isset||0==e.tBodies.length)return;let i=function(e){let t=l.default(this),a=this.closest(".ew-table"),n=l.default(e.target);!a||n.hasClass("btn")||n.hasClass("ew-preview-btn")||n.is(":input")||(_t(a),t.siblings("[data-rowindex='"+t.data("rowindex")+"']").addBack().toggleClass("table-active").triggerHandler("change"))},r=n.filter("[data-rowindex=1]").length||n.filter("[data-rowindex=0]").length||1,o=n.filter(":not(.ew-template)").each((function(){l.default(this.cells).removeClass("ew-table-last-row").last().addClass("ew-table-last-col")})).get();if(o.length>=r){let t=a.parentsUntil(".ew-grid","."+ew.RESPONSIVE_TABLE_CLASS)[0];o[o.length-1].classList.add("border-bottom-0"),o.splice(-1*r).forEach(((a,n)=>Array.from(a.cells).filter((e=>e.rowSpan==n+1)).forEach((a=>{a.classList.add("ew-table-last-row"),a.classList.toggle("ew-table-border-bottom",(null==t?void 0:t.clientHeight)>e.offsetHeight)}))))}let s=e.closest("form"),d=s&&l.default(s.elements).filter("input#action:not([value^=grid])").length>0;l.default(e.tBodies[e.tBodies.length-1].rows).filter(":not(.ew-template):not(.ew-table-preview-row)").each((function(){let e=l.default(this);d&&!e.data("isset")&&e.on("click",i).data("isset",!0)})),Tt(e.closest(".ew-grid"),t),e.dataset.isset="true"}function Tt(e,t){let a=l.default(e);!e||!t&&e.dataset.isset||(0!=a.find("table.ew-table > tbody").first().children("tr:not(.ew-table-preview-row, .ew-template)").length||e.querySelector(".ew-grid-upper-panel, .ew-grid-lower-panel")||a.hide(),a.find(".ew-grid-middle-panel:visible").hasClass(ew.RESPONSIVE_TABLE_CLASS)&&a.width()>l.default(".content").width()&&(a.addClass("d-flex"),a.closest(".ew-detail-pages").addClass("d-block"),a.closest(".ew-form").addClass("w-100")),e.dataset.isset="true")}function Ot(e){return String(e).replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">")}function It(e,t){let a=(t=l.default.isString(t)?/^#/.test(t)?t:"#"+t:t)?l.default(t):Ee,n=[],i=e=>"[data-field='"+e+"']:not(.ew-custom-option):not([name^=y_]):not([data-old])";if(e instanceof HTMLElement&&e.dataset.table&&e.dataset.field){if(mt(e))return e;n=["[data-table='"+e.dataset.table+"']"+i(e.dataset.field)]}else if(l.default.isString(e)){let[t,a]=e.split(" ");n=a?["[data-table='"+t+"']"+i(jt(a))]:["[name='"+e+"']:not(.ew-custom-option):not([data-old])",i(jt(e))]}let r=["input","select","textarea","button","selection-list"].flatMap((e=>n.map((t=>e+t)))).join(),o=a.find(r);return a.is("form.ew-form")&&a.find("div.ew-form")[0]&&(o=o.not("div.ew-form *")),1==o.length&&(o.is(":not([type=checkbox]):not([type=radio])")||mt(o[0]))||2==o.length&&o.eq(0).is("selection-list")&&o.eq(1).is("input[type=hidden]")?o[0]:o[0]?o.get():null}function xt(e,t){t=l.default.isString(t)?/^#/.test(t)?t:"#"+t:t;let a="#"+e.replace(/([\$\[\]])/g,"\\$1")+",[name='"+e+"']";return t?l.default(t).find(a)[0]:l.default(a).first()[0]}function Ct(e,t){for(;e=e.parentNode;){var a;if(1==(null==(a=e)?void 0:a.nodeType)&&(!t||t(e)))return e}return null}function Pt(e){var t=l.default(e);return"none"==t.css("display")&&!t.is("selection-list")&&!t.closest(".dropdown-menu")[0]&&!dt(e)&&!ct(e)&&!st(e)||null!=Ct(e,(e=>"none"==e.style.display&&!e.classList.contains("tab-pane")&&!e.classList.contains("collapse")))}function Nt(e,t){return String(e).toLowerCase()==String(t).toLowerCase()}function Rt(e){return e?String(e).replace(/^[^A-Za-z0-9]*|[^A-Za-z0-9]*$/g,"").replace(/([a-z])([A-Z])/g,((e,t,a)=>t+"_"+a.toLowerCase())).replace(/[^A-Za-z0-9]+|_+/g,"-").toLowerCase().replace(/(-?)(\w+)(-?)/g,((e,t,a,n)=>t+a.charAt(0).toUpperCase()+a.slice(1)+n)):""}function Lt(e,t){if((e=e instanceof URL?e.pathname:xe(e).pathname)!=(t=t instanceof URL?t.pathname:xe(t).pathname)&&e.startsWith(ew.PATH_BASE)&&t.startsWith(ew.PATH_BASE)){e=e.substring(ew.PATH_BASE.length),t=t.substring(ew.PATH_BASE.length);let a=e.split("/"),n=t.split("/");if(a[0]==n[0]&&a[0].match(/(list|view|edit)$/i)||a[0]==n[0]&&a[1]==n[1]&&[ew.LIST_ACTION,ew.VIEW_ACTION,ew.EDIT_ACTION].includes(a[1]))return!0}return e==t}function Ft(e,t){let a=e;if(l.default.isString(e)?a=2==e.split(" ").length?It(e):It(e,t):["checkbox","radio"].includes(e.type)&&(a=It(e)),!a)return[];if(a.options){if(a.list)return a.values;if(ft(a)){let e=l.default(a).val();return Array.isArray(e)?e:l.default.isValue(e)?[e]:[]}return Array.from(a.options).filter((e=>e.selected&&""!==e.value)).map((e=>e.value))}return Array.isArray(a)||mt(a)?l.default(a).filter(":checked").map((function(){return this.value})).get():ew.isHiddenTextArea(a)?(l.default(a).data("editor").save(),[a.value]):[a.value]}function kt(e,t){return Ft(e,t).join(ew.MULTIPLE_OPTION_SEPARATOR)}function Dt(e,t){let a=e;return l.default.isString(e)?a=2==e.split(" ").length?It(e):It(e,t):["checkbox","radio"].includes(e.type)&&(a=It(e)),a?ct(a)?[a.input.value]:a.options?ft(a)?l.default(a).find(":selected").map(((e,t)=>t.innerHTML)).get():Array.from(a.options).filter((e=>e.selected&&""!==e.value)).map((e=>e.text)):Array.isArray(a)||mt(a)?l.default(a).filter(":checked").map((function(){return l.default(this).parent().text()})).get():ew.isHiddenTextArea(a)?(l.default(a).data("editor").save(),[a.value]):[a.value]:[]}function Mt(e){if(e.options){var t="select-multiple"==e.type||e.hasAttribute("data-dropdown")||e.length>0&&""!=e.options[0].value?0:1;if(e.list)e.removeAll(),e.render();else for(var a=e.length-1;a>=t;a--)e.remove(a);ct(e)&&(e.input.value="",e.value="")}}function jt(e,t){var a=l.default.isString(e)?e:l.default(e).attr("name")||l.default(e).attr("id");return!1!==t?a.replace(/\[\]$/,""):a}function $t(e,t){var a=l.default(t).data("value-separator");return Array.isArray(a)?a[e-1]:a||", "}function Ut(e,t){return[e.df,e.df2,e.df3,e.df4].reduce(((e,a,n)=>{let i=n>0?$t(n-1,t):"";return!l.default.isUndefined(i)&&l.default.isValue(a)&&""!=a?e+i+a:e}),"")}function Bt(e){return ew.OPTION_HTML_TEMPLATE.replace(/\{value\}/g,e)}function Vt(e,t,a,n){let i=_e.get(a.id),l=jt(e),r=i.getList(e),o=t.gf,s=t.lf,d=i.getOptionTemplate(r),u=null!=d&&d.render&&!ct(e)?d.render(t,ew.jsRenderHelpers):Ut(t,e)||s;if(e.options){let i;e.list?i=new ew.SelectionListOption(u,s,!!n):(i=document.createElement("option"),i.value=s,i.innerHTML=u,i.selected=!!n);let r={name:l,form:a.$element,data:t,group:o,option:i};if(Ee.trigger("newoption",[r]),e.list)e.addOption(r.option);else if(r.group&&!ft(e)){var c;let t=Array.from(null!=(c=e.querySelector(":scope > optgroup"))?c:[]).find((e=>e.label==r.group));t||(t=document.createElement("optgroup"),t.label=r.group,e.add(t)),t.appendChild(r.option)}else e.add(r.option);return r.option.text}return u}function Kt(e,t,a){var n,i,r;if(void 0===a&&(a=!0),!e||!t)return;let o=l.default(e);if(t=Array.isArray(t)?t:[t],e.options){var s;if(e.list)e.value=t;else o.val(t),a&&ft(e)&&o.triggerHandler("change"),"select-one"!=e.type||-1!=e.selectedIndex||null!=(s=e.options[0])&&s.value||(e.selectedIndex=0);if(ct(e)&&1==t.length){let a=e.options||[];for(let n of a)if(n.value==t[0]){e.value=n.value,e.input.value=n.text;break}}}else mt(e)?e.checked=lt(t.join(ew.MULTIPLE_OPTION_SEPARATOR)):e.type&&"file"!=e.type&&(o.val(t.join(ew.MULTIPLE_OPTION_SEPARATOR)),st(o)&&o.data("editor").set());if("false"===(null==(n=e.dataset)?void 0:n.autoselect))return;let d=et(e);if(d&&!(d.id.endsWith("search")||d.id.endsWith("srch")||0===(null==(i=_e.get(d.id).getList(e))||null==(r=i.parentFields)?void 0:r.length))&&e.options&&(e.list||"select-one"!=e.type||2!=e.options.length||e.options[1].selected?1!=e.options.length||e.options[0].selected||(e.options[0].selected=!0,!a||o.trigger("change")):(e.options[1].selected=!0,!a||o.trigger("change")),ct(e))){let t=e.options||[];1==t.length&&(e.value=t[0].value,e.input.value=t[0].text)}}function qt(e,t){var a,n;null!=t||(t={}),t.headers=new Headers(t.headers||{});let i=e.startsWith(Ie());i&&ew.API_JWT_TOKEN&&!ew.IS_WINDOWS_AUTHENTICATION&&t.headers.set(ew.API_JWT_AUTHORIZATION_HEADER,"Bearer "+ew.API_JWT_TOKEN),(i||null!=(a=t.headers)&&null!=(n=a.get("Content-Type"))&&n.includes("application/json"))&&(t.headers.set(Rt(ew.TOKEN_NAME_KEY),ew.TOKEN_NAME),t.headers.set(Rt(ew.ANTIFORGERY_TOKEN_KEY),ew.ANTIFORGERY_TOKEN)),!t.method||Nt(t.method,"GET")?(e=Ne(e,t.body),delete t.body):t.body=Re(t.body,{[ew.TOKEN_NAME_KEY]:ew.TOKEN_NAME,[ew.ANTIFORGERY_TOKEN_KEY]:ew.ANTIFORGERY_TOKEN});let l={url:e,init:t};return Ee.trigger("fetch",[l]),fetch(l.url,l.init)}function Ht(){l.default("form.ew-form.ew-wait").removeClass("ew-wait").each((function(){var e=_e.get(this.id);e&&(e.multiPage&&e.multiPage.lastPageSubmit||e.enableForm())})),Ee.data("_ajax",!1)}function Wt(e,t,a){let n=a?/<(head)[^>]*>[\s\S]*?<\/\1\s*>/gi:/<(head|template)[^>]*>[\s\S]*?<\/\1\s*>/gi,i=e.replaceAll(n,"").matchAll(/<script[^>]*>[\s\S]*?<\/script\s*>/gi);Array.from(document.createRange().createContextualFragment(Array.from(i).map((e=>e[0])).filter((e=>!e.includes("$rowindex$"))).join("")).querySelectorAll("script:not([type]), script[type='text/javascript']")).sort(((e,t)=>t.classList.contains("ew-apply-template")?1:e.classList.contains("ew-apply-template")?-1:0)).forEach(((e,a)=>Yt(e,"scr_"+t+"_"+a)))}function Gt(e){let t=e.replaceAll(/<(head|template)[^>]*>[\s\S]*?<\/\1\s*>/gi,"").matchAll(/<script([^>]*)>([\s\S]*?)<\/script\s*>/gi);return Array.from(t).filter((e=>document.createRange().createContextualFragment(e[0]).querySelector("script:not([type]), script[type='text/javascript']"))).reduce(((e,t)=>e.replace(t[0],"")),e)}function Yt(e,t){let a=e instanceof HTMLScriptElement?e:document.createElement("SCRIPT");return l.default.isString(e)&&(a.text=e),t&&(a.id=t),document.body.appendChild(a)}function zt(e){e&&l.default("script[id^='scr_"+e+"_']").remove()}function Jt(e,t){var a;e=e.trim().replace(/<head>[\s\S]*<\/head>/,"");let n=t?e:Gt(e),i=n.match(/<body[\s\S]*>[\s\S]*<\/body>/i);n=null!=(a=null==i?void 0:i[0])?a:n;let r=l.default(n).find("section.content");return r[0]?r.html():n}function Xt(e){return null!=e&&e.options?Array.prototype.map.call(e.options,(e=>[e.value,e.text])):[]}function Zt(){let e=l.default(this),t=e.data("args"),a=e.removeData("args").find(".modal-body form").data("form");zt("modal_dialog"),null==a||a.destroyEditor(),e.find(".modal-footer .btn-primary").off(),e.find(".modal-dialog").removeClass(((e,t)=>{let a=t.match(/table\-\w+/);return a?a[0]:""})),e.data({showing:!1,url:null}),null!=t&&t.reload&&window.location.reload()}function Qt(e){let t=_e.get(e).$element[0];if(!t)return;let a=Ft(e),n=jt(e),i=n.match(/^([xy])(\d*)_/),r=i?i[2]:"",o=_e.get(e).getList(n),s=o.autoFillTargetFields,d=function(a){let i=null==a?void 0:a.records,o=Array.isArray(i)&&i.length>0?i[0]:[];for(let a=0;a<s.length;a++){let d=It(s[a].replace(/^x_/,"x"+r+"_"),t);if(d){let r=l.default.isValue(o["af"+a])?String(o["af"+a]):"",u={results:i,result:o,data:r,form:t,name:n,target:s[a],cancel:!1,trigger:!0};if(l.default(e).trigger("autofill",[u]),u.cancel)continue;r=u.data,d.options?(Kt(d,r.split(",")),ct(d)&&(d.input.value=r,tt.call(_e.get(t.id),d))):st(d)?(d.value=r,l.default(d).data("editor").set()):"checkbox"==d.type?d.checked=lt(r):d.value=r,u.trigger&&l.default(d).trigger("change")}}return o};if(a.length>0&&""!=a[0]){let e=Object.assign({page:o.page,field:o.field,ajax:"autofill",v0:a[0],language:ew.LANGUAGE_ID},nt("#p_"+n,t)),i=o.parentFields.slice();if(""!=r)for(let e=0,t=i.length;e<t;e++){1==i[e].split(" ").length&&(i[e]=i[e].replace(/^x_/,"x"+r+"_"))}return i.map((e=>kt(e,t))).forEach(((t,a)=>e["v"+(a+1)]=t)),l.default.post(Ie(ew.API_LOOKUP_ACTION),e,d,"json")}return d()}function ea(e,t){var a=l.default(t),n=l.default("#"+a.data("tooltip-id")),i=a.data("trigger")||"hover",r=a.data("placement")||"auto";n[0]&&(""!=n.text().trim()||n.find("img[src!='']")[0])&&(bootstrap.Popover.getInstance(t)||a.popover({...ew.popoverOptions,placement:r,trigger:i,delay:100,container:document.getElementById("ew-tooltip"),content:n.html()}).on("show.bs.popover",(function(){var e=a.data("tooltip-width");e&&l.default(bootstrap.Popover.getInstance(this)._getTipElement()).css("max-width",parseInt(e,10)+"px")})))}function ta(e){var t;let a=null!=(t=null==e?void 0:e.target)?t:document,n=null==a?void 0:a.querySelector(".ew-filter-option");ew.CLIENT_SEARCH_FILTER||ew.SERVER_SEARCH_FILTER&&ew.IS_LOGGEDIN&&!ew.IS_SYS_ADMIN&&""!=ew.CURRENT_USER_NAME?l.default(n).removeClass("d-none").find(".ew-btn-dropdown").on("show.bs.dropdown",(function(e){var t,a;let n=l.default(this).find(".ew-save-filter[data-form], .ew-delete-filter[data-form]").data("form"),i=ew.forms.get(n),r=ew.CLIENT_SEARCH_FILTER?ew.parseJson(localStorage.getItem(ew.PROJECT_NAME+"_"+i.id+"_filters")||"[]")||[]:null!=(t=null==i||null==(a=i.filterList)?void 0:a.filters)?t:[];i.setupFilters(e,r.filter((e=>Array.isArray(e)&&2==e.length)))})):null==n||n.classList.add("d-none")}function aa(e,t){let a=window.parent.Swal;return t=Re(t,[[ew.TOKEN_NAME_KEY,ew.TOKEN_NAME],[ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN]]),a.fire({...ew.sweetAlertSettings,showConfirmButton:!1,html:"<p>"+ew.language.phrase("Exporting")+"</p>",allowOutsideClick:!1,allowEscapeKey:!1,willOpen:()=>{a.showLoading(),qt(Ie([ew.API_EXPORT_ACTION,"email",e])+"?rnd="+sa(),{method:"POST",body:t}).then((async n=>{a.hideLoading();let i=await n.json();var l;null!=i&&i.success?(a.update({html:"<div class='text-success'>"+i.message+"</div>"}),Ee.trigger("export",[{type:"done",tblVar:e,data:t,result:i}])):(a.update({html:null!=(l="<div class='text-danger'>"+Ue(i))?l:ew.language.phrase("FailedToExport")+"</div>"}),Ee.trigger("export",[{type:"fail",tblVar:e,data:t,result:i}]))})).catch((n=>{var i;a.hideLoading(),a.update({html:null!=(i="<div class='text-danger'>"+n)?i:ew.language.phrase("FailedToExport")+"</div>"}),Ee.trigger("export",[{type:"fail",tblVar:e,data:t,error:n}])})).finally((()=>{a.update({showConfirmButton:!0}),Ee.trigger("export",[{type:"always",tblVar:e,data:t}])}))}})}function na(){return location.href.split("#")[0].split("?")[0]}function ia(e){var t,a;const n=(null==(t=e=l.default.isString(e)?document.querySelector(e):e)?void 0:t.value)||(null==(a=e)?void 0:a.innerText);if(n){const e=document.createElement("textarea");e.value=n,e.setAttribute("readonly",""),e.style.position="absolute",e.style.left="-9999px",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}return n}function la(e){return!(e=String(e))||0==e.length||(e=e.trim(),null!==ew.parseNumber(e))}function ra(e){return!e||0==e.length||/^[\w.%+-]+@[\w.-]+\.[A-Z]{2,18}$/i.test(e.trim())}function oa(e){var t;let a,n;try{[a,n]=[window.parent.document,window.parent.Swal]}catch(e){[a,n]=[window.document,window.Swal]}let i=null!=(t=null==e?void 0:e.target)?t:a,r=l.default(i).find("div.ew-message-dialog.d-none").first(),o=r.length?r.text():"";if(l.default.isString(e)&&(o=l.default("<div>"+e.trim()+"</div>").text()),""!=o.trim())return r.length&&["success","info","warning","danger"].forEach((function(e){let t=r.find(".alert-"+e).toggleClass("alert-"+e),a=t.find(".alert-heading").detach(),n=t.children(":not(.icon)");if(t.find(".icon").remove(),t[0]){let i=parseInt(n.css("width"),10);i>0&&n.first().css("width","auto");let l=Qe(t.html(),e,a.html());i>0&&l.css("max-width",i)}else;})),l.default.isString(e)?n.fire({...ew.sweetAlertSettings,html:e}):void 0}function sa(){return Math.floor(100001*Math.random())+1e5}Pace.on("done",(()=>{var e;let t=document.querySelector(".modal.show form.ew-form")||document.querySelector("form.ew-form");null==(e=_e.get(null==t?void 0:t.id))||e.tryFocus()})),Ee.ajaxSend((function(e,t,a){let n=a.url,i=n.startsWith(Ie()),r=i||n.startsWith(ew.PATH_BASE)||n.startsWith(na());if(!r&&n.match(/^http/i)){r=new URL(n).hostname==ye.hostname}if(r)if(i&&ew.API_JWT_TOKEN&&!ew.IS_WINDOWS_AUTHENTICATION&&t.setRequestHeader(ew.API_JWT_AUTHORIZATION_HEADER,"Bearer "+ew.API_JWT_TOKEN),i||l.default.isString(a.contentType)&&a.contentType.includes("application/json"))t.setRequestHeader(Rt(ew.TOKEN_NAME_KEY),ew.TOKEN_NAME),t.setRequestHeader(Rt(ew.ANTIFORGERY_TOKEN_KEY),ew.ANTIFORGERY_TOKEN);else if(Nt(a.type,"POST")){let e=Re(new URLSearchParams(a.data),{[ew.TOKEN_NAME_KEY]:ew.TOKEN_NAME,[ew.ANTIFORGERY_TOKEN_KEY]:ew.ANTIFORGERY_TOKEN});a.data=e.toString()}})),Ee.ajaxStart((function(){Ee.data("_ajax",!0),l.default("form.ew-form").addClass("ew-wait").each((function(){var e=_e.get(this.id);e&&(e.multiPage&&e.multiPage.lastPageSubmit||e.disableForm())}))})),Ee.ajaxStop(Ht).ajaxError(Ht);let da=r.default.DateTime,ua=r.default.Interval;function ca(e,t){let a;return l.default.isString(e)?a=da.fromSQL(e,{zone:"utc"}):l.default.isNumber(e)?a=da.fromSeconds(e,{zone:"utc"}):e instanceof Date?a=da.fromJSDate(e,{zone:"utc"}):e instanceof da&&(a=e),a.toFormat(t,{locale:ew.LANGUAGE_ID,numberingSystem:ew.getNumberingSystem()})}function fa(e,t){return da.fromFormat(e,t,{locale:ew.LANGUAGE_ID,numberingSystem:ew.getNumberingSystem()})}function pa(e,t,a,n){var i;let l;if((null!=(i=ew.vars)&&i.login?Array.from(Object.entries(ew.vars.login)).filter((e=>e[0].endsWith("Url"))).map((e=>e[1])):[]).includes(e))return window.location=e,!1;if(e.startsWith("http"))l=new URL(e);else{if(!e.startsWith("/"))return Je(ew.language.phrase("IncorrectUrl")),!1;l=new URL(e,location.protocol+"//"+location.host)}let r=l.searchParams;if(n&&(r=Re(r,n)),Nt(a,"post")){const a=t||document.createElement("form");a.method="post",a.action=e.split("?")[0],document.body.appendChild(a),r.set(ew.TOKEN_NAME_KEY,ew.TOKEN_NAME),r.set(ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN),r.forEach(((e,t)=>{const n=document.createElement("input");n.type="hidden",n.name=t,n.value=ew.sanitize(e),a.appendChild(n)})),a.submit()}else window.location=Me(l.toString());return!1}function ha(){return window.matchMedia(ew.screenMediaQuery).matches}function ma(e,t){null!=t||(t=".ew-card.ew-grid"),t=t.startsWith(".")||t.startsWith("#")?t:"."+t;let a=document.querySelector(t+", .ew-multi-column-grid, .ew-view-form, .ew-edit-form, main.ew-no-record");if(!a)return;let n=l.default(ew.overlayTemplate()),i=l.default(a).addClass("ew-loading").toggleClass("overlay-wrapper",!a.classList.contains("card")).append(n);return e.then((async e=>{if(!(e instanceof Response))return e;let n=e.headers.get("Content-Type");if(null!=n&&n.includes("json")){let t=await e.json(),n=t.validation,i=Ue(t),r=a.querySelector(".ew-form"),o=ew.forms.get(r);if(o&&n){for(let[e,t]of Object.entries(n))if(e=parseInt(e,10),l.default.isNumber(e)&&l.default.isObject(t)){r.dataset.rowindex=e;for(let[a,n]of Object.entries(t))o.addCustomError(a,n,e)}else l.default.isString(t)&&o.addCustomError(e,t);o.focus()}return i?Qe(i):l.default.isString(t.warningMessage)?Qe(t.warningMessage,"warning"):l.default.isString(t.message)?Qe(t.message,"body"):l.default.isString(t.successMessage)&&Qe(t.successMessage,"success"),!1}let r=await e.text(),o=new URL(e.url),s=[".ew-message-dialog",".ew-chart-top",".ew-chart-bottom",".ew-debug .card-body",".ew-timer"];"false"==o.searchParams.get("layout")&&(r="<div>"+r+"</div>",o.searchParams.delete("layout")),o.searchParams.delete("rnd"),o.searchParams.delete("action"),r=Jt(r,!0);let d=l.default("<div>"+r+"</div>");a.closest(".ew-dashboard")||(s.unshift(".ew-toolbar"),Lt(o,ye)&&ye.toString()!=o.toString()&&window.history.pushState(null,"",o.toString())),s=d.find("main.ew-no-record")[0]||i.is("main.ew-no-record")?[".ew-ext-search-form","main",...s]:i.hasClass("ew-view-form")?[".ew-view-form",".ew-pager",...s]:i.hasClass("ew-edit-form")?[".ew-edit-form",".ew-pager",...s]:i.hasClass("ew-multi-column-grid")?[".ew-ext-search-form",".ew-multi-column-grid",...s]:["#ew-filter-list",".ew-ext-search-form",t+" .card-header",t+" .card-body",t+" .card-footer",...s],s.forEach((e=>l.default(e).each(((t,a)=>{let n=l.default(a),i=d.find(e).eq(t);if(n[0]&&i[0]&&(delete a.dataset.isset,n.html(i.html()),n.attr("class",i.attr("class"))),".ew-toolbar"==e){let e={target:a};Te(e),ta(e)}else if(".ew-ext-search-form"==e){ew.initForms({target:i[0]});let e=i.find("#navbar-basic-search");if(e[0]){let t=e.render(null,ew.jsRenderHelpers),a=l.default(t),n=a.find("#"+ew.TABLE_BASIC_SEARCH),i=a.find("#"+ew.TABLE_BASIC_SEARCH_TYPE);n.val()==l.default("#"+ew.TABLE_BASIC_SEARCH).val()&&i.val()==l.default("#"+ew.TABLE_BASIC_SEARCH_TYPE).val()||l.default(".nav-item.navbar-basic-search").replaceWith(a)}n.find(".ew-search-operator .form-select.ew-operator-select").each(((e,t)=>Ge(t)))}else".ew-message-dialog"==e&&(i.hasClass("d-none")||n.html(i.html()))})))),s.filter((e=>".ew-message-dialog"!=e)).forEach((e=>d.find(e).remove())),zt("refresh"),Wt(d.html(),"refresh");let u=l.default.Event({type:"load.ew",target:a});ew.initPage(u),s.includes(".ew-toolbar")&&ew.initExportLinks(),a.querySelectorAll(".btn-group").forEach((e=>{var t;return null==(t=bootstrap.Tooltip.getInstance(e))?void 0:t.update()})),l.default(".toast.show").toast("dispose"),oa({target:d}),Ee.trigger(u),Ee.trigger(l.default.Event({type:"refresh.ew",target:a}))})).finally((()=>i.removeClass("ew-loading").find(n).remove()))}var ga;var wa={__proto__:null,currentUrl:ye,forms:_e,AjaxLookup:A,AutoSuggest:S,Form:_,Field:y,Select2Utils:ee,Select2Defaults:be,fieldContainerSelector:Se,createSelect:function(e){if(e.selectId.includes("$rowindex$"))return;if(l.default.isObject(e.data)){let t=new ew.AjaxLookup(e.data);e.data=t.toSelect2Data(t.options)}if(l.default.isObject(e.ajax)){let t=e.ajax.limit,a=new ew.AjaxLookup({...e.ajax,action:"modal"});e.ajax={url:e=>{let n=e.page?(e.page-1)*t:-1;return a.getUrl(e.term,n)},type:"POST",dataType:"json",data:a.generateRequest.bind(a),delay:e.debounce,processResults:function(e){var t,n;return{results:a.toSelect2Data(a.transform(e)),pagination:{more:this.container.$results.find(".select2-results__option:not(.select2-results__option--load-more)").length+(null!=(t=null==(n=e.records)?void 0:n.length)?t:0)<a.recordCount}}},transport:(e,t,a)=>l.default.ajax(e).then((e=>{let a=Ue(e);!a||Je(a),t(e)})).fail(a)}}let t={name:e.name,options:e};Ee.trigger("select2",[t]);let a=l.default("select[data-select2-id='"+e.selectId+"']").select2(t.options);a.on("select2:open",(function(){var e;null==(e=l.default(this).data("select2").$dropdown.find(".select2-search__field")[0])||e.focus()})),l.default.isObject(e.ajax)&&a.on("select2:opening",(function(){l.default(this).data("select2").$results.find(".select2-results__option:not(.loading-results)").remove()})),e.minimumResultsForSearch===1/0&&a.on("select2:opening select2:closing",(function(){l.default(this).data("select2").$dropdown.find(".select2-search--dropdown").addClass("select2-search--hide")}))},createModalLookup:function(e){if(e.selectId.includes("$rowindex$"))return;if(l.default.isObject(e.data)){let t=new ew.AjaxLookup(e.data);e.data=t.options.map((e=>({id:e.lf,text:t.formatResult({lf:e.lf,df:e.df,df2:e.df2,df3:e.df3,df4:e.df4})})))}if(l.default.isObject(e.ajax)){let t=e.ajax.limit,a=new ew.AjaxLookup({...e.ajax,action:"modal"});e.ajax={url:e=>{let n=e.page?(e.page-1)*t:-1;return a.getUrl(e.term,n)},type:"POST",dataType:"json",data:a.generateRequest.bind(a),delay:e.debounce,processResults:function(e){var t,n;return{results:a.transform(e).map((e=>({id:e.lf,text:a.formatResult({lf:e.lf,df:e.df,df2:e.df2,df3:e.df3,df4:e.df4})}))),pagination:{more:this.container.$results.find(".select2-results__option:not(.select2-results__option--load-more)").length+(null!=(t=null==(n=e.records)?void 0:n.length)?t:0)<a.recordCount}}},transport:(e,t,a)=>l.default.ajax(e).then((e=>{let a=Ue(e);!a||Je(a),t(e)})).fail(a)}}let t=l.default("select[data-select2-id='"+e.selectId+"']").select2(e);t.on("select2:open",(function(){var e;null==(e=l.default(this).data("select2").$dropdown.find(".select2-search__field").addClass("form-control")[0])||e.focus()})),l.default.isObject(e.ajax)&&t.on("select2:opening",(function(){l.default(this).data("select2").$results.find(".select2-results__option:not(.loading-results)").remove()}))},createFilter:function(e){if(e.selectId.includes("$rowindex$"))return;if(l.default.isObject(e.data)){let t=new ew.AjaxLookup(e.data);e.data=t.options.map((e=>({id:e.lf,text:t.formatResult({lf:e.lf,df:e.df,df2:e.df2,df3:e.df3,df4:e.df4})})))}if(l.default.isObject(e.ajax)){let t=e.ajax.limit,a=new ew.AjaxLookup({...e.ajax,action:"modal"});e.ajax={url:e=>{let n=e.page?(e.page-1)*t:-1;return a.getUrl(e.term,n)},type:"POST",dataType:"json",data:a.generateRequest.bind(a),delay:e.debounce,processResults:function(e){var t,n;return{results:a.transform(e).map((e=>({id:e.lf,text:a.formatResult({lf:e.lf,df:e.df,df2:e.df2,df3:e.df3,df4:e.df4})}))),pagination:{more:this.container.$results.find(".select2-results__option:not(.select2-results__option--load-more)").length+(null!=(t=null==(n=e.records)?void 0:n.length)?t:0)<a.recordCount}}},transport:(e,t,a)=>l.default.ajax(e).then((e=>{let a=Ue(e);!a||Je(a),t(e)})).fail(a)}}let t=l.default("select[data-select2-id='"+e.selectId+"']").select2(e);t.on("select2:open",(function(){var t;null==(t=l.default(this).data("select2").$dropdown.find(".select2-search__field").addClass("form-control")[0])||t.focus({preventScroll:e.preventScroll})})),l.default.isObject(e.ajax)&&t.on("select2:opening",(function(){l.default(this).data("select2").$results.find(".select2-results__option:not(.loading-results)").remove()}))},initIcons:Te,initPasswordOptions:Oe,getApiUrl:Ie,parseUrl:xe,createSearchParams:Ce,getSearchParams:Pe,getSearchParam:function(e,t){return Pe(e).get(t)},setSearchParams:Ne,mergeSearchParams:Re,setSearchParam:Le,deleteSearchParam:Fe,buildUrl:ke,setLayout:De,sanitizeUrl:Me,setSessionTimer:function(){var e,t,a,n,i=ew.SESSION_KEEP_ALIVE_INTERVAL>0||ew.IS_LOGGEDIN&&ew.IS_AUTOLOGIN,r=()=>{l.default.get(Ie(ew.API_SESSION_ACTION),{rnd:sa()},(e=>{e&&l.default.isObject(e)&&(ew.TOKEN_NAME=e[ew.TOKEN_NAME_KEY],ew.ANTIFORGERY_TOKEN=e[ew.ANTIFORGERY_TOKEN_KEY],e.JWT&&(ew.API_JWT_TOKEN=e.JWT))}))},o=()=>{n=ew.SESSION_TIMEOUT_COUNTDOWN,(e=ew.SESSION_TIMEOUT-ew.SESSION_TIMEOUT_COUNTDOWN)<0&&(e=0,n=ew.SESSION_TIMEOUT),t&&t.cancel()},s=()=>{if(a&&a.cancel(),n>0){let e,t='<p class="text-danger">'+ew.language.phrase("SessionWillExpire")+"</p>";t.includes("%m")&&t.includes("%s")?(t=t.replace("%m",'<span class="ew-session-counter-minute">'+Math.floor(n/60)+"</span>"),t=t.replace("%s",'<span class="ew-session-counter-second">'+n%60+"</span>")):t.includes("%s")&&(t=t.replace("%s",'<span class="ew-session-counter-second">'+n+"</span>")),Swal.fire({...ew.sweetAlertSettings,html:t,showConfirmButton:!0,confirmButtonText:ew.language.phrase("OKBtn"),timer:1e3*n,timerProgressBar:!0,allowOutsideClick:!1,allowEscapeKey:!1,willOpen:()=>{e=setInterval((()=>{let e=Swal.getHtmlContainer(),t=e.querySelector(".ew-session-counter-minute"),a=e.querySelector(".ew-session-counter-second"),n=Math.round(Swal.getTimerLeft()/1e3);t&&a?(t.textContent=Math.floor(n/60),a.textContent=n%60):a&&(a.textContent=n)}),1e3)},willClose:()=>{clearInterval(e)}}).then((e=>{e.value?(r(),!i&&ew.SESSION_TIMEOUT>0&&d()):e.dismiss===Swal.DismissReason.timer&&(o(),window.location=Me(ew.TIMEOUT_URL+"?expired=1"))}))}},d=()=>{o(),t=l.default.later(1e3*e,null,s)};if(i){var u=ew.SESSION_KEEP_ALIVE_INTERVAL>0?ew.SESSION_KEEP_ALIVE_INTERVAL:ew.SESSION_TIMEOUT-ew.SESSION_TIMEOUT_COUNTDOWN;u<=0&&(u=60),a=l.default.later(1e3*u,null,r,null,!0)}else ew.SESSION_TIMEOUT>0&&d()},initExportLinks:je,initMultiSelectCheckboxes:$e,getError:Ue,fileDownload:Be,lazyLoad:Ve,updateDropdownPosition:function(){var e=l.default(".select2-container--open").prev(".ew-select").data("select2");e&&(e.dropdown._positionDropdown(),e.dropdown._resizeDropdown())},initLightboxes:Ke,initPdfObjects:qe,initTooltips:He,parseJson:We,searchOperatorChange:Ge,initForms:Ye,isFunction:ze,alert:Je,prompt:Xe,toast:Ze,showToast:Qe,getForm:et,hasFormData:function(e){for(var t="[name^=x_],[name^=y_],[name^=z_],[name^=w_],[name="+ew.TABLE_BASIC_SEARCH+"]",a=l.default(e).find(t).filter(":enabled").get(),n=0,i=a.length;n<i;n++){var r=a[n];if(/^(z|w)_/.test(r.name)){if(/^IS/.test(l.default(r).val()))return!0}else if("checkbox"==r.type||"radio"==r.type){if(r.checked)return!0}else if("select-one"==r.type||"select-multiple"==r.type){if(l.default(r).val())return!0}else if(["text","textarea","password","search","color","date","datetime-local","datetime","email","hidden","month","number","range","tel","time","url","week"].includes(r.type)&&r.value)return!0}return!1},setSearchType:function(e){var t=e.dataset.searchType,a="Auto";"="==t?a="Exact":"AND"==t?a="All":"OR"==t&&(a="Any"),e.closest(".ew-basic-search").querySelector("input.ew-basic-search-type").value=t||"",e.closest(".dropdown-menu").querySelectorAll(".dropdown-item").forEach((e=>e.classList.remove("active"))),e.closest(".dropdown-item").classList.add("active");var n=e.closest(".input-group").querySelector("#searchtype"),i=ew.language.phrase("QuickSearch"+a+"Short");return n.innerHTML=i,n.classList.toggle("me-2",!!i),!1},updateOptions:tt,getUserParams:nt,getQueryBuilderFilterInput:function(){return function(e,t){var a,n,i;let l=this.status.id.replace(/_query_builder$/,""),r=e.filter.id,o="tpx_"+l+"_"+r,s=null==(a=document.getElementById(o))||null==(n=a.content)?void 0:n.cloneNode(!0).querySelector(".ew-search-field");return'<div class="d-inline-flex position-relative">'+(null!=(i=null==s?void 0:s.innerHTML.replace(/\binvalid-feedback\b/,ew.queryBuilderErrorClass).replace(new RegExp('(data-field=")?(\\b|_)x_'+r+"\\b","g"),((e,a,n)=>a?e:n+t)))?i:"")+"</div>"}},getQueryBuilderValueSetter:function(){return function(e,t){let a=e.$el.find(".rule-value-container").find("select, selection-list, input[name^=sv_], input[data-field]")[0],n=Array.isArray(t)?t:l.default.isValue(t)?[t]:[];if(null!=a&&a.matches("select, selection-list")){let e=_e.get(a);n.forEach((t=>Vt(a,{lf:t},e,!0))),e.updateList(a,void 0,void 0,!0)}else ew.selectOption(a,n);return null}},getQueryBuilderFilterValidation:function(e){return{callback:function(t,a){let n=a.$el.find(".rule-value-container"),i=0;for(let t=0;t<a.operator.nb_inputs;t++)n.find("[name='"+a.id+"_value_"+t+"']").each((function(){let t=l.default(this),a=t.next("."+ew.queryBuilderErrorClass).empty();null==e||null==e.forEach||e.forEach((e=>{let t=e(this);l.default.isObject(t)&&(i++,a.append("<span>"+Object.values(t)[0]+"</span>"))})),a.html()&&t.addClass("is-invalid").one("click",(()=>t.removeClass("is-invalid")))}));return!i||""}}},applyTemplate:function(e,t,a,n,i,r,o){let s={data:r||{},id:e,template:t,class:a,export:n,enabled:!0};if(Ee.trigger("rendertemplate",[s]),s.enabled){var d;let a=o?document.querySelector("#ew-modal-dialog.show"):document.body,n=null==a||null==(d=a.querySelector("#"+t))?void 0:d.content;if(!n)return;if(n.querySelectorAll(".ew-slot").forEach((e=>{let t=e.name||e.id,n=a.querySelector("#"+t);null!=n&&n.content?(e.dataset.rowspan>1&&Array.prototype.slice.call(n.content.childNodes).forEach((t=>t.rowSpan=e.dataset.rowspan)),e.replaceWith(n.content.cloneNode(!0))):e.remove()})),l.default.views){let t=n.textContent,i=t.includes("{{")&&t.includes("}}");if(!i){let e=ew.jsRenderAttributes.map((e=>"["+e+"*='{{']["+e+"*='}}']")).join(",");i=n.querySelector(e)}if(i){let t=Array.prototype.slice.call(n.querySelectorAll("script"));t.forEach((e=>e.remove()));let i=document.createElement("div");i.appendChild(n);let r=i.innerHTML.replace(/{{([^}]+)}}/g,(e=>Ot(e))),o=l.default.templates(r);a.querySelector("#"+e).innerHTML=o.render(s.data,ew.jsRenderHelpers),t.forEach((e=>document.body.appendChild(e)))}else a.querySelector("#"+e).appendChild(n)}else a.querySelector("#"+e).appendChild(n)}n&&"print"!=n&&it(e,n,i)},exportCustom:it,toggleGroup:function(e){for(var t,a=l.default(e),n=a.closest("tr"),i="tr",r=1;r<=6;r++){var o=1==r?"":"-"+r,s=n.data("group"+o);l.default.isValue(s)&&(t=r,""!=s&&(i+="[data-group"+o+"='"+String(s).replace(/'/g,"\\'")+"']"))}a.hasClass("ew-rpt-grp-hide")?(l.default(i).slice(1).removeClass("ew-rpt-grp-hide-"+t),a.removeClass("ew-rpt-grp-hide")):(l.default(i).slice(1).addClass("ew-rpt-grp-hide-"+t),a.addClass("ew-rpt-grp-hide"))},convertToBool:lt,valueChanged:function(e,t,a,n){let i=It("x"+t+"_"+a,e),l=xt("o"+t+"_"+a,e),r=xt("fn_x"+t+"_"+a,e);if("hidden"==(null==i?void 0:i.type)&&!l)return!1;if(!l&&(!i||Array.isArray(i)&&0==i.length))return!1;if(l&&i)if(n){if(lt(kt(l))===lt(kt(i)))return!1}else{if(kt(l)==kt(r||i))return!1}return!0},setLanguage:function(e){let t=e.value||e.dataset.language;if(!t)return!1;let a=new URL(window.location);return a.searchParams.set("language",t),window.location=Me(a.toString()),!1},submitAction:function(e,t){var a;let n=e.currentTarget,i=t.f||n.form||n.closest("form"),r=l.default(i),o=t.key,s=t.action,d=t.url||na(),u=t.msg,c=t.data,f=t.success,p=!t.method||Nt(t.method[0],"p"),h=!t.select&&!t.key||t.select&&Nt(t.select[0],"m");if((h||p)&&!i)return Je(ew.language.phrase("NoHtmlForm")),!1;if(h&&!bt(i))return Je(ew.language.phrase("NoRecordSelected")),!1;let m=function(e){oa(e)},g=function(e,t){let a=r.find("input[type=hidden][name='"+e+"']");a[0]?a.val(t):l.default("<input>").attr({type:"hidden",name:e,value:t}).appendTo(r)},w=function(e){if(p&&i){if(s&&g("action",s),l.default.isUndefined(e)||g("actionvalue",e),l.default.isObject(c))for(const[e,t]of Object.entries(c))g(e,t);if(!h&&l.default.isObject(o))for(const[e,t]of Object.entries(o))g(e,t);xe(d).pathname!=ye.pathname&&r.off("submit.ew"),r.prop({action:d,method:"post"}).trigger("submit")}else{c=new URLSearchParams(c),s&&(c.set("action",s),c.set("ajax",s),r.find("#action").remove()),l.default.isUndefined(e)||c.set("actionvalue",e),c=Re(c,r.serialize()),!h&&l.default.isObject(o)&&(c=Re(c,o)),f&&l.default.isString(f)&&(f=window[f]);let t=l.default.isObject(f)?f:{};t.data=c.toString(),t.method||(t.method="POST"),t.success||(t.success=ze(f)?f:m),l.default.ajax(d,t)}};return u=l.default.isString(u)&&null!=(a=window[u])?a:u,u?Xe(u).then((e=>e.isDismissed||w(e.value))):w(),!1},getchartParams:rt,_export:ot,export:ot,removeSpaces:function(e){return/^(<(p|br)\/?>(&nbsp;)?(<\/p>)?)?$/i.test(e.replace(/\s/g,""))?"":e},isHiddenTextArea:st,isModalLookup:dt,isFilter:ut,isAutoSuggest:ct,isSelect2:ft,isNativeSelectOne:pt,isTextbox:ht,isBooleanCheckbox:mt,clearError:function(e){if(e.jquery){let t=e.attr("type");e="checkbox"==t||"radio"==t?e.get():e[0]}l.default(e).closest(Se).find(".invalid-feedback").html("")},onError:function(e,t,a,n){if(t.jquery){let e=t.attr("type");t="checkbox"==e||"radio"==e?t.get():t[0]}else t instanceof y&&(t=t.element);return l.default(t).closest(Se).find(".invalid-feedback").append("<p>"+a+"</p>"),n&&gt(t),null==e||e.makeVisible(t),!1},setFocus:gt,setInvalid:function(e){if(!e)return;let t=l.default(e);if(Pt(t))return;!e.options&&e.length&&(e=t[0]);let a=t.closest(Se),n=()=>a.find(".is-invalid").removeClass("is-invalid");if(ct(e))a.find(".ew-auto-suggest").removeClass("is-valid").addClass("is-invalid").one("click keydown paste",n);else if(st(e))t.removeClass("is-valid").addClass("is-invalid"),t.data("editor").instance.once("change",n);else if(dt(e))t.removeClass("is-valid").addClass("is-invalid").one("select2:open",n);else if(["checkbox","radio"].includes(e.type))t.removeClass("is-valid").addClass("is-invalid").one("click keydown",n);else{let e=ew.MOBILE_DETECT.version("Safari")&&!ew.MOBILE_DETECT.version("Chrome")?"change keydown paste":"click keydown paste";t.parent().one(e,n),t.add(t.closest(".input-group")).removeClass("is-valid").addClass("is-invalid")}},setValid:wt,hasValue:function(e){return""!=kt(e)},isMaskedPassword:function(e){var t=l.default(e).val();return null==t?void 0:t.match(/^\*+$/)},sort:function(e,t){let{sortUrl:a,sortType:n,context:i,ajax:l}=t;return e.shiftKey&&!e.ctrlKey?a=Ne(a,{cmd:"resetsort"}):2==n&&e.ctrlKey&&(a=Ne(a,{ctrl:"1"})),lt(l)?ma(fetch(De(a,!1)),i):window.location=Me(a),!1},filter:function(e){let t=e.currentTarget.dataset;l.default("select[data-select2-id='f"+t.table+"srch_"+t.field+"']").select2("open")},scrollIntoView:vt,inlineAction:async function(e){var t;let a=l.default(null==(t=e.evt)?void 0:t.currentTarget),n=a.closest(".ew-grid, .ew-multi-column-grid");if(a.tooltip("hide"),!n[0]&&a.is(".dropdown-item")){let e=l.default("#"+a.closest(".dropdown-menu").attr("aria-labelledby"));e[0]&&(a=e,n=a.closest(".ew-grid, .ew-multi-column-grid"))}if(!a[0])return;let i,{url:r,ewAction:o,action:s}=e,d=n.find("form"),u=d[0],c=a.closest("tr[data-rowindex], div[data-rowindex]"),f=c.data("key"),p=c.data("rowindex");if(!("add"==s||n[0]&&u))return;let h=function(e){!e.status||Qe("Server Error "+e.status+": "+e.statusText)},m=function(){document.body.style.cursor="default"},g=async function(e){if(!(e instanceof Response))return;let t=e.headers.get("Content-Type");if(null!=t&&t.includes("json")){let t=await e.json();null!=t&&t.success?(c.remove(),Qe(ew.language.phrase("DeleteSuccess"),"success")):Qe(Ue(t)||ew.language.phrase("DeleteFailed"))}else Je(await e.text())},w=()=>l.default(".ew-list-options, .ew-list-option-body").find("[data-ew-action='inline'][data-action='add'],[data-ew-action='inline'][data-action='copy'],[data-ew-action='inline'][data-action='edit']").addClass("disabled"),v=()=>l.default(".ew-list-options, .ew-list-option-body").find("[data-ew-action='inline'][data-action='add'],[data-ew-action='inline'][data-action='copy'],[data-ew-action='inline'][data-action='edit']").removeClass("disabled"),b=()=>n.find(".ew-grid-middle-panel .ew-table")[0],y=e=>{let t=0;Array.from(e.rows).forEach((e=>e.dataset.rowindex="0"===e.dataset.rowindex?"0":String(t++)))},_=async function(e){if(!(e instanceof Response))return;let t=await e.clone().text(),a=l.default("<div>"+t+"</div>"),r=a.find("tr[data-rowindex=0], div[data-rowindex=0]"+(f?", tr[data-key='"+f+"'], div[data-key='"+f+"']":"")).filter("[data-rowtype=2], [data-rowtype=3]"),o=r.data("inline"),d=r.data("rowtype"),p=o&&2==d?0:o&&3==d?1:r.data("rowindex"),h=r.add(a.find("script[data-rowindex="+p+"]"));if(["add","copy","edit"].includes(s)&&!h[0])return Qe(t);if(["add","copy"].includes(s)){if(document.querySelector("main.ew-no-record")&&a.find("main:not(.ew-no-record)")[0])await ma(Promise.resolve(e));else{if(r.is("TR")){let e=b();e.matches(".ew-infinite-scroll-table")?l.default(e.tBodies).last().append(h):l.default(e.tBodies).last().prepend(h),y(e),St(e,!0)}else n.find(".ew-multi-column-row").append(h);w()}ew.initPage(l.default.Event({type:"load.ew",target:n[0]})),_e.get(u.id).tryFocus(),vt(n.find("[data-rowtype=2]")[0])}else"edit"==s&&(i=c.replaceWith(h),n.data("detached",i),r.is("TR")&&St(b(),!0),w(),ew.initPage(l.default.Event({type:"load.ew",target:n[0]})),_e.get(u.id).tryFocus(),vt(n.find("[data-rowtype=3]")[0]))},E=async function(t){if(!(t instanceof Response))return;let a=t.headers.get("Content-Type");if(null!=a&&a.includes("json")){let e=Ue(await t.json());if(e)return void Qe(e)}if(t.headers.get("Infinite-Scroll")){let e,a=await t.text(),i=l.default("<div>"+a+"</div>"),r=i.find(".main");if(["insert","update"].includes(s)){if(e=i.find("tr[data-rowindex][data-rowtype="+ew.ROWTYPE_VIEW+"], div[data-rowindex][data-rowtype="+ew.ROWTYPE_VIEW+"]"),!e[0])return;"insert"==s?n.find("tr[data-rowtype="+ew.ROWTYPE_ADD+"], div[data-rowtype="+ew.ROWTYPE_ADD+"]").replaceWith(e[0]):"update"==s&&e.get().forEach((e=>n.find("tr[data-key='"+e.dataset.key+"'], div[data-key='"+e.dataset.key+"']").replaceWith(e)))}else["add","edit","multiedit"].includes(s)&&(e=i.find("tr[data-rowindex][data-rowtype="+ew.ROWTYPE_VIEW+"], div[data-rowindex][data-rowtype="+ew.ROWTYPE_VIEW+"]"),["edit","multiedit"].includes(s)?e.get().forEach((e=>n.find("tr[data-key='"+e.dataset.key+"'], div[data-rowtype='"+e.dataset.key+"']").replaceWith(e))):"add"==s&&n.find(".ew-grid-middle-panel .ew-table > tbody:last").append(e));let o=b();y(o),St(o,!0),oa({target:i}),ew.initPage(l.default.Event({type:"load.ew",target:r[0]}))}else await ma(Promise.resolve(t));let i=t.headers.get("Return-Url");i&&["inline","modal"].includes(e.ewAction)&&!Lt(xe(i).pathname,ye.pathname)&&n.find("[data-ew-action=modal][data-url='"+i+"'], [data-ew-action=inline][data-url='"+i+"']").trigger("click")};if("inline"==o)if("cancel"==s){var A;if("0"==p)c.remove();else null==(A=n.data("detached"))||A.replaceAll(c);v()}else if(u&&["insert","update"].includes(s)){let t=_e.get(u.id);if(await t.canSubmit(e.evt)){document.body.style.cursor="wait";let e=Ne(d.serialize(),{action:s}),a=qt(Ne(r,{rnd:sa()}),{method:"POST",body:e}).catch(h).finally((()=>{t.enableForm(),m()}));if(t.submitWithFetch){let e={form:u,result:a},n=l.default.Event("aftersubmit",{originalEvent:e.evt});t.trigger(n,[e])}else a.then(E).finally(v)}}else if("delete"==s){if(!f&&(c=n.find("input[type=checkbox][name='key_m[]']:checked").closest("tr[data-rowindex], div[data-rowindex]"),!c[0]))return Je(ew.language.phrase("NoRecordSelected")),!1;Xe(ew.language.phrase("DeleteConfirm"),(e=>{if(e){document.body.style.cursor="wait";let e=f?"GET":"POST",t=Fe(d.serialize(),"action"),a=_e.get(u.id),n=qt(Ne(r,{action:"delete",rnd:sa()}),{method:e,body:t}).catch(h).finally((()=>{a.enableForm(),m()}));if(a.submitWithFetch){let e={form:u,result:n},t=l.default.Event("aftersubmit",{originalEvent:e.evt});a.trigger(t,[e])}else n.then(g)}}))}else document.body.style.cursor="wait",qt(Ne(r,{rnd:sa()})).then(_).catch(h).finally(m);else if("grid"==o||"modal"==o){if(("grid"==o&&"edit"==s||"modal"==o&&["multiedit","update"].includes(s))&&!bt(u))return Je(ew.language.phrase("NoRecordSelected")),!1;ew.modalDialogShow({...e,callback:E})}return!1},confirmDelete:function(e){return At(e),Xe(ew.language.phrase("DeleteConfirm"),(t=>{t&&(e.dataset.json&&e.href?ew.modalDialogShow({url:Ne(e.href,{action:"delete"}),json:!0,callback:!0}):e.href?window.location=Me(Ne(e.href,{action:"delete"})):Et(e))})),!1},keySelected:bt,selectAllKeys:function(e){yt(e);let t=null==e?void 0:e.closest(".ew-table");t&&l.default(t.tBodies).each((function(){l.default(this.rows).each((function(){let t=l.default(this);t.is(":not(.ew-template):not(.ew-table-preview-row)")&&t.toggleClass("table-active ew-table-selected-row",e.checked).triggerHandler("change")}))}))},selectAll:yt,updateSelected:function(e){return!(null==e||!e.querySelector("input[type=checkbox][name^=u_]:checked,input[type=hidden][name^=u_][value='1']"))},clearSelected:_t,clearDelete:Et,clickDelete:At,selectKey:function(e){let t=e.target,a=null==t?void 0:t.closest(".ew-table");if(!a)return;_t(a);let n=l.default(t).closest(".ew-table > tbody > tr");n.siblings("[data-rowindex='"+n.data("rowindex")+"']").addBack().each((function(){l.default(this).toggleClass("table-active ew-table-selected-row",t.checked).triggerHandler("change")})),e.stopPropagation()},setupTable:St,setupGrid:Tt,addGridRow:function(e){var t;let a=null==e?void 0:e.closest(".ew-grid"),n=l.default(a).find("table.ew-table").last(),i=n.parent("div"),r=n.find("tr.ew-template");if(!(e&&a&&n[0]&&r[0]))return!1;let o=l.default(n[0].rows).last();n.find("td.ew-table-last-row").removeClass("ew-table-last-row");let s=r.clone(!0,!0).removeClass("ew-template"),d=a.querySelector("div.ew-form[id^=f][id$=grid]")||a.querySelector("form.ew-form[id^=f][id$=list]")||a.querySelector("form.ew-form[id^=f][id$=grid]"),u=l.default(d),c=u.is("div")?"_"+d.id:"",f=u.find("#"+ew.FORM_KEY_COUNT_NAME+c),p=parseInt(f.val(),10)+1,h=ew.FORM_ROW_ACTION_NAME.replace(/^k_/,"k"+p+"_")+c,m=r.find("script:contains('$rowindex$')").add("tr.ew-template + script[data-rowindex='$rowindex$']");s.attr({id:"r"+p+s.attr("id").substring(2),"data-rowindex":p}),s.children("td").each((function(){l.default(this).find("*").each((function(){l.default.each(this.attributes,(function(e,t){t.value=t.value.replace(/\$rowindex\$/g,p)}))}))}));let g=s.find(".ew-icon").closest("a, button");null==(t=bootstrap.Tooltip.getInstance(g[0]))||t.dispose(),g.tooltip({...ew.tooltipOptions,container:"body",trigger:"hover"}),f.val(p).after(l.default("<input>").attr({type:"hidden",id:h,name:h,value:"insert"})),o.after(s),m.get().forEach((e=>Yt(e.text.replace(/\$rowindex\$/g,p))));let w=u.data("form");return null==w||w.initEditors(),null==w||w.initUpload(),St(n[0],!0),i.scrollTop(i[0].scrollHeight),n.trigger("rowadded",[p]),!1},deleteGridRow:function(e,t){var a;null==(a=bootstrap.Tooltip.getInstance(e))||a.dispose();let n=e.closest(".ew-grid, .ew-multi-column-grid"),i=e.closest("tr, div[data-rowindex]"),r=null==i?void 0:i.closest(".ew-table"),o=parseInt(null==i?void 0:i.dataset.rowindex,10),s=(null==n?void 0:n.querySelector("div.ew-form[id^=f][id$=grid]"))||(null==n?void 0:n.querySelector("form.ew-form[id^=f][id$=list], form.ew-form[id^=f][id$=grid]")),d=l.default(s),u=d.data("form");if(!(e&&n&&i&&r&&s&&u))return!1;let c=d.is("div")?"_"+s.id:"",f="#"+ew.FORM_KEY_COUNT_NAME+c,p=function(){if(i.remove(),n.classList.contains(".ew-grid")&&St(r,!0),o>0){let e=d.find("#k"+o+"_action"+c);e[0]?e.val("insert"==e.val()?"insertdelete":"delete"):d.find(f).after(l.default("<input>").attr({type:"hidden",id:"k"+o+"_action"+c,name:"k"+o+"_action"+c,value:"delete"}))}l.default(r).trigger("rowdeleted",[o])};return ze(u.emptyRow)&&u.emptyRow(t)?p():Xe(ew.language.phrase("DeleteConfirm"),(e=>{e&&p()})),!1},htmlEncode:function(e){return String(e).replace(/&/g,"&amp;").replace(/\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},htmlDecode:Ot,getElements:It,getElement:xt,getAncestorBy:Ct,isHidden:Pt,sameText:Nt,sameString:function(e,t){return String(e)==String(t)},headerCase:Rt,samePath:Lt,getValue:function(e,t){let a=e;if(l.default.isString(e)?a=2==e.split(" ").length?It(e):It(e,t):["checkbox","radio"].includes(e.type)&&(a=It(e)),a)return a.options?a.list?"select-multiple"==a.type?a.values:a.value:l.default(a).val():Array.isArray(a)?a.length?l.default(a).filter(":checked").map(((e,t)=>t.value)).get():void 0:mt(a)?a.checked?a.value:void 0:ew.isHiddenTextArea(a)?(l.default(a).data("editor").save(),a.value):a.value},getOptionValues:Ft,getOptionValue:kt,getOptionTexts:Dt,clearOptions:Mt,getId:jt,valueSeparator:$t,displayValue:Ut,optionHtml:Bt,optionsHtml:function(e,t){return e.length>(t||ew.MAX_OPTION_COUNT)?ew.language.phrase("CountSelected").replace("%s",e.length):e.length?e.reduce(((e,t)=>e+Bt(t)),""):ew.language.phrase("PleaseSelect")},newOption:Vt,selectOption:Kt,fetch:qt,executeScript:Wt,stripScript:Gt,addScript:Yt,removeScript:zt,getContent:Jt,getOptions:Xt,enable2FA:function(){if(document.body.style.cursor="wait",Nt(ew.TWO_FACTOR_AUTHENTICATION_TYPE,"google")){let e=Ie([ew.API_2FA_ACTION,ew.API_2FA_SHOW]);l.default.get(e,(e=>{var t;null!=e&&e.url?Xe({imageUrl:e.url,html:ew.language.phrase("Scan2FAQrCode"),input:"text",confirmButtonText:ew.language.phrase("Verify"),showLoaderOnConfirm:!0,allowEscapeKey:!1,allowOutsideClick:()=>!Swal.isLoading(),willOpen:()=>{Swal.showLoading(Swal.getConfirmButton()),Swal.disableInput(),Swal.getImage().onload=()=>{Swal.enableInput(),Swal.hideLoading(),Swal.getInput().focus()}},preConfirm:e=>l.default.get(Ie([ew.API_2FA_ACTION,ew.API_2FA_VERIFY,e])).then((e=>(!0!==(null==e?void 0:e.success)&&Swal.showValidationMessage(ew.language.phrase("2FAVerificationFailed")),e))).catch((e=>Swal.showValidationMessage(e)))},(e=>{var t;null!=e&&null!=(t=e.error)&&t.description?Qe(e.error.description):null!=e&&e.success&&(Qe(ew.language.phrase("2FAEnabled"),"success"),l.default("#enable-2fa").addClass("d-none"),l.default("#disable-2fa, #backup-codes").removeClass("d-none"))})).catch((e=>Qe(null==e?void 0:e.message))):null!=e&&null!=(t=e.error)&&t.description&&Je(e.error.description)})).fail(((e,t,a)=>Qe(a))).always((()=>document.body.style.cursor="default"))}else{let e=Ie([ew.API_2FA_ACTION,ew.API_2FA_SHOW]),t=Nt(ew.TWO_FACTOR_AUTHENTICATION_TYPE,"email")?ew.language.phrase("EnterOTPEmailAddress"):ew.language.phrase("EnterOTPMobileNumber");l.default.get(e,(e=>{var a;e.success?Xe({html:t,input:"text",inputValue:e.account,confirmButtonText:ew.language.phrase("SendOTP"),showLoaderOnConfirm:!0,allowEscapeKey:!1,allowOutsideClick:()=>!Swal.isLoading(),preConfirm:e=>l.default.get(Ie([ew.API_2FA_ACTION,ew.API_2FA_SEND_OTP,e])).then((e=>(!0!==(null==e?void 0:e.success)&&Swal.showValidationMessage(ew.language.phrase("SendOTPFailed")),e))).catch((e=>Swal.showValidationMessage(e)))},(e=>{var t;null!=e&&null!=(t=e.error)&&t.description?Qe(e.error.description):null!=e&&e.success&&Xe({html:ew.language.phrase("EnterSecurityCode"),input:"text",confirmButtonText:ew.language.phrase("Verify"),showLoaderOnConfirm:!0,allowEscapeKey:!1,allowOutsideClick:()=>!Swal.isLoading(),preConfirm:e=>l.default.get(Ie([ew.API_2FA_ACTION,ew.API_2FA_VERIFY,e])).then((e=>(!0!==(null==e?void 0:e.success)&&Swal.showValidationMessage(ew.language.phrase("2FAVerificationFailed")),e))).catch((e=>Swal.showValidationMessage(e)))},(e=>{var t;null!=e&&null!=(t=e.error)&&t.description?Qe(e.error.description):null!=e&&e.success&&(Qe(ew.language.phrase("2FAEnabled"),"success"),l.default("#enable-2fa").addClass("d-none"),l.default("#disable-2fa, #backup-codes").removeClass("d-none"))})).catch((e=>Qe(null==e?void 0:e.message)))})).catch((e=>Qe(null==e?void 0:e.message))):null!=e&&null!=(a=e.error)&&a.description&&Je(e.error.description)})).fail(((e,t,a)=>Qe(a))).always((()=>document.body.style.cursor="default"))}return!1},disable2FA:function(){Xe({html:ew.language.phrase("Disable2FAConfirm"),preConfirm:e=>{if(e)return l.default.get(Ie([ew.API_2FA_ACTION,ew.API_2FA_RESET])).then((e=>{var t;return null!=e&&null!=(t=e.error)&&t.description?Qe(e.error.description):!0!==(null==e?void 0:e.success)&&Qe(ew.language.phrase("2FAResetFailed")),e})).fail(((e,t,a)=>Qe(a)))}},(e=>{var t;null!=e&&null!=(t=e.error)&&t.description?Qe(e.error.description):null!=e&&e.success&&(Qe(ew.language.phrase("2FADisabled"),"success"),l.default("#enable-2fa").removeClass("d-none"),l.default("#disable-2fa, #backup-codes").addClass("d-none"))})).catch((e=>Qe(null==e?void 0:e.message)))},sendOTP:function(e){Xe({html:ew.language.phrase("SendOTPConfirm"),preConfirm:t=>{let a=Ie(e?[ew.API_2FA_ACTION,ew.API_2FA_SEND_OTP,e]:[ew.API_2FA_ACTION,ew.API_2FA_SEND_OTP]);if(t)return l.default.get(a).then((e=>{var t;return null!=e&&null!=(t=e.error)&&t.description?Qe(e.error.description):!0!==(null==e?void 0:e.success)&&Qe(ew.language.phrase("SendOTPFailed")),e})).fail(((e,t,a)=>Qe(a)))}},(e=>{var t;null!=e&&null!=(t=e.error)&&t.description?Qe(e.error.description):null!=e&&e.success&&Qe(ew.language.phrase("SendOTPSuccess"),"success")})).catch((e=>Qe(null==e?void 0:e.message)))},showBackupCodes:function(){let e="<p>"+ew.language.phrase("BackupCodesMsg")+"</p>";return Je({title:ew.language.phrase("BackupCodes"),html:e,showDenyButton:!0,showLoaderOnDeny:!0,showCancelButton:!0,confirmButtonText:ew.language.phrase("CopyToClipboard"),denyButtonText:ew.language.phrase("GetNewCodes"),customClass:{denyButton:"btn btn-primary ew-swal2-deny-button"},willOpen:()=>{Swal.showLoading(),Swal.disableButtons(),l.default.get(Ie([ew.API_2FA_ACTION,ew.API_2FA_BACKUP_CODES])).then((t=>{t.success&&Array.isArray(t.codes)&&(Swal.update({html:e+'<textarea class="form-control ew-backup-codes" readonly>'+t.codes.join("\n")+"</textarea>"}),Swal.enableButtons(),Swal.getConfirmButton().focus())})).fail(((e,t,a)=>Qe(a))).always((()=>Swal.hideLoading()))},preConfirm:()=>(ia(Swal.getHtmlContainer().querySelector("textarea"))&&Qe(ew.language.phrase("CopiedToClipboard"),"success"),!1),preDeny:async()=>(Swal.showLoading(Swal.getDenyButton()),await l.default.get(Ie([ew.API_2FA_ACTION,ew.API_2FA_NEW_BACKUP_CODES])).then((t=>{t.success&&Array.isArray(t.codes)&&(Swal.update({html:e+'<textarea class="form-control ew-backup-codes" readonly>'+t.codes.join("\n")+"</textarea>"}),Swal.getConfirmButton().focus())})).fail(((e,t,a)=>Qe(a))).always((()=>Swal.hideLoading())),!1)})},addOptionDialogShow:function(e){var t;e.lnk=e.lnk||(null==(t=e.evt)?void 0:t.currentTarget);var a=ew.addOptionDialog||l.default("#ew-add-opt-dialog").on("hidden.bs.modal",(function(){zt(a.data("args").el);var e=a.removeData("args").find(".modal-body form").data("form");e&&e.destroyEditor(),a.find(".modal-body").html(""),a.find(".modal-footer .btn-primary").off(),a.data("showing",!1)}));if(a[0]){if(!a.data("showing")){a.data("showing",!0);var n=function(e){var t,n=e,i=a.data("args"),r=_e.get(i.lnk),o=a.find(".modal-body form input[name='"+ew.API_OBJECT_NAME+"']").val(),s=i.el,d=/^x(\d+)_/,u=s.match(d),c=u?u[0]:"x_",f=u?u[1]:-1,p=s.replace(d,"x_"),h=r.getList(s);if(l.default.isString(e)&&(n=We(e)),null!=(t=n)&&t.success&&n[o]){a.modal("hide");var m=n[o],g=r.$element[0],w=It(s,g);if(w){var v=h.linkField,b=h.displayFields.slice(),y=h.filterFields.slice(),_=h.parentFields.slice();_.forEach(((e,t)=>{1==e.split(" ").length&&(_[t]=_[t].replace(/^x_/,c))}));var E=""!=v?m[v]:"",A={lf:E};if(b.forEach(((e,t)=>{e in m&&(A["df"+(t>0?t+1:"")]=m[e])})),y.forEach(((e,t)=>{e in m&&(A["ff"+(t>0?t+1:"")]=m[e])})),E&&b.length>0&&A.df){null===h.ajax&&h.lookupOptions.push(A);var S=_.map((e=>Ft(e,g)));i={data:A,parents:S,valid:!0,name:jt(w),form:g};if(Ee.trigger("addoption",[i]),i.valid){var T=Xt(w),O=Vt(w,A,g);w.options&&(w.options[w.options.length-1].selected=!0,w.list&&l.default(w.target).find("input").last().trigger("focus"),ct(w)?(l.default(w).val(E).trigger("change"),l.default(w.input).val(O).trigger("focus")):l.default(w).trigger("change").trigger("focus"));var I=l.default(g),x=I.is("div")?"_"+g.id:"",C=I.find("#"+ew.FORM_KEY_COUNT_NAME+x).val();if(C>0)for(var P=1;P<=C;P++)if(P!=f){var N=It(p.replace(/^x/,"x"+P),g),R=Xt(N);JSON.stringify(T)==JSON.stringify(R)&&(Vt(N,A,g),null==N.render||N.render())}}}}}else{var L;if(null!=(L=n)&&L.error){let e=Ue(n);e&&Je(e)}else{var F,k,D=l.default("<div></div>").html(e).find("div.ew-message-dialog");if(D[0])F=D.html();else(F=(null==(k=n)?void 0:k.failureMessage)||e)&&""!=String(F).trim()||(F=ew.language.phrase("InsertFailed"));Je(F)}}},i=function(e){a.modal("hide"),Je("Server Error "+e.status+": "+e.statusText)},r=async function(e){let t=ew.addOptionDialog.find(".modal-body form")[0],a=_e.get(t.id),r=null==e?void 0:e.target,o=l.default(r);return await a.canSubmit(e)&&(o.prop("disabled",!1).removeClass("disabled"),document.body.style.cursor="wait",l.default.post(Ie([ew.API_ADD_ACTION,t.elements[ew.API_OBJECT_NAME].value]),l.default(t).serialize(),n).fail(i).always((function(){a.enableForm(),o.prop("disabled",!1).removeClass("disabled"),document.body.style.cursor="default"}))),!1};a.modal("hide"),a.data("args",e);return l.default.get(e.url,(function(t){var n=_e.get(e.lnk),i="x_",o=e.el.match(/^(x\d+_)/);o&&(i=o[1]);var s=n.getList(e.el),d=s.parentFields.slice().map((e=>1==e.split(" ").length?e.replace(/^x_/,i):e)),u=n.htmlForm,c=d.map((e=>Ft(e,u))),f=d.map((e=>Dt(e,u))),p=s.filterFieldVars.slice();a.find(".modal-title").html(l.default(e.lnk).closest(".ew-add-opt-btn").data("title")),a.find(".modal-body").html(Gt(t)),(u=a.find(".modal-body form")[0])&&l.default(u).on("keydown",(function(e){if("Enter"==e.key&&"TEXTAREA"!=e.target.nodeName)return r()})),ew.addOptionDialog=a.modal("show"),a.find(".modal-footer .btn-primary").click(r).focus(),u&&c.forEach(((e,t)=>{var a=It(p[t],u);a&&e[0]&&(ct(a)?(a.value=e[0],a.input.value=f[t][0],a.add(e[0],f[t][0],!0)):a.options||a.length?Vt(a,{lf:e[0]},n,!0):a.value=e[0])})),Wt(t,e.el,!0),a.trigger("load.ew")})).fail(i),!1}}else Je("DIV #ew-add-opt-dialog not found.")},modalDialogHide:Zt,modalDialogShow:function(e){var t,a,n,i,r,o,s,d;e.lnk||(e.lnk=null==(t=e.evt)?void 0:t.currentTarget),null==(a=bootstrap.Tooltip.getInstance(e.lnk))||a.hide();let{ewAction:u,action:c}=e,f=e.f||(null==(n=e.evt)||null==(i=n.currentTarget)?void 0:i.form);if(("grid"==u&&"edit"==c||"modal"==u&&["multiedit","update"].includes(c))&&!bt(f))return Je(ew.language.phrase("NoRecordSelected")),!1;let p=e.url||(null==(r=e.evt)||null==(o=r.currentTarget)?void 0:o.dataset.url),h=ew.modalDialog||l.default("#ew-modal-dialog").on("hidden.bs.modal",Zt);if(h.data("showing")&&p&&h.data("url")==p)return!1;h.data({showing:!0,url:p}),e.reload=!1,h.find(".modal-dialog").removeClass("modal-sm modal-md modal-lg modal-xl").addClass(e.size||"modal-xl");let m=function(){let e=h.data("args"),t=l.default(e.lnk);return e.caption||t.data("caption")||t.data("original-title")||""},g=function(e){h.modal("hide"),e.status&&Je("Server Error "+e.status+": "+e.statusText)},w=function(){document.body.style.cursor="default"},v=function(){h.data("showing")&&!h.hasClass("show")&&h.trigger("hidden.bs.modal")},b=function(t){let a=Ue(t);if(a)Je(a),v();else if(l.default.isString(t.warningMessage))Je(t.warningMessage,cb,"warning"),v();else if(l.default.isString(t.message))Je(t.message,cb,"body"),v();else if(l.default.isString(t.successMessage))Je(t.successMessage,cb,"success"),v();else if(t.reload)h.modal("hide"),window.location.reload();else if(l.default.isBoolean(t.success)&&ze(null==e?void 0:e.callback))h.modal("hide"),e.callback(t);else if(t.url){let e=t.url;if(t.modal)if(function(e){let t=document.createElement("a");return t.href=e,window.location.pathname.endsWith(t.pathname)}(e))t.error||(h.modal("hide"),ma(fetch(e)));else{let a=h.data("args");a.reload=!0,a.url=e,t.caption&&(a.caption=t.caption),a.btn=t.view?null:"",h.data({args:a,url:e}),e=Ne(e,{modal:"1",rnd:sa()}),document.body.style.cursor="wait",l.default.get(e).done(S).fail(g).always(w)}else h.modal("hide"),window.location=Me(e)}},y=function(){let e=h.find(".modal-footer").empty();if(!h.find(".card-body button[type=submit]").first().addClass("ew-submit").on("click",A)[0]){if(h.find(".modal-body .ew-modal-buttons").contents().clone().find("button").each((function(){if("submit"==this.type){this.type="button",this.classList.add("ew-submit"),"btn-cancel"==this.id&&this.classList.add("ew-cancel");let e=l.default(this);e.on("click",(function(t){"set-action"==this.dataset.ewAction&&(this.form.elements.action.value=this.dataset.value),!1===e.data("ajax")?l.default(this.form).trigger("submit"):A(t)}))}else"btn-cancel"==this.id&&(this.dataset.href?Lt(this.dataset.href,ye.pathname)?this.setAttribute("data-bs-dismiss","modal"):l.default(this).on("click",(()=>pa(this.dataset.href))):this.setAttribute("data-bs-dismiss","modal"));e[0].appendChild(this)})),!h.find(".card-body button[type=submit], .modal-footer .btn")[0]){let t=function(){let e=h.data("args");return null===e.btn?"":e.btn&&""!=e.btn?ew.language.phrase(e.btn):m()}();t?(l.default('<button type="button" class="btn btn-primary ew-btn">'+t+"</button>").on("click",A).appendTo(e),e.append('<button type="button" class="btn btn-default ew-btn" data-bs-dismiss="modal">'+ew.language.phrase("CancelBtn")+"</button>")):e.append('<button type="button" class="btn btn-default ew-btn" data-bs-dismiss="modal">'+ew.language.phrase("CloseBtn")+"</button>")}e.find("button").on("mousedown",(e=>e.preventDefault())),e.find(".btn-primary").focus()}},_=t=>{let a=t.headers.get("Return-Url");a&&e.table&&["inline","modal"].includes(e.ewAction)&&!Lt(xe(a).pathname,ye.pathname)&&l.default(".ew-grid."+e.table).find("[data-ew-action=modal][data-url='"+a+"'], [data-ew-action=inline][data-url='"+a+"']").trigger("click")},E=async function(e){let t=h.data("args");if(!(e instanceof Response))return;let a=e.headers.get("Content-Type");if(null!=a&&a.includes("json")){let a=await e.json();if(ze(null==t?void 0:t.callback)){let e=Ue(a);return e?Qe(e):h.modal("hide"),void t.callback(a)}b(a)}else{let a=await e.clone().text(),n=Jt(a).trim();if(n.startsWith("<")&&n.endsWith(">")){if(t.ajax&&"add"==t.action&&document.querySelector("main.ew-no-record")&&l.default(n).find("main:not(.ew-no-record)")[0])return h.modal("hide"),await ma(Promise.resolve(e)),void _(e);if(h.find(".modal-body").html(n),h.find(".modal-body .ew-infinite-scroll-grid .ew-grid-middle-panel").css("height","auto"),!h.find(".modal-body .ew-modal-buttons").length&&ze(null==t?void 0:t.callback))return h.modal("hide"),void t.callback(e);y(),Wt(a,"modal_dialog",!0),h.trigger("load.ew")}else a&&(h.modal("hide"),Je(a))}},A=async function(e){let t=h.find(".modal-body form")[0],a=l.default(t),n=_e.get(t.id),i=null==e?void 0:e.target;if(i.classList.contains("disabled"))return!1;if(i.classList.contains("ew-cancel"))l.default.post(a.attr("action"),a.serialize(),S).fail(g).always(w);else if(await n.canSubmit(e)){document.body.style.cursor="wait";let i=qt(a.attr("action"),{method:"POST",body:a.serialize()}).catch(g).finally((()=>{n.enableForm(),w()}));n.submitWithFetch?i.then((async a=>{var i;let r=a.clone(),o=null==(i=r.headers.get("Content-Type"))?void 0:i.includes("json"),s=o?await r.json():null,d=(null==s?void 0:s.validation)||Ue(s);o&&d||h.modal("hide");let u={form:t,result:Promise.resolve(a),context:d?"#ew-modal-dialog.show .modal-body":null},c=l.default.Event("aftersubmit",{originalEvent:e});n.trigger(c,[u])})):i.then(E)}return!1},S=function(e){let t=We(e);if(l.default.isObject(t))b(t);else{let t=h.data("args"),a=l.default(t.lnk),n=Jt(e);h.find(".modal-title").html(m()),h.find(".modal-body").html(n),h.find(".modal-body .ew-infinite-scroll-grid .ew-grid-middle-panel").css("height","auto"),y(),h.find(".modal-footer").toggle(!1!==t.footer);let i=a.data()||{};i.table&&h.find(".modal-dialog").addClass("table-"+i.table),h.find(".modal-body form").on("keydown",(e=>{if("Enter"==e.key&&"TEXTAREA"!=e.target.nodeName)return h.find(".modal-footer .btn.btn-primary").trigger("click"),!1})),i.ajax&&i.table&&"view"==i.action&&[".ew-add",".ew-copy",".ew-edit",".ew-delete"].forEach((e=>{let t=h.find(".modal-body "+e+"[data-ew-action=modal]"),a=l.default("[data-ew-action=modal][data-table='"+i.table+"'][data-url='"+t.data("url")+"']").not(".modal-body *").first();a[0]?t.on("click",(e=>{e.preventDefault(),e.stopImmediatePropagation(),a.trigger("click")})):t.addClass("d-none")})),ew.modalDialog=h.modal("show"),Wt(e,"modal_dialog",!0);let r=bootstrap.Modal.getInstance(h[0]);r._focustrap.__handleFocusin||(r._focustrap.__handleFocusin=r._focustrap._handleFocusin,r._focustrap._handleFocusin=function(e){var t;null!=(t=e.target)&&t.matches("[class^=cke_dialog_]")||this.__handleFocusin(e)}),h.trigger("load.ew")}};if(!0===e.callback&&null!=(s=h.data("args"))&&s.callback&&(e.callback=h.data("args").callback),p&&null!=(d=h.data("args"))&&d.reload&&(e.reload=!0,h.data("args").reload=!1),h.modal("hide"),h.data("args",e),p){document.body.style.cursor="wait";let t=ew.getSearchParams(p);t.set("rnd",sa()),"delete"!=t.get("action")&&t.set("modal","1"),l.default.ajax({url:Ne(p,t),method:f?"POST":"GET",data:f?l.default(f).serialize():"",headers:e.json?{Accept:"application/json, */*; q=0.01"}:{}}).done(S).fail(g).always(w)}else e.html&&function(e){let t=h.data("args");h.find(".modal-title").html(m()),h.find(".modal-body").html(e),y(),h.find(".modal-footer").toggle(!1!==t.footer),ew.modalDialog=h.modal("show")}(e.html);return!1},importDialogShow:function(e){var t,a;e.lnk=e.lnk||(null==(t=e.evt)?void 0:t.currentTarget),null==(a=bootstrap.Tooltip.getInstance(e.lnk))||a.hide();let n=ew.importDialog||l.default("#ew-import-dialog");if(!n[0])return Je("DIV #ew-import-dialog not found."),!1;let i,r,o=n.find("#importfiles"),s=o.closest(".ew-file-drop-zone"),d=n.find(".modal-body"),u=d.find(":input[id!=importfiles]"),c=d.find(".message"),f=d.find(".progress"),p=function(e,t){let a=l.default("<div>"+e+"</div>");var i;t&&a.addClass(t),c.removeClass("d-none").html(a),"text-danger"==t&&(i=!0,n.find(".modal-footer .btn").prop("disabled",!i))},h=()=>c.addClass("d-none").html(""),m=(e,t)=>f.removeClass("d-none").find(".progress-bar").removeClass("bg-success bg-info").addClass(t||"bg-success").attr("aria-valuenow",e).css("width",e+"%").html(e+"%"),g=function(e){const t=We(e.data)||{};try{let e=t.totalCount||0,a=t.count||0,r=t.successCount||0,o=t.failCount||0,s=t.file;if(e>0&&n.find(".modal-footer .ew-close-btn").data("import-progress")){t.row&&function(e){let{row:t,success:a,error:n,count:r}=e,o=()=>{i.addRow(t).then((e=>e.getElement().classList.toggle("text-danger",n))),n&&console.log(ew.language.phrase("ImportRowError").replace("%i",r+" "+JSON.stringify(t)).replace("%e",n))};t={_index:r,_success:a,_error:n,...t},i?i.initialized?o():i.on("tableBuilt",o):(i=new Tabulator("#ew-import-dialog .result",l.default.extend({data:[t],index:"_index",autoColumns:!0,autoColumnsDefinitions:e=>(e.forEach((e=>{e.headerSort=!1,e.resizable=!1,["_index","_error"].includes(e.field)?e.visible=!1:"_success"==e.field&&(e.title="#",e.headerSort=!0,e.headerSortTristate=!0,e.formatter=e=>{e.getElement().style.textOverflow="clip";let t=e.getRow(),a=t.getData();return a._error&&new bootstrap.Tooltip(t.getElement(),{placement:"bottom",title:a._error,container:"#ew-import-dialog .result"}),(a._success?'<i class="fa-solid fa-check text-success"></i>':'<i class="fa-solid fa-xmark text-danger"></i>')+" #"+a._index})})),e)},ew.importTabulatorOptions)),i.on("tableBuilt",(()=>i.element.querySelector(".tabulator-row").classList.toggle("text-danger",n))))}(t);let n=parseInt(100*a/e,10);m(n),p(ew.language.phrase("ImportResult").replace("%t",e).replace("%c",a).replace("%f",s).replace("%s",r).replace("%e",o),o>0?"text-danger":"text-primary")}}catch(e){}},w=function(e){var t;let a=[],i=We(e.data)||{},l=i.files;m(100),n.find(".modal-footer .ew-close-btn").data("import-progress",!1),Array.isArray(l)&&l.forEach((e=>{let t=e.totalCount||0,n=e.count||0,i=e.successCount||0,l=e.failCount||0;a.push(ew.language.phrase("ImportResult").replace("%t",t).replace("%c",n).replace("%f",e.file).replace("%s",i).replace("%e",l))})),i.success?(i.rollbacked&&a.push(ew.language.phrase("ImportSave")),p(a.join("<br>"),"text-success"),n.find(".modal-footer .ew-close-btn").data("imported",!0)):(ew.IMPORT_MAX_FAILURES>0&&i.failCount>=ew.IMPORT_MAX_FAILURES&&a.push(ew.language.phrase("ImportMaxFailuresExceeded").replace("%s",ew.IMPORT_MAX_FAILURES)),p(a.join("<br>"),"text-danger")),document.body.style.cursor="default",n.find(".modal-footer .ew-close-btn").prop("disabled",!1);let o=n.find(".modal-footer .ew-import-btn").toggleClass("d-none",!i.rollbacked||!i.success);i.rollbacked&&o.off("click").one("click",b),console.log("Closing EventSource..."),null==(t=r)||t.close()},v=function(e){var t;document.body.style.cursor="default",n.find(".modal-footer .ew-close-btn").data("import-progress",!1);let a=We(e.data)||{};a.error&&p(a.error,"text-danger"),console.log("Closing EventSource..."),null==(t=r)||t.close()},b=function(e){var t;document.body.style.cursor="wait",m(0),null==(t=i)||t.clearData(),n.find(".modal-footer .ew-close-btn").data("import-progress",!0);let a=new URLSearchParams(u.serialize());a.set(ew.API_ACTION_NAME,ew.API_IMPORT_ACTION),a.set(ew.API_FILE_TOKEN_NAME,o.data(ew.API_FILE_TOKEN_NAME)),a.set("rollback","0"),r=new EventSource(na()+"?"+a.toString()),r.addEventListener("message",g),r.addEventListener("error",v),r.addEventListener("complete",w)},y=ew.importUploadOptions;return y.acceptFileTypes||(y.acceptFileTypes=new RegExp("\\.("+ew.IMPORT_FILE_ALLOWED_EXTENSIONS.replace(/,/g,"|")+")$","i")),o.data("blueimpFileupload")||o.fileupload(Object.assign({url:Ie(ew.API_UPLOAD_ACTION),dataType:"json",autoUpload:!0,singleFileUploads:!1,dropZone:s,messages:{acceptFileTypes:ew.language.phrase("UploadErrorAcceptFileTypes"),maxFileSize:ew.language.phrase("UploadErrorMaxFileSize"),maxNumberOfFiles:ew.language.phrase("UploadErrorMaxNumberOfFiles"),minFileSize:ew.language.phrase("UploadErrorMinFileSize")},beforeSend:function(e,t){t.data.set("session",ew.SESSION_ID),t.data.set(ew.TOKEN_NAME_KEY,ew.TOKEN_NAME),t.data.set(ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN),ew.API_JWT_TOKEN&&!ew.IS_WINDOWS_AUTHENTICATION&&e.setRequestHeader(ew.API_JWT_AUTHORIZATION_HEADER,"Bearer "+ew.API_JWT_TOKEN)},done:function(e,t){var a,l;if(Array.isArray(null==t||null==(a=t.result)||null==(l=a.files)?void 0:l.importfiles)){let e=!0;t.result.files.importfiles.forEach((function(t,a){t.error&&(p(ew.language.phrase("ImportUploadError").replace("%f",t.name).replace("%s",t.error),"text-danger"),e=!1)})),e&&function(e){var t;document.body.style.cursor="wait",m(0),null==(t=i)||t.clearData(),o.data(ew.API_FILE_TOKEN_NAME,e),n.find(".modal-footer .ew-close-btn").data("import-progress",!0);let a=new URLSearchParams(u.serialize());a.set(ew.API_ACTION_NAME,ew.API_IMPORT_ACTION),a.set(ew.API_FILE_TOKEN_NAME,e),a.set("rollback","1"),r=new EventSource(na()+"?"+a.toString()),r.addEventListener("message",g),r.addEventListener("error",v),r.addEventListener("complete",w)}(t.result[ew.API_FILE_TOKEN_NAME])}},change:function(e,t){h()},processfail:function(e,t){t.files.forEach((function(e,t){e.error&&p(ew.language.phrase("ImportUploadError").replace("%f",e.name).replace("%s",e.error),"text-danger")}))},fail:function(e,t){p(ew.language.phrase("ImportServerError").replace("%s",t.textStatus).replace("%t",t.errorThrown),"text-danger")},progressall:function(e,t){!function(e){const t=parseInt(100*e.loaded/e.total,10);m(t,"bg-primary"),p(100===t?ew.language.phrase("ImportUploadComplete"):ew.language.phrase("ImportUploadProgress").replace("%p",t),"text-primary")}(t)}},y)),n.modal("hide").find(".modal-title").html(e.hdr),n.find(".modal-footer .ew-close-btn").off("click.ew").on("click.ew",(function(){let e=l.default(this);e.data("imported")&&(e.data("imported",!1),window.location.reload())})),h(),ew.importDialog=n.on("show.bs.modal",(function(){var e,t,a;f.addClass("d-none").find(".progress-bar").attr("aria-valuenow",0).css("width","0%").html("0%"),null==(e=this.querySelector(".modal-footer .ew-import-btn"))||e.classList.add("d-none"),null==(t=i)||t.element.removeAttribute("style"),null==(a=i)||a.destroy(),i=null})).modal("show"),!1},autoFill:Qt,tooltip:ea,initSearchFilters:ta,emailDialogShow:function(e){let t=ew.emailDialog||l.default("#ew-email-dialog").on("shown.bs.modal",(e=>setTimeout((()=>{var t;return null==(t=e.target.querySelector(".modal-body .form-control"))?void 0:t.focus()}),200))).on("click",".modal-footer .btn-primary",(function(e){var a;e.preventDefault(),null!=(a=l.default(this).closest(".modal").find(".modal-body form").data("form"))&&a.submit()&&t.modal("hide")}));if(!t[0])return Je("DIV #ew-email-dialog not found."),!1;let a=e.evt.currentTarget.form;if(e.exportSelected&&!bt(a))return Je(ew.language.phrase("NoRecordSelected")),!1;let n=t.find(".modal-body form"),i=n.data("form");return i||(i=(new E).setId(n.attr("id")).addFields([["sender",[ew.Validators.required(ew.language.phrase("Sender")),ew.Validators.email]],["recipient",[ew.Validators.required(ew.language.phrase("Recipient")),ew.Validators.emails(ew.MAX_EMAIL_RECIPIENT,ew.language.phrase("EnterProperRecipientEmail"))]],["cc",ew.Validators.emails(ew.MAX_EMAIL_RECIPIENT,ew.language.phrase("EnterProperCcEmail"))],["bcc",ew.Validators.emails(ew.MAX_EMAIL_RECIPIENT,ew.language.phrase("EnterProperBccEmail"))],["subject",ew.Validators.required(ew.language.phrase("Subject"))]]).setValidate((function(){return this.validateFields()})).setSubmit((function(){if(!this.validate())return!1;let i=Re(n.serialize(),e.key,rt(),a&&e.exportSelected?l.default(a).find("input[type=checkbox][name='key_m[]']:checked").serialize():null);return t.modal("hide"),e.custom?ot({...e,export:"email",custom:!0,emailForm:n[0]}):aa(n.find("#tblvar").val(),i),!1})).build(),n.data("form",i)),ew.emailDialog=t.modal("hide").find(".modal-title").html(e.hdr).end().modal("show"),!1},exportEmail:aa,showDrillDown:function(e,t,a,n,i){if(null!=e&&e.ctrlKey){return pa(Ne(a,{d:"2"}))}var r=l.default(t),o=r.data("drilldown-placement")||"auto",s={obj:r[0],placement:o,id:n,url:a,hdr:i};Ee.trigger("drilldown",[s]);var d=s.url.split("?");s.file=d[0]||"",s.data=d[1]||"",bootstrap.Popover.getInstance(t)||r.popover({...ew.popoverOptions,placement:s.placement,trigger:"manual",title:s.hdr,template:'<div class="popover" role="tooltip"><h3 class="popover-header d-none" style="cursor: move;"></h3><div class="popover-body"></div></div>',content:ew.spinnerTemplate(),container:l.default("#ew-drilldown-panel").draggable(ew.draggableOptions),boundary:"viewport"}).on("show.bs.popover",(function(e){r.attr("data-original-title","")})).on("shown.bs.popover",(function(e){if(r.data("args")){var a=r.data("args").data;l.default.ajax({cache:!1,dataType:"html",type:"POST",data:a,url:r.data("args").file,success:function(e){var a=l.default(bootstrap.Popover.getInstance(t)._getTipElement());s.hdr&&a.find(".popover-header").empty().removeClass("d-none").append('<button type="button" class="btn-close" aria-label="'+ew.language.phrase("CloseBtn")+'"></button>'+s.hdr).find(".btn-close").on("click",(function(){r.popover("hide")}));var i=e.match(/<body[^>]*>([\s\S]*?)<\/body\s*>/i);e=i?i[0]:e;var o=ew.stripScript(e);a.find(".popover-body").html(l.default("<div></div>").html(o).find("#ew-report")).find(".ew-table").each(ew.setupTable),ew.executeScript(e,n,!0),r.popover("update")},error:function(e){if(e.responseText){let r=bootstrap.Popover.getInstance(t);if(l.default.isString(e.responseText)&&e.responseText.startsWith("{")&&e.responseText.endsWith("}")){var a,n,i=We(e.responseText);if(null!=i&&null!=(a=i.error)&&a.type&&null!=i&&null!=(n=i.error)&&n.description)return null==r||r.hide(),Je({title:i.error.type,html:i.error.description,customClass:{title:"ew-swal2-title text-danger",htmlContainer:"ew-swal2-html-container text-danger"}})}null==r||r.setContent({".popover-body":'<p class="text-danger">'+e.responseText+"</p>"})}}})}})).on("hidden.bs.popover",(function(e){ew.removeScript(n)})),r.data("args",s).popover("show")},ajax:function(e,t){if(l.default.isObject(e)&&(e.url||e.action)){var a;e.url?e.url.startsWith(Ie())?a=e.url.replace(Ie(),"").split("/")[0]:e.url.startsWith(ew.API_URL)&&(a=e.url.replace(ew.API_URL,"").split("/")[0]):(a=e.action,delete e.action);var n=Object.assign({},e),i=e=>{if(l.default.isObject(e)&&"OK"==e.result){var t=e.records;return Array.isArray(t)&&1==t.length?(t=t[0],Array.isArray(t)&&1==t.length?t[0]:t):t}return e},r=n.url||Ie(a),o=n.type||([ew.API_LIST_ACTION,ew.API_VIEW_ACTION,ew.API_DELETE_ACTION].includes(a)?"GET":"POST");if(delete n.url,delete n.type,n.dataType="json",!ze(t)){var s=l.default.ajax({url:r,async:!1,type:o,data:n});return i(s.responseJSON)}l.default.ajax({url:r,type:o,data:n,success:function(e){t(i(e))}})}},currentPage:na,toggleSearchOperator:function(e,t,a){var n=e.currentTarget.form.elements[t];n&&(n.value=n.value!=a?a:"=")},toggleLayout:function(e){var t;null==(t=bootstrap.Tooltip.getInstance(e))||t.hide(),document.body.style.cursor="wait",fetch(Me(De(e.dataset.url,e.dataset.layout))).then((e=>e.text())).then((e=>{let t=l.default(".ew-multi-column-grid").html(l.default("<div>"+e+"</div>").find(".ew-multi-column-grid").html());ew.initPage({target:t[0]}),t.trigger("load.ew")})).catch((e=>Je(e))).finally((()=>document.body.style.cursor="default"))},copyToClipboard:ia,checkInteger:function(e){return!e||0==e.length||!e.includes(ew.DECIMAL_SEPARATOR)&&la(e)},checkNumber:la,escapeRegExChars:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},checkRange:function(e,t,a){return!e||0==e.length||((l.default.isNumber(t)||l.default.isNumber(a))&&la(e)&&(e=ew.parseNumber(e)),!(null!==t&&e<t)&&!(null!==a&&e>a))},checkPhone:function(e){return!e||0==e.length||/^\(\d{3}\) ?\d{3}( |-)?\d{4}|^\d{3}( |-)?\d{3}( |-)?\d{4}$/.test(e.trim())},checkZip:function(e){return!e||0==e.length||/^\d{5}$|^\d{5}-\d{4}$/.test(e.trim())},checkCreditCard:function(e){if(!e||0==e.length)return!0;var t=e.replace(/\D/g,"");if(0==t.length)return!1;for(var a,n=t.length%2!=1,i=0,l=0,r=t.length;l<r;l++)a=parseInt(t.charAt(l),10),n?(i+=(a*=2)%10,a/10>=1&&i++,n=!1):(i+=a,n=!0);return i%10==0},checkSsn:function(e){return!e||0==e.length||/^(?!000)([0-6]\d{2}|7([0-6]\d|7[012]))([ -]?)(?!00)\d\d\3(?!0000)\d{4}$/.test(e.trim())},checkEmails:function(e,t){if(!e||0==e.length)return!0;for(var a=e.replace(/,/g,";").split(";"),n=0,i=a.length;n<i;n++){if(t>0&&i>t)return!1;if(!ra(a[n]))return!1}return!0},checkEmail:ra,checkGuid:function(e){return!e||0==e.length||/^(\{\w{8}-\w{4}-\w{4}-\w{4}-\w{12}\}|\w{8}-\w{4}-\w{4}-\w{4}-\w{12})$/.test(e.trim())},checkUrl:function(e){if(!e||0==e.length)return!0;try{new URL(e)}catch(e){return!1}return!0},checkByRegEx:function(e,t){return!e||0==e.length||!!e.match(t)},showMessage:oa,random:sa,upload:function(e){let t=l.default(e);if(t.data("blueimpFileupload"))return;let a=t.attr("name"),n=a.replace(/\$/g,"\\$"),i=t.data("table"),r=t.is("[multiple]"),o=t.closest(".ew-file-drop-zone"),s=t.closest(Se),d=s.find("#ft_"+n),u=s.find("#fn_"+n),c=s.find("#fa_"+n),f=s.find(".ew-file-label"),p=f.html(),h=function(e){!r&&u.val()&&(confirm(ew.language.phrase("UploadOverwrite"))||(e.preventDefault(),e.stopPropagation()))},m=Ie(ew.API_JQUERY_UPLOAD_ACTION),g=l.default.templates("#template-download"),w=l.default.templates("#template-upload"),v=et(e),b="confirm"==l.default(v).find("#confirm").val()||t.attr("readonly")||t.prop("disabled");b&&!t.prop("disabled")&&t.prop("disabled",!0);const{acceptFileTypes:y,maxFileSize:_,maxNumberOfFiles:E}=t.data(),A={id:a,table:i,session:ew.SESSION_ID,replace:r?"0":"1",acceptFileTypes:y,maxFileSize:_,maxNumberOfFiles:E};t.fileupload(ew.deepAssign({url:m,type:"POST",multipart:!0,autoUpload:!0,loadImageFileTypes:/^image\/(gif|jpe?g|png)$/i,loadVideoFileTypes:/^video\/mp4$/i,loadAudioFileTypes:/^audio\/(mpeg|mp3)$/i,filesContainer:d,uploadTemplateId:null,downloadTemplateId:null,uploadTemplate:w.render.bind(w),downloadTemplate:g.render.bind(g),previewMaxWidth:ew.UPLOAD_THUMBNAIL_WIDTH,previewMaxHeight:ew.UPLOAD_THUMBNAIL_HEIGHT,dropZone:o,messages:{acceptFileTypes:ew.language.phrase("UploadErrorAcceptFileTypes"),maxNumberOfFiles:ew.language.phrase("UploadErrorMaxNumberOfFiles"),maxFileSize:ew.language.phrase("UploadErrorMaxFileSize"),minFileSize:ew.language.phrase("UploadErrorMinFileSize")},formData:A,readonly:b},ew.uploadOptions)).on("fileuploaddone",(function(e,t){if(t.result.files[0].error)return;let a=t.result.files[0].name,n=r&&u.val()?u.val().split(ew.MULTIPLE_UPLOAD_SEPARATOR):[];n.push(a),u.val(n.join(ew.MULTIPLE_UPLOAD_SEPARATOR)),c.val("0"),r||d.find("tbody > tr:not(:last-child)").remove()})).on("fileuploaddestroy",(function(e,t){let a=Pe(e.originalEvent.target.dataset.url),n=a.get("id"),i=a.get(n);if(i){let e=u.val()?u.val().split(ew.MULTIPLE_UPLOAD_SEPARATOR):[],t=e.indexOf(i);t>-1&&e.splice(t,1),u.val(e.join(ew.MULTIPLE_UPLOAD_SEPARATOR)),c.val("0")}})).on("fileuploadchange",(function(e,a){var n;d.toggleClass("ew-has-rows",(null==(n=a.files)?void 0:n.length)>0);let i=u.val()?u.val().split(ew.MULTIPLE_UPLOAD_SEPARATOR):[];a.files.forEach((e=>i.push(e.name)));let r=t.data("maxNumberOfFiles");if(l.default.isNumber(r)&&r>0&&i.length>r)return Je(ew.language.phrase("UploadErrorMaxNumberOfFiles")),!1;let o=t.data("size");return l.default.isNumber(o)&&o>0&&i.join(ew.MULTIPLE_UPLOAD_SEPARATOR).length>o?(Je(ew.language.phrase("UploadErrorMaxFileLength")),!1):void 0})).on("fileuploadadded fileuploadfinished fileuploaddestroyed",(function(e,t){var a,n,i;d.toggleClass("ew-has-rows",(null==(a=t.files)?void 0:a.length)>0||(null==(n=t.result)||null==(i=n.files)?void 0:i.length)>0);let l=u.val()?u.val().split(ew.MULTIPLE_UPLOAD_SEPARATOR):[];f.html(l.join(", ")||p)})).on("fileuploadadded",(function(e,t){var a;d.toggleClass("ew-has-rows",(null==(a=t.files)?void 0:a.length)>0),t.context.find(".start").click(h)})).on("fileuploadcompleted",(function(e,t){let a={target:t.context};Ke(a),qe(a),ew.updateDropdownPosition(),t.context.find("img").on("load",ew.updateDropdownPosition)})),u.val()&&l.default.ajax({url:m,data:{id:a,table:i,session:ew.SESSION_ID},dataType:"json",context:this,success:function(n){if(null!=n&&n[a]){let i=t.fileupload("option","done");i&&i.call(e,l.default.Event(),{result:{files:n[a]}})}b&&d.find("td.delete").hide()}})},parseNumber:function(e){let t=ew.getLocaleFromPlatform(ew.LANGUAGE_ID);return"latn"==ew.NUMBERING_SYSTEM&&(t.numeralSystem=void 0),t.delimiters.thousands!==ew.GROUPING_SEPARATOR&&(t.delimiters.thousands=ew.GROUPING_SEPARATOR),t.delimiters.decimal!==ew.DECIMAL_SEPARATOR&&(t.delimiters.decimal=ew.DECIMAL_SEPARATOR),ew.parse(e,{locale:t})},getNumberingSystem:function(){return ew.NUMBERING_SYSTEM||new Intl.NumberFormat(ew.LANGUAGE_ID).resolvedOptions().numberingSystem},formatDateTime:ca,formatTimeSpan:function(e,t,a){let n=da.fromJSDate(e,{zone:"utc"}),i=da.fromJSDate(t,{zone:"utc"});i.isValid&&i.equals(i.startOf("day"))&&(i=i.minus(1));let l=new ua({start:n,end:i});if(l.isValid){let e=l.count()/864e5;a||(a=Number.isInteger(e)&&e>=1)}return a?l.isValid&&l.count("days")>1||n.isValid&&i.isValid&&n.startOf("day")<i.startOf("day")?ca(n,ew.DATE_FORMAT)+" - "+ca(i,ew.DATE_FORMAT):n.isValid&&!t?ca(n,ew.DATE_FORMAT):"":n.isValid&&i.isValid?n.startOf("day")<i.startOf("day")?ca(n,ew.DATE_FORMAT+" "+ew.TIME_FORMAT)+" - "+ca(i,ew.DATE_FORMAT+" "+ew.TIME_FORMAT):ca(n,ew.TIME_FORMAT)+" - "+ca(i,ew.TIME_FORMAT):n.isValid?ca(n,ew.TIME_FORMAT):""},parseDateTime:fa,parseDate:fa,parseTime:fa,checkDate:function(e,t){return!e||0==e.length||fa(e,t).isValid},checkTime:function(e,t){return!e||0==e.length||fa(e,t).isValid},formatCurrency:function(e,t){if(t||(t=ew.CURRENCY_FORMAT),t.includes(";")){let a=t.split(";");t=e>=0?a[0]:a[1]}t=t.replace("","$");let a=ew.getLocaleFromPlatform(ew.LANGUAGE_ID);return"latn"==ew.NUMBERING_SYSTEM&&(a.numeralSystem=void 0),a.delimiters.thousands!==ew.GROUPING_SEPARATOR&&(a.delimiters.thousands=ew.GROUPING_SEPARATOR),a.delimiters.decimal!==ew.DECIMAL_SEPARATOR&&(a.delimiters.decimal=ew.DECIMAL_SEPARATOR),ew.format(e,t,{locale:a,currency:(ew.IS_RTL?"":"")+ew.CURRENCY_SYMBOL})},formatNumber:function(e,t){let a=ew.getLocaleFromPlatform(ew.LANGUAGE_ID);return"latn"==ew.NUMBERING_SYSTEM&&(a.numeralSystem=void 0),a.delimiters.thousands!==ew.GROUPING_SEPARATOR&&(a.delimiters.thousands=ew.GROUPING_SEPARATOR),a.delimiters.decimal!==ew.DECIMAL_SEPARATOR&&(a.delimiters.decimal=ew.DECIMAL_SEPARATOR),ew.format(e,t||ew.NUMBER_FORMAT,{locale:a})},formatPercent:function(e,t){let a=ew.getLocaleFromPlatform(ew.LANGUAGE_ID);return"latn"==ew.NUMBERING_SYSTEM&&(a.numeralSystem=void 0),a.delimiters.thousands!==ew.GROUPING_SEPARATOR&&(a.delimiters.thousands=ew.GROUPING_SEPARATOR),a.delimiters.decimal!==ew.DECIMAL_SEPARATOR&&(a.delimiters.decimal=ew.DECIMAL_SEPARATOR),ew.format(e,t||ew.PERCENT_FORMAT,{locale:a})},initPage:function(e){var t,a=null!=(t=null==e?void 0:e.target)?t:document,n=l.default(a),i=n.find("table.ew-table:not(.ew-export-table)");ew.initPanels(a),ew.renderJsTemplates(e),Ve(e),Ye(e),He(e),Oe(e),Te(e),ta(e),Ke(e),qe(e),i.each(St),n.find(".ew-column-dropdown").each((function(){var e;let t=this.dataset.table;null==(e=localStorage.getItem(ew.PROJECT_NAME+"_"+t+"_invisible_fields"))||e.split(",").forEach((e=>l.default("#tbl_"+t+"list").find("th[data-name='"+e+"'],td[data-name='"+e+"']").toggleClass("d-none",!0))),l.default(this).find(".ew-dropdown-checkbox").on("click",(function(e){let a=this.querySelector(".ew-dropdown-check-input[data-field]"),n=null==a?void 0:a.dataset.field;t&&n&&(a.classList.toggle("ew-checked"),l.default("#tbl_"+t+"list").find("th[data-name='"+n+"'],td[data-name='"+n+"']").toggleClass("d-none",!a.classList.contains("ew-checked"))),localStorage.setItem(ew.PROJECT_NAME+"_"+t+"_invisible_fields",Array.from(e.currentTarget.closest(".dropdown-menu").querySelectorAll(".ew-dropdown-check-input[data-field]:not(.ew-checked)"),(e=>e.dataset.field)))}))})).on("show.bs.dropdown",(function(e){let t=e.currentTarget.dataset.table,a=e.currentTarget.querySelectorAll(".ew-dropdown-check-input[data-field]");for(let e of a){let a=e.dataset.field;e.classList.toggle("ew-checked",!!l.default("#tbl_"+t+"list").find("th[data-name='"+a+"']:not(.d-none)")[0])}})),je(e),$e(e);var r=n.find(".ew-report");r[0]&&(r.find(".card").on("collapsed.lte.widget",(function(){var e=l.default(this).closest("[class^='col-']"),t=e.css("min-height");t&&e.data("min-height",t),e.css("min-height",0)})).on("expanded.lte.widget",(function(){var e=l.default(this).closest("[class^='col-']"),t=e.css("min-height");t&&e.css("min-height",t)})),r.find(".ew-group-toggle").on("click",(function(){ew.toggleGroup(this)}))),"undefined"!=typeof ew.USE_JAVASCRIPT_MESSAGE&&ew.USE_JAVASCRIPT_MESSAGE&&oa(e)},redirect:pa,togglePassword:function(e){let t=l.default(e.currentTarget),a=t.closest(".input-group").find("input"),n=t.find("i");"text"==a.attr("type")?(a.attr("type","password"),n.toggleClass("fa-eye-slash fa-eye")):"password"==a.attr("type")&&(a.attr("type","text"),n.toggleClass("fa-eye-slash fa-eye"))},updateChart:function(e){let t=new URL(e.form.action),a=l.default(e).closest(".ew-chart-top, .ew-chart-bottom"),n=l.default(ew.overlayTemplate());t.search=l.default(e.form).serialize(),a.addClass("ew-loading").append(n),fetch(t.toString()).then((async e=>{let t=l.default("<div>"+await e.text()+"</div>"),n=t.find(".ew-chart-top, .ew-chart-bottom").filter("[data-chart='"+a.data("chart")+"']"),i=t.find(".ew-debug");n[0]&&a.replaceWith(n),i[0]&&n.next(".ew-debug").replaceWith(i)})).finally((()=>a.removeClass("ew-loading").find(n).remove()))},isMediumScreen:ha,isMobile:function(){return ew.IS_MOBILE||!ha()},refresh:ma,isDark:function(){return document.body.classList.contains("dark-mode")},fixLayoutHeight:function(){ga&&ga.cancel(),ga=l.default.later(50,null,(function(){var e=Ae.data("lte.layout");e&&e.fixLayoutHeight()}))},addEventHandlers:function(e){let t=ew.events[e];if(t)for(const[a,n]of Object.entries(t))l.default("[data-table="+e+"][data-field="+a+"]").on(n)}};var va={__proto__:null,fullCalendar:function(e,t,a){let n,{updateTable:i,eventFields:r,addUrl:o,viewUrl:s,editUrl:d,deleteUrl:u,copyUrl:c,fullCalendarOptions:f,eventPopoverOptions:p}=t;delete t.addUrl;let h=e=>{let t=(e,t)=>{let a;return"string"==typeof t&&(a=t.match(/^(\d{4}-\d{2}-\d{2}) (\d{2}:\d{2}:\d{2})/))?a[1]+"T"+a[2]:"allDay"==e?ew.convertToBool(t):"url"!=e||t?"display"!=e||t?"classNames"==e&&t&&l.default.isString(t)?t.replace(/\s+/g," ").split(" "):"classNames"!=e||t?("groupId"!=e||t)&&("description"!=e||t)?t:"":[""]:"auto":""};if(e.success){let l=e.action,o=e[i];Array.isArray(o)||(o=[o]);for(let e of o){for(let[t,a]of Object.entries(r))t!=a&&null!==a&&a in e&&(e[t]=e[a],delete e[a]);var a;if(l==ew.API_DELETE_ACTION)null==(a=n.getEventById(e.id))||a.remove();else if(l==ew.API_ADD_ACTION){for(let a in e){let n=Object.keys(r).find((e=>e===a)),i=e[a];n&&void 0!==i&&(e[n]=t(n,i))}n.addEvent(e)}else{let a=n.getEventById(e.id),i=e.groupId;for(let n in e){let l=Object.keys(r).find((e=>e===n)),o=t(l,e[n]);l&&void 0!==o?(o=t(l,o),"start"==l?a.setStart(o):"end"==l?a.setEnd(o):"allDay"==l?a.setAllDay(o):"description"==l?a.setExtendedProp(l,o):"id"==l||i||a.setProp(l,o)):o&&a.setExtendedProp(n,o)}}}}},m=e=>{let t=e.event,a=[t,...e.relatedEvents],n=t.id?ew.API_EDIT_ACTION:ew.API_ADD_ACTION;a.forEach((t=>g(t,n).then((t=>{t.success?h(t):e.revert()})).catch((t=>{console.log(t),e.revert()}))))},g=(e,t)=>new Promise(((a,n)=>{let o=e.toPlainObject({collapseExtendedProps:!0}),s={};for(let[e,t]of Object.entries(r))if(e in o){let a=o[e];t||(t=e),a instanceof Date?a=a.toISOString().slice(0,-5).replace(/T/," "):"string"==typeof a&&a.match(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/)?a=a.substring(0,19).replace(/T/," "):"boolean"==typeof a?a=a?"1":"0":"classNames"==e&&(a=Array.isArray(a)?a.join(" "):a),s[t]=a,delete o[e]}s={...s,...o};let d=t==ew.API_ADD_ACTION?ew.getApiUrl([t,i]):ew.getApiUrl([t,i,e.id]);l.default.post(d,s,(e=>a(e))).fail((e=>n(e)))})),w=e=>Object.keys(currentTable.fields).find((t=>currentTable.fields[t].name==e)),v=(e,t)=>{let a=e.split("?");return a[0]+=t?(a[0].endsWith("/")?"":"/")+t:"",a.join("?")},b=e=>{let t=o,a=new URLSearchParams;if(l.default.isObject(e)&&(e.startStr||e.endStr)){let t=w(r.start),n=w(r.end);t&&e.startStr&&a.set(t,e.startStr),n&&e.endStr&&a.set(n,e.endStr)}l.default.isString(e)&&e.match(/^\d+$/)&&(t=v(t,e));let n=a.toString();t+=n?"?"+n:"",ew.modalDialogShow({url:t,callback:h,json:!0,btn:ew.language.phrase("AddBtn"),caption:ew.language.phrase("AddLink")})},y=e=>ew.modalDialogShow({url:v(s,e),callback:h,json:!0,btn:null,caption:ew.language.phrase("ViewLink")});o&&(f.customButtons={add:{text:ew.language.phrase("AddEvent"),click:b}},f.headerToolbar.left+=" add");let _,E=e=>{let t={...bootstrap.Popover.Default,...p,trigger:"manual"},a=bootstrap.Popover.getOrCreateInstance(e.el,t),n=Array.from(document.querySelectorAll("script[data-name='event-popover']")).sort(((e,t)=>(e=parseInt(e.dataset.seq,10)||0)-(t=parseInt(t.dataset.seq,10)||0))).shift(),i=l.default.templates(n.text);e.event.setExtendedProp("timeSpan",ew.formatTimeSpan(e.event.start,e.event.end,e.event.allDay));let r=i.render(e.event,ew.jsRenderHelpers).trim();if(r){var o,s;let t=null!=(o=null==(s=Array.from(e.el.classList.values()).find((e=>e.match(/^event-([\w+]+)\b/))))?void 0:s.replace(/^event-/,"popover-"))?o:"popover-default";return a._templateFactory=null,a._config.title=e.event.title,a._config.content=r,a._config.customClass+=(a._config.customClass?" ":"")+"ew-event-popover "+t,a}return null},A=e=>{let t=0,a=0;if(e){let n=e.el.getBoundingClientRect(),i=e.jsEvent;t=n.left+i.offsetX,a=n.top+i.offsetY}return()=>({width:0,height:0,top:a,right:t,bottom:a,left:t})},S={getBoundingClientRect:A()};a&&t.useContextMenu&&(s||d||o&&c||u)&&(a.dataset.bsToggle="dropdown",document.addEventListener("keydown",(e=>"Escape"!==e.key||bootstrap.Dropdown.clearMenus())),_=bootstrap.Dropdown.getOrCreateInstance(a,{reference:S}),_._menu.querySelectorAll(".dropdown-item").forEach((e=>e.addEventListener("click",(e=>{let t=e.currentTarget.dataset,a=t.action,n=t.eventId;a&&n&&("view"==a&&s?y(n):"edit"==a&&d?(e=>{ew.modalDialogShow({url:v(d,e),callback:h,json:!0,btn:null,caption:ew.language.phrase("EditLink")})})(n):"copy"==a&&o&&c?b(n):"delete"==a&&u&&(e=>{ew.prompt(ew.language.phrase("DeleteEventConfirm"),(t=>{t&&ew.modalDialogShow({url:ew.setSearchParams(v(u,e),{action:"delete"}),callback:h,json:!0})}))})(n))})))));let T={element:e,options:ew.deepAssign(f,{drop:function(e){document.getElementById("remove-event").checked&&e.draggedEl.parentNode.removeChild(e.draggedEl)},select:e=>o&&b(e),eventReceive:m,eventDragStart:e=>{var t;return null==(t=bootstrap.Popover.getInstance(e.el))?void 0:t.hide()},eventDrop:m,eventResize:m,eventClick:e=>{var a;if(e.jsEvent.preventDefault(),2==e.jsEvent.button)_&&(null==(a=bootstrap.Popover.getInstance(e.el))||a.hide(),_.hide(),_._menu.querySelectorAll(".dropdown-item").forEach((a=>{a.dataset.eventId=e.event.id,a.classList.toggle("d-none",!t[a.dataset.action+"Url"])})),_._menu.querySelectorAll(".dropdown-item:not(.d-done)").length&&(S.getBoundingClientRect=A(e),_.show()));else if(e.event.url)window.open(e.event.url);else if(t.usePopover&&p.trigger.match(/\bclick\b/)){var n;null==(n=E(e))||n.toggle()}else t.showViewPageOnEventClick&&y(e.event.id)},eventMouseEnter:e=>{var a,n;null!=(a=_)&&a._isShown(_._menu)||"dayGridMonth"==e.view.type&&t.usePopover&&p.trigger.match(/\bhover\b/)&&(null==(n=E(e))||n.show())},eventMouseLeave:e=>{var a,n;null!=(a=_)&&a._isShown(_._menu)||"dayGridMonth"==e.view.type&&t.usePopover&&p.trigger.match(/\bhover\b/)&&(null==(n=bootstrap.Popover.getInstance(e.el))||n.hide())}})};return l.default(document).trigger("calendar",[T]),n=new window.FullCalendar.Calendar(e,T.options),n}};function ba(){return"serviceWorker"in navigator&&"PushManager"in window}function ya(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),a=window.atob(t),n=new Uint8Array(a.length);for(let e=0;e<a.length;++e)n[e]=a.charCodeAt(e);return n}async function _a(e,t){const a=e.getKey("p256dh"),n=e.getKey("auth"),l=(PushManager.supportedContentEncodings||["aesgcm"])[0];let r=new FormData;return r.set("endpoint",e.endpoint),r.set("publicKey",a?btoa(String.fromCharCode.apply(null,new Uint8Array(a))):null),r.set("authToken",n?btoa(String.fromCharCode.apply(null,new Uint8Array(n))):null),r.set("contentEncoding",l),(await i.default.fetch(t,{method:"POST",body:r})).json()}async function Ea(){var e;let t=i.default.getApiUrl([i.default.API_PUSH_NOTIFICATION_ACTION,i.default.API_PUSH_NOTIFICATION_SUBSCRIBE]),a=await navigator.serviceWorker.ready,n=await a.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:ya(i.default.PUSH_SERVER_PUBLIC_KEY)}),l=await _a(n,t);return null!=l&&null!=(e=l.error)&&e.description&&i.default.alert(l.error.description),l.success?n:null}async function Aa(){return(await navigator.serviceWorker.ready).pushManager.getSubscription()}function Sa(e){let t=l.default("#subscribe-notification").toggleClass("ew-enable-notification",!e).removeClass("disabled");t.find("i").toggleClass("fa-bell",!e).toggleClass("fa-bell-slash",!!e);let a=bootstrap.Tooltip.getInstance(t[0]);a&&(a._config.title=i.default.language.phrase(e?"DisableNotifications":"EnableNotifications"))}async function Ta(){if("denied"!==Notification.permission&&!i.default.IS_SYS_ADMIN){document.body.style.cursor="wait";try{var e,t;if("granted"===Notification.permission)Sa(null!=(e=await Aa())?e:await Ea()),null!=(t=document.getElementById("subscribe-notification"))&&t.classList.contains("ew-enable-notification")||i.default.showToast(i.default.language.phrase("NotificationsEnabled"),"success");else if("default"===Notification.permission&&"granted"==await Notification.requestPermission()){var a;Sa(await Ea()),null!=(a=document.getElementById("subscribe-notification"))&&a.classList.contains("ew-enable-notification")||i.default.showToast(i.default.language.phrase("NotificationsEnabled"),"success")}}catch(e){i.default.alert(e)}finally{document.body.style.cursor="default"}}return!1}async function Oa(){return l.default("#subscribe-notification").tooltip(),"granted"==Notification.permission?Sa(await Aa()):Sa(null),!0}async function Ia(){return i.default.prompt({html:i.default.language.phrase("DisableNotificationsConfirm")},(async e=>{if(e){document.body.style.cursor="wait";try{var t;let e=await Aa();await e.unsubscribe();let a=i.default.getApiUrl([i.default.API_PUSH_NOTIFICATION_ACTION,i.default.API_PUSH_NOTIFICATION_DELETE]),n=await _a(e,a);if(null!=n&&null!=(t=n.error)&&t.description)return i.default.alert(n.error.description),!1;n.success&&(Sa(null),i.default.showToast(i.default.language.phrase("NotificationsDisabled"),"success"))}catch(e){i.default.alert(e)}finally{document.body.style.cursor="default"}}})),!1}i.default.SERVICE_WORKER="sw.js",loadjs.ready("foot",(()=>{i.default.PUSH_SERVER_PUBLIC_KEY&&ba()?navigator.serviceWorker.register(i.default.PATH_BASE+i.default.SERVICE_WORKER,{scope:i.default.PATH_BASE}).then((()=>{Oa(),l.default("#subscribe-notification").on("click",(function(){this.classList.contains("ew-enable-notification")?Ta():Ia()}))})).catch((e=>console.log(e))):l.default("#subscribe-notification").addClass("d-none")}));var xa={__proto__:null,pushNotificationDialogShow:async function(e){let t=i.default.pushDialog||l.default("#ew-push-notification-dialog").on("shown.bs.modal",(e=>setTimeout((()=>{var t;return null==(t=e.target.querySelector(".modal-body .form-control"))?void 0:t.focus()}),200))).on("click",".modal-footer .btn-primary",(function(e){var a;e.preventDefault(),null!=(a=l.default(this).closest(".modal").find(".modal-body form").data("form"))&&a.submit()&&t.modal("hide")}));if(!t[0])return console.log("DIV #ew-push-notificatoin-dialog not found"),!1;if(!e.url)return console.log("Missing URL of Web Push API"),!1;let a=e.evt.currentTarget,n=l.default(a.form),r=t.find(".modal-body form"),o=r.data("form");if(r.data("all",!1),!n.find("input[name='key_m[]']:checked")[0]){let e=await i.default.prompt(i.default.language.phrase("SendPushNotificationsToAll"),(e=>e));if(r.data("all",e),!e)return}return o||(o=(new i.default.FormBuilder).setId(r.attr("id")).addFields([["title",i.default.Validators.required(i.default.language.phrase("PushNotificationFormTitle"))],["body",i.default.Validators.required(i.default.language.phrase("PushNotificationFormBody"))]]).setValidate((function(){return this.validateFields()})).setSubmit((function(){if(!this.validate())return!1;let t=[r.serialize(),r.data("all")?"":n.find("input[name='key_m[]']:checked").serialize()].join("&");return l.default.post(e.url,t,(e=>{var t;if(Array.isArray(e)){let t=e.reduce(((e,t)=>e+(t.success?1:0)),0),a=e.length-t;t>0&&0==a?i.default.alert(i.default.language.phrase("PushNotificationSuccess").replace("%s",t),"success"):0==t&&a>0?i.default.alert(i.default.language.phrase("PushNotificationFailure").replace("%f",a)):0==t&&0==a?i.default.alert(i.default.language.phrase("NoSubscriptions").replace("%f",a),"primary"):i.default.alert(i.default.language.phrase("PushNotificationSent").replace("%s",t).replace("%f",a),"primary")}else null!=e&&null!=(t=e.error)&&t.description&&i.default.alert(e.error.description)})),!0})).build(),r.data("form",o)),i.default.pushDialog=t.modal("hide").find(".modal-title").html(e.hdr||a.dataset.caption).end().modal("show"),!1},isPushNotificationSupported:ba,subscribeNotification:Ta,checkSubscription:Oa,unsubscribeNotification:Ia};function Ca(e){if(e.inited)return!0;let t=e.latlng,a=l.default("#"+e.id),n=e.useSingleMap,i=e.showAllMarkers,r=e.useMarkerClusterer,o=ew.maps[e.ext];if(n){let t=e.id.replace(/^mp\d*_/,"mp_");a=l.default("#"+t),a[0]||(a=l.default("<div></div>").attr("id",t).addClass("ew-single-map").height(e.singleMapHeight),e.singleMapWidth&&a.width(e.singleMapWidth),l.default(".ew-grid, .ew-multi-column-grid").first()[e.showMapOnTop?"before":"after"](a),e.map=o.createMap(a[0],e),a.data("map",e.map),a.data("ext",e.ext),a.data("bounds",i?o.createBounds():null),a.data("markerClusterer",r?o.createMarkerClusterer(e):null)),e=Object.assign(e,a.data())}else{if(!t)return a.addClass("d-none").html(e.status),!0;a.next(".ew-map-value").addClass("d-none"),e.map||(e.map=o.createMap(a[0],e))}return e.marker=o.createMarker(e),e.inited=!0,l.default(document).trigger("map",[e]),!0}function Pa(){l.default(".ew-single-map").each((function(){let e=l.default(this).data();ew.maps[e.ext].fitBounds(e)})),l.default(document).trigger("maps")}function Na(e){let t=l.default(".ew-map").filter((function(){return!e||l.default(this).data("ext")==e})).map((function(e){let t=l.default(this).data();if(t.inited)return Ca(t);if(t.id=this.id,t.address=(t.address||"").trim(),t.address){let a=t.geocodingDelay;return new Promise((n=>{l.default.later(e*a,null,(()=>{n(ew.maps[t.ext].geocode(t).then((e=>{t.latlng=e})).catch((e=>{t.status=e})).finally((()=>Ca(t))))}))}))}{let e=t.latitude,a=t.longitude;return e&&!isNaN(e)&&a&&!isNaN(a)&&(t.latlng=ew.maps[t.ext].createLatLng(e,a)),Ca(t)}})).get();return Promise.all(t).then(Pa)}l.default((function(){l.default("#ew-modal-dialog").on("load.ew",Na),l.default(document).on("preview.ew",Na)}));var Ra={__proto__:null,show:Ca,done:Pa,init:Na};ew.MOBILE_DETECT=new MobileDetect(window.navigator.userAgent),ew.IS_MOBILE=!!ew.MOBILE_DETECT.mobile(),window.exportCharts={},Object.assign(ew,{MultiPage:function(e){var t=this;this.$form=null,this.formID=e,this.pageIndex=1,this.maxPageIndex=0,this.minPageIndex=0,this.pageIndexes=[],this.$pages=null,this.$collapses=null,this.isTab=!1,this.isCollapse=!1,this.lastPageSubmit=!1,this.hideDisabledButton=!1,this.hideInactivePages=!1,this.lockTabs=!1,this.hideTabs=!1,this.showPagerTop=!1,this.showPagerBottom=!1,this.pagerTemplate='<nav><ul class="pagination"><li class="page-item previous ew-prev"><a href="#" class="page-link"><i class="fa-solid fa-angle-left"></i> {Prev}</a></li><li class="page-item next ew-next"><a href="#" class="page-link">{Next} <i class="fa-solid fa-angle-right"></i></a></li></ul></nav>';var a=function(e){e.preventDefault()},n=["lastPageSubmit","hideDisabledButton","hideInactivePages","lockTabs","hideTabs","showPagerTop","showPagerBottom","pagerTemplate"];this.set=function(){if(1==arguments.length&&l.default.isObject(arguments[0])){var e=arguments[0];for(var t in e){var a=t[0].toLowerCase()+t.substring(1);n.includes(a)&&(this[a]=e[t])}}},this.init=function(){var e=this.pagerTemplate.replace(/\{prev\}/i,ew.language.phrase("Prev")).replace(/\{next\}/i,ew.language.phrase("Next"));this.isTab?(this.showPagerTop&&this.$pages.closest(".ew-nav").before(e),this.showPagerBottom&&this.$pages.closest(".ew-nav").after(e),this.$form.find(".ew-prev").click((function(e){return t.$pages.off("show.bs.tab",a).filter(".active").parent().prev(":has([data-bs-toggle=tab]:not(.ew-hidden):not(.ew-disabled))").find("[data-bs-toggle=tab]").toggleClass("disabled d-none",!1).click(),!1})),this.$form.find(".ew-next").click((function(e){return t.$pages.off("show.bs.tab",a).filter(".active").parent().next(":has([data-bs-toggle=tab]:not(.ew-hidden):not(.ew-disabled))").find("[data-bs-toggle=tab]").toggleClass("disabled d-none",!1).click(),!1})),this.hideTabs&&this.$form.find(".ew-multi-page > .ew-nav > .nav-tabs").hide()):this.isCollapse&&(this.showPagerTop&&this.$collapses.closest(".ew-accordion").before(e),this.showPagerBottom&&this.$collapses.closest(".ew-accordion").after(e),this.$form.find(".ew-prev").click((function(e){return t.$pages.closest(".accordion-item").filter(":has(.collapse.show)").prev(":has([data-bs-toggle=collapse]:not(.ew-hidden):not(.ew-disabled))").toggleClass("disabled d-none",!1).find("[data-bs-toggle=collapse]").click(),!1})),this.$form.find(".ew-next").click((function(e){return t.$pages.closest(".accordion-item").filter(":has(.collapse.show)").next(":has([data-bs-toggle=collapse]:not(.ew-hidden):not(.ew-disabled))").toggleClass("disabled d-none",!1).find("[data-bs-toggle=collapse]").click(),!1}))),this.pageShow()},this.pageShow=function(){this.isTab?(this.lockTabs&&this.$pages.on("show.bs.tab",a),this.$pages.each((function(){var e=l.default(this);t.hideInactivePages&&e.toggleClass("d-none",!e.hasClass("active")),t.lockTabs&&e.toggleClass("disabled",!e.hasClass("active"))}))):this.isCollapse&&this.$pages.closest(".accordion-item").each((function(){var e=l.default(this);t.hideInactivePages&&e.toggleClass("d-none",!e.find(".collapse.show")[0])}));var e=this.lastPageSubmit&&this.pageIndex!=this.maxPageIndex,n=this.$form.closest(".content, .modal-content").find("#btn-action, button.ew-submit").prop("disabled",e).toggle(!this.hideDisabledButton||!e);l.default(".ew-captcha").toggle(n.is(":visible:not(:disabled)")),e=this.pageIndex<=this.minPageIndex,this.$form.find(".ew-prev").toggleClass("disabled",e),e=this.pageIndex>=this.maxPageIndex,this.$form.find(".ew-next").toggleClass("disabled",e)},this.gotoPage=function(e){if(!(e<=0||e<this.minPageIndex||e>this.maxPageIndex)&&this.pageIndex!=e){var t=this.$pages.eq(e-1);if(this.isTab)t.is(":not(.d-none):not(.disabled)")?t.click():t.parent().next(":has([data-bs-toggle=tab]):not(.d-none):not(.disabled)").find("[data-bs-toggle=tab]").toggleClass("disabled",!1).click();else if(this.isCollapse){var a=t.closest(".accordion-item");a.is(":not(.d-none)")?t.click():a.next(":has([data-bs-toggle=collapse]):not(.d-none)").find("[data-bs-toggle=collapse]").click()}this.pageIndex=e}},this.gotoPageByIndex=this.gotoPage,this.gotoPageByElement=function(e){this.gotoPage(parseInt(l.default(e).data("page"),10)||-1)},this.gotoPageByElementId=function(e){var t=this.$form.find("[data-page]").filter("[id='"+e+"'],[name='"+e+"'],[data-field='"+e+"']");this.gotoPageByElement(t)},this.togglePage=function(e,t){this.isTab?this.$pages.eq(e-1).toggleClass("d-none",!t):this.isCollapse&&this.$pages.eq(e-1).closest(".accordion-item").toggle("d-none",!t)},this.render=function(){this.$form=l.default("#"+e),this.pageIndexes=this.$form.find("[data-page]").map((function(){var e=parseInt(this.dataset.page,10);return e>0?e:null})).get(),this.pageIndexes.sort((function(e,t){return e-t})),this.minPageIndex=this.pageIndexes[0],this.maxPageIndex=this.pageIndexes[this.pageIndexes.length-1];var a=this.$form.find("[data-bs-toggle=tab]");if(a[0])this.$pages=a,this.isTab=!0,a.on("shown.bs.tab",(function(e){t.pageIndex=a.index(e.target)+1,t.pageShow(),l.default(l.default(this).attr("href")).find(".ew-map").each((function(){var e=ew.maps[this.id];null!=e&&e.map&&(google.maps.event.trigger(e.map,"resize"),e.map.setCenter(e.latlng))}))})),this.pageIndex=a.index(a.parent(".active"))+1;else if(this.$collapses=this.$form.find("[data-bs-toggle=collapse]"),this.$collapses[0]){this.$pages=this.$collapses,this.isCollapse=!0;var n=this.$collapses;n.on("shown.bs.collapse",(function(e){t.pageIndex=n.index(e.target)+1,t.pageShow(),l.default(this).find(".ew-map").each((function(){var e=ew.maps[this.id];null!=e&&e.map&&(google.maps.event.trigger(e.map,"resize"),e.map.setCenter(e.latlng))}))})),this.pageIndex=n.index(n.hasClass("show"))+1}l.default((function(){t.init()}))}},Form:_,FormBuilder:E,Validators:s,maps:Ra},wa,xa,va);var La=l.default(document);loadjs.ready("load",(function(){l.default.views.settings.debugMode(ew.DEBUG),ew.setSessionTimer(),ew.initPage(),l.default("#ew-modal-dialog").on("load.ew",ew.initPage),l.default("#ew-add-opt-dialog").on("load.ew",ew.initPage);var e=ew.currentUrl.searchParams.get("hash");e&&l.default("html, body").animate({scrollTop:l.default("#"+e).offset().top},800),La.trigger("load.ew")})),La.on("addoption",(function(e,t){let a=t.data,n=t.parents;for(let e=0,i=n.length;e<i;e++){let i=n[e];if(!i.length)return t.valid=!1;let r=a["ff"+(e>0?e+1:"")];if(!l.default.isUndefined(r)&&!i.includes(String(r)))return t.valid=!1}})),La.on("click","[data-ew-action]:not([data-ew-action=''])",(function(e){let t=Object.assign({},l.default(this).data()),a=t.ewAction;if(!a)return!0;if("none"==a)return!1;if("redirect"==a)return ew.redirect(t.url);if("reload"==a)return location.reload(),!1;if("submit"==a)return delete t.ewAction,ew.submitAction(e,t);if("modal"==a)return e.preventDefault(),t.ajax?ew.inlineAction({evt:e,...t}):ew.modalDialogShow({evt:e,...t});if("inline"==a||"grid"==a)return e.preventDefault(),ew.inlineAction({evt:e,...t});if("export"==a)return ew.export({evt:e,...t});if("layout"==a)return ew.toggleLayout(this);if("language"==a)return ew.setLanguage(this);if("filter"==a)return ew.filter(e);if("sort"==a)return ew.sort(e,this.dataset);if("refresh"==a){let e=ew.setLayout(this.dataset.url,!1);return e&&"#"!=e&&ew.refresh(fetch(e),this.dataset.context),!1}if("email"==a)return delete t.ewAction,ew.emailDialogShow({evt:e,...t});if("set-action"==a)this.form.elements.action.value=t.value;else{if("drilldown"==a)return ew.showDrillDown(e,this,t.url,t.id,t.hdr);if("add-option"==a)return delete t.ewAction,ew.addOptionDialogShow({evt:e,...t});if("search-type"==a)return ew.setSearchType(this);if("search-operator"==a)ew.toggleSearchOperator(e,t.target,t.value);else if("search-toggle"==a){let e=document.getElementById(this.dataset.form+"_search_panel");e&&(bootstrap.Collapse.getOrCreateInstance(e).toggle(),this.classList.toggle("active"))}else if("highlight"==a)l.default("mark."+this.dataset.name).toggleClass("mark"),this.classList.toggle("active");else{if("inline-delete"==a)return ew.confirmDelete(this);if("add-grid-row"==a)return ew.addGridRow(this);if("delete-grid-row"==a)return ew.deleteGridRow(this,this.dataset.rowindex);if("select-all"==a)ew.selectAll(this);else if("select-key"==a)ew.selectKey(e);else if("select-all-keys"==a)ew.selectAllKeys(this);else{if("import"==a)return ew.importDialogShow({evt:e,hdr:t.hdr});if("password"==a)return ew.togglePassword(e);if("push"==a)return ew.pushNotificationDialogShow({evt:e,url:t.apiUrl});if("enable-2fa"==a)return ew.enable2FA();if("disable-2fa"==a)return ew.disable2FA();var n;if("send-otp"==a)return ew.sendOTP(null==(n=document.getElementById(t.account))?void 0:n.value);if("backup-codes"==a)return ew.showBackupCodes();if("scroll-top"==a)return l.default(document).scrollTop(l.default("#top").offset().top),!1}}}})).on("change","[data-ew-action]:not([data-ew-action=''])",(function(e){let t=Object.assign({},l.default(this).data());if(!t.ewAction)return!0;let a=t.ewAction.split(" ").filter((e=>!!e));for(let e of a)if("submit-form"==e){var n;null==(n=this.form)||n.submit()}else{if("change-page-size"==e){let e=ew.sameText(this.value,"ALL")?"ALL":ew.parseNumber(this.value);if(ew.convertToBool(t.ajax)){let t=ew.setLayout(this.dataset.url,!1)+"&"+this.name+"="+e;ew.refresh(fetch(t),this.dataset.context)}else{let t=ew.setSearchParam(this.dataset.url,this.name,e);ew.redirect(t)}return!1}if("update-options"==e)ew.updateOptions.call(this);else if("autofill"==e)ew.autoFill(this);else{if("search-operator"==e)return ew.searchOperatorChange(this);"language"==e?ew.setLanguage(this):"chart-order"==e&&ew.updateChart(this)}}})).on("keydown","[data-ew-action]:not([data-ew-action=''])",(function(e){let t=Object.assign({},l.default(this).data());if("change-page"==t.ewAction&&"Enter"==e.key){if(ew.convertToBool(t.ajax)){let e=ew.setLayout(this.dataset.url,!1)+"&"+this.name+"="+ew.parseNumber(this.value);ew.refresh(fetch(e),this.dataset.context)}else ew.currentUrl.searchParams.set(this.name,ew.parseNumber(this.value)),window.location=ew.sanitizeUrl(ew.currentUrl.toString());return!1}})),La.on("click",".ew-row-link",(e=>e.stopPropagation())),La.on("show.bs.modal",".modal",(function(){var e=1050+l.default(".modal:visible").length;l.default(this).css("z-index",e),setTimeout((function(){l.default(".modal-backdrop").not(".modal-stack").css("z-index",e-1).addClass("modal-stack")}),0)})),La.on("hidden.bs.modal",".modal",(function(){l.default(".modal:visible").length&&l.default("body").addClass("modal-open")})),l.default.blueimp.fileupload.prototype.options.processQueue.unshift({action:"cropImage",fileTypes:"@loadImageFileTypes",maxFileSize:"@loadImageMaxFileSize",cropperOptions:"@",cropperCanvasOptions:"@",disabled:"@disableImageCrop"}),l.default.widget("blueimp.fileupload",l.default.blueimp.fileupload,{processActions:{cropImage:function(e,t){let a=e.files[e.index];if(t.disabled||l.default.isNumber(t.maxFileSize)&&a.size>t.maxFileSize||t.fileTypes&&!t.fileTypes.test(a.type))return e;let n=URL.createObjectURL(a),i=l.default.Deferred(),r=this,o=ew.cropperDialog||l.default("#ew-cropper-dialog").on("shown.bs.modal",(function(){o.data("cropper",new Cropper(this.querySelector("#ew-crop-image"),t.cropperOptions))})).on("hidden.bs.modal",(function(){var e;null==(e=o.data("cropper"))||e.destroy(),o.removeData("cropper"),o.find("#ew-crop-image").attr("src","data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=")}));return ew.cropperDialog=o,o.find("#ew-crop-image").attr("src",n),o.find(".ew-crop-btn").off("click").on("click",(function(){if(o.data("cropper"))try{o.data("cropper").getCroppedCanvas(t.cropperCanvasOptions).toBlob((t=>{e.files[e.index]=new File([t],a.name,{type:a.type}),i.resolveWith(r,[e])}),a.type)}catch(t){ew.alert(t),i.rejectWith(r,[e])}finally{o.modal("hide")}})),o.find(".ew-skip-btn").off("click").on("click",(function(){i.resolveWith(r,[e]),o.modal("hide")})),o.modal("show"),i.promise()}}}),l.default.extend({isBoolean:function(e){return"boolean"==typeof e},isNumber:function(e){return"number"==typeof e&&isFinite(e)},isObject:function(e){return e&&("object"==typeof e||this.isFunction(e))||!1},isString:function(e){return"string"==typeof e},isUndefined:function(e){return"undefined"==typeof e},isValue:function(e){return this.isObject(e)||this.isString(e)||this.isNumber(e)||this.isBoolean(e)},isDate:function(e){return"date"===this.type(e)&&"Invalid Date"!==e.toString()&&!isNaN(e)},later:function(e,t,a,n,i){e=e||0,t=t||{};var l,r,o=a,s=n;if(this.isString(a)&&(o=t[a]),o)return this.isUndefined(n)||this.isArray(s)||(s=[n]),l=function(){o.apply(t,s||[])},r=i?setInterval(l,e):setTimeout(l,e),{interval:i,cancel:function(){this.interval?clearInterval(r):clearTimeout(r)}}}}),l.default.fn.fields=function(e){let t,a,n,i={},r=this.attr("id"),o=this[0],s=r.match(/^[xy](\d*)_/);s?(t=ew.getForm(o),a=this.data("table"),n=s[1]):null!=o&&o.htmlForm&&(t=o.$element,a=o.id.replace(new RegExp("^f|"+o.pageId+"$","g"),""),n=o.htmlForm.dataset.rowindex);let d="[data-table"+(a?"="+a:"")+"][data-field"+(e?"=x_"+e:"")+"]"+(l.default.isValue(n)?"[name^=x"+n+"]":"")+":not(.ew-custom-option)";return t&&d&&l.default(t).find(d).each((function(){let e=this.dataset.field.substring(2),t=this.getAttribute("name");e=/^y_/.test(t)?"y_"+e:e,i[e]=i[e]?i[e].add(this):l.default(this)})),e?i[e]:i},l.default.fn.extend({row:function(){var e;let t=this.closest("#r_"+(null==(e=this.data("field"))?void 0:e.substring(2)));return t[0]||(t=this.closest(".ew-table > tbody > tr")),t},visible:function(e){var t;let a=this.closest("#r_"+(null==(t=this.data("field"))?void 0:t.substring(2)));return a[0]||(a=this.closest("[id^=el]")),"undefined"!=typeof e?(a.toggle(e),this):$el.is(":visible")},readonly:function(e){return"undefined"!=typeof e?(this.prop("readOnly",e),this):this.prop("readOnly")},disabled:function(e){return"undefined"!=typeof e?(this.prop("disabled",e),this):this.prop("disabled")},value:function(e){return"undefined"!=typeof e?(ew.selectOption(this[0],e),this):ew.getValue(this[0])},toNumber:function(){return ew.parseNumber(this.value())},toDate:function(){var e,t,a,n;let i=this.data(),l=i.table,r=i.field.replace(/^[xy]_/,""),o=null==(e=ew.vars.tables)||null==(t=e[l])||null==(a=t.fields)||null==(n=a[r])?void 0:n.clientFormatPattern;return ew.parseDateTime(this.value(),o)},toJsDate:function(){return this.toDate().toJSDate()}}),bootstrap.Dropdown.prototype.toggle=function(){if(!this._element.classList.contains("ew-dropdown-toggle")){if(this._element.closest("[data-widget]")&&l.default(this._element).on("click.ew.dropdown",(e=>{bootstrap.Dropdown.clearMenus(e.originalEvent),e.stopPropagation()})),this._menu.closest(".table-responsive")){this._menu.closest(".popover-body, .modal-body, .offcanvas-body, body").appendChild(this._menu);let e=this._menu;function t(t){t.forEach((t=>{if("attributes"===t.type)t.target.classList.contains("show")?e.classList.add("d-block"):e.classList.remove("d-block")}))}this._element.id||(this._element.id="dropdownbtn"+ew.random()),e.setAttribute("aria-labelledby",this._element.id),new MutationObserver(t).observe(this._parent,{attributeFilter:["class"],attributeOldValue:!1,subtree:!1})}this._element.classList.add("ew-dropdown-toggle")}return this._isShown()?this.hide():this.show()};var Fa=e=>null==e,ka=e=>"function"==typeof e,Da=e=>"number"==typeof e&&isNaN(e),Ma=e=>"number"==typeof e&&isFinite(e);var ja=(e,t)=>{if(!Ma(e))return NaN;const a=""+e,n=a.indexOf("e");return-1===n?+(a+"e"+t):+(a.slice(0,n)+"e"+(+a.slice(n+1)+t))};var $a=e=>Math.round(Math.log(e)*Math.LOG10E);var Ua=(e,t)=>{const a={};for(let n=0;n<e.length;++n)if(n in e){const[i,l]=t(e[n],n);a[i]=l}return a};var Ba=e=>e.replace(/[.*+?^${}()|[\]\\]/g,(e=>`\\${e}`));var Va=e=>{const t={};return function(...a){const n=a.length>1?a.join("-(:-:)-"):a[0];if(n in t)return t[n];const i=e.apply(this,a);return t[n]=i,i}};const Ka=(()=>{const e={};let t,a="";for(;t!==1/0;)t=+("1"+a),e[t]=!0,a+="0";for(a="",t=void 0;0!==t;)t=+("0."+a+"1"),e[t]=!0,a+="0";return e})();var qa=e=>!!Ka[e];const Ha=(e,t,a)=>{if(!Ma(e)||t===a.base)return e;if(!(t in a.scale))return NaN;const n=a.scale[t]||1;return qa(n)?ja(e,$a(n)):e*n},Wa=(e,t,a,n)=>{if(!Ma(e)||t===a)return e;const i=Ha(e,t,n),l=Object.assign(Object.assign({},n.scale),{[n.base]:1});if(isNaN(i)||!(t in l)||!(a in l))return NaN;const r=n.scale[a]||1;return qa(r)?ja(i,-$a(r)):i/r},Ga=e=>({toBase:(t,a)=>Ha(t,a,e),convert:(t,a,n)=>Wa(t,a,n,e),toBest:(t,a,n)=>((e,t,a,n)=>{const i=Object.assign({exclude:[],cutOffNumber:1},n);let l=null;const r=a.scale;return Object.keys(r).sort(((e,t)=>r[e]-r[t])).forEach((n=>{if(-1!==i.exclude.indexOf(n))return;const r=Wa(e,t,n,a),o=Math.abs(r);(!l||o>=i.cutOffNumber&&o<Math.abs(l[0]))&&(l=[r,n])})),l||[e,t]})(t,a,e,n),scaleDefinition:e});var Ya=(e,t)=>{if(t<1)return"";let a="",n=e;for(;t>1;)1&t&&(a+=n),t>>>=1,n+=n;return a+n};var za=Va((e=>{if(!e)return Ga({base:"",scale:{}});const t=e.split("|"),a={"":1};return t.forEach(((e,t)=>{e&&(a[e]=+(1+Ya("0",t)))})),Ga({base:"",scale:a})}));var Ja=(e,t)=>{var a;const n=t.locale,i=e;let l;const r=((e,t)=>{if(!t||10!==t.length)return e;const a=e.length,n=Ua(t,((e,t)=>[e.replace(/\u200e/g,""),""+t]));let i="";for(let t=0;t<a;t++){const a=e[t];i+=n[a]||a}return i})(e,null===(a=t.locale)||void 0===a?void 0:a.numeralSystem);if(t.zeroFormat&&r===t.zeroFormat)l=0;else if(t.nullFormat&&r===t.nullFormat||!r.replace(/[^0-9]+/g,"").length)l=null;else{const e=n.delimiters.decimal,a="."===e?r:r.replace(/\./g,"").replace(e,"."),o=((e,t)=>{var a;const n=za(null===(a=t.locale)||void 0===a?void 0:a.abbreviations),i=Object.keys(n.scaleDefinition.scale).sort(((e,t)=>t.length-e.length));let l=1;for(const t of i){const a=Ba(t),i=new RegExp(`[^a-zA-Z](${a})|(${a.replace(/\u200e/g,"")})(?:\\)(?:\\))?)?$`);if(e.match(i)){l=n.toBase(l,t);break}}return l})(i,t),s=(a.split("-").length+Math.min(a.split("(").length-1,a.split(")").length-1))%2?1:-1,d=a.replace(/[^0-9.]+/g,"");l=s*ja(+d,$a(o))}return l};var Xa={code:"en",delimiters:{thousands:",",decimal:"."},abbreviations:"|||K|||M|||B|||T",ordinal:e=>{const t=e%10;return 1===Math.floor(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"}};function Za(...e){const t={},a=e.length;for(let n=0;n<a;n++)for(const a in e[n])t[a]=e[n][a];return t}var Qa=e=>"object"==typeof e&&null!==e,en=e=>"string"==typeof e;var tn=e=>e<0?Math.ceil(e):Math.floor(e);const an=e=>{let t=!1,a="";const n=[];for(let i=0;i<e.length;i++){const l=e.charAt(i);"'"!==l||t?"'"===l&&t&&"\\"!==e.charAt(i-1)?(t=!1,n.push({escaped:!0,value:a})):t?a+=l:n.length&&!n[n.length-1].escaped?n[n.length-1].value+=l:n.push({escaped:!1,value:l}):(t=!0,a="")}return n},nn=(e,t)=>-1!==rn(e).indexOf(t),ln=(e,t,a)=>an(e).map((e=>e.escaped?`'${e.value}'`:e.value.replace(t,(e=>a)))).join(""),rn=e=>an(e).filter((e=>!e.escaped)).map((e=>e.value)).join("");var on=(e,t)=>-1!==e.indexOf(t);var sn=e=>{const t=rn(e),a=on(t,"(")&&on(t,")"),n=!a&&on(t,"+");let i=e;return i=ln(i,"(","'nps'"),i=ln(i,")","'npe'"),i=ln(i,/(-|\+)/,"'s'"),[i,{negativeParentheses:a,forceSign:n}]};var dn=e=>{let t=null,a=!1;if(nn(e,"a")){a=!0;const n=rn(e).match(/a(k|m|b|t)?/);t=n?n[1]:null}let n=e;return n=ln(n,/a(k|m|b|t)?/,"'a'"),[n,{compact:a,compactUnit:t,compactAuto:a&&!t}]};var un=(e,t)=>{if(!e)return["",""];const a=e.indexOf(t);return-1===a?[e,""]:[e.slice(0,a),e.slice(a+1)]};const cn=(e,t)=>e?e.split("").filter((e=>e===t)).length:0;var fn=e=>{const t=rn(e),a=un(t,".")[1];let n=0,i=0;if(a){const e=a.trim();if(on(e,"[")){const t=e.replace("]",""),a=un(t,"[");n=cn(a[0],"0"),i=n+cn(a[1],"0")}else if(on(e,"#"))n=cn(e.split("#")[0],"0"),i=e.length;else if(on(e,"X"))n=cn(e.split("X")[0],"0"),i=500;else{const t=cn(e.split(" ")[0],"0");n=t,i=t}}return{minimumFractionDigits:n,maximumFractionDigits:i}};var pn=e=>{let t=!1,a=e;return nn(e,"[.]")&&(t=!0,a=ln(a,"[.]",".")),[a,{optionalFractionDigits:t}]};var hn=Va((e=>{const t=en(e)&&e||"0,0.##########",[a,n]=sn(t),[i,l]=dn(a),[r,o]=pn(i),s=r,d=rn(s),u=fn(s),c=(e=>{const t=rn(e).split(".")[0].split(",")[0];return/#/g.test(t)?0:(t.match(/0/g)||[]).length})(s),f=d.indexOf(",")>-1,p=(e=>ln(e,/((((0|#)+,)?(0|#)+(\.([0#X]|\[0+\])+)?){1})/,"'n'"))(s),h=(e=>on(e,"'s'")||on(e,"'nps'")?e:e.replace("'n'",(e=>"'s''n'")))(p),m=h;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n),l),o),u),{grouping:f,minimumIntegerDigits:c,patternMask:m})}));var mn=e=>"-"===e[0]?e.slice(1):e;var gn=(e,t,a,n)=>{const{compact:i,compactAuto:l}=a,{abbreviations:r}=n.locale;if(!i||!l)return[e,t];const o=za(r),[s,d]=o.toBest(e,t||"");return[s,d]};var wn=(e,t,a)=>{const{compact:n,compactUnit:i}=t,{abbreviations:l}=a.locale;if(!n)return[e,null];if(i)return((e,t,a)=>{const n={k:3,m:6,b:9,t:12}[e],i=(null==t?void 0:t.split("|"))||[];let l=null;for(let e=0;e<i.length;e++)if(i[n-e]){l=n-e;break}return null===l?[a,null]:[ja(a,-l),i[l]]})(i,l,e);const r=za(l),[o,s]=r.toBest(e,"");return[o,s||null]};var vn=(e,t,a)=>{const n=t||0,i=(a||Math.round)(ja(e,n));return ja(i,-n)};var bn=e=>{const t=(e||0).toString();if(!(t.indexOf("e")>=0))return t;const[a,n]=un(t,"e"),i=+n;return i>=0?(e=>{const[t,a]=un(e,"e"),n=+a;if(n<0)return e;const[i,l]=un(t,"."),r=n-l.length;return`${i}${l}${Ya("0",r)}`})(t):((e,t,a)=>{const n=Math.abs(t),[i,l]=un(a,".");let r="-"===i[0]?i.slice(1):i,o=l;for(let e=0;e<n;e+=1){const e=r[0]||"";r=r.slice(0,r.length-1),o=(e||"0")+o}return`${e<0?"-":""}${r||0}.${o}`})(e,i,a)};var yn=(e,t,a,n)=>{const i=bn(e),l=t-(n||0),r=un(i,".")[1],o=r?Math.min(Math.max(r.length,l),t):l,s=vn(e,o,a);let d=bn(s);return l&&(d=((e,t)=>{const[a,n]=un(e,".");return`${a}.${n+Ya("0",t-n.length)}`})(d,l)),d};var _n=(e,t,a)=>{const{rounding:n}=a,{minimumFractionDigits:i,maximumFractionDigits:l}=t,r=n||Math.round;if(i>0||l>0){return yn(e,l,r,l-i)}return yn(e,0,r)};var En=(e,t)=>{if(!t||10!==t.length)return e;const a=e.length;let n="";for(let i=0;i<a;i++){const a=e[i];n+=t[a]||a}return n};var An=(e,t)=>{const{minimumIntegerDigits:a}=t;return 0===a&&+e<1&&+e>-1?"":e.length>=a?e:`${Ya("0",a-e.length)}${e}`};var Sn=(e,t,a,n)=>{const{negativeParentheses:i,forceSign:l}=n;let r=e;return i&&t?r=r.replace(/'(nps|npe)'/g,(e=>"'nps'"===e?"(":")")):l?r=r.replace("'s'",t?"-":a?"":"+"):t&&(r=r.replace("'s'","-")),r};var Tn=(e,t)=>{const{optionalFractionDigits:a}=t,[n,i]=un(e,".");return a&&0===Number(i)?[n,""]:[n,i]};var On=(e,t,a)=>{const{delimiters:n,digitGroupingStyle:i}=a.locale,{grouping:l}=t;if(!l||!n.thousands)return e;const r=e,o=n.thousands,s=[...(null==i?void 0:i.length)?i:[3]];let d="",u=1;for(let e=r.length-1;e>=0;e--)u===s[0]&&0!==e?(d=o+r[e]+d,s.length>1&&s.shift(),u=1):(d=r[e]+d,u+=1);return d};var In=(e,t,a)=>a?t?e.replace("'a'",(e=>`'${t.replace(/'/g,(e=>"\\'"))}'`)):e.match(/'n'\s*'a'/)?e.replace(/\s*'a'/,""):e.replace(/'a'\s*/,""):e;var xn=(e,t,a)=>{var n;const i=hn(t),l=Ma(e)?e:0,[r,o]=((e,t,a)=>{if(!t.compact)return[_n(e,t,a),null];const[n,i]=wn(e,t,a),l=+_n(n,t,a),[r,o]=gn(+l,i,t,a);return[_n(r,t,a),o]})(l,i,a);if("NaN"===r)return"";const s=a.signedZero?e<0:+r<0,d=a.signedZero?0===e:0==+r,u=mn(r),[c,f]=Tn(u,i),p=An(c,i),h=On(p,i,a),m=a.locale.numeralSystem,g=En(h,m),w=En(f,m),v=g+(w?((null===(n=a.locale.delimiters)||void 0===n?void 0:n.decimal)||".")+w:""),b=In(i.patternMask,o,i.compact).replace("'n'",(e=>`'${v.replace(/'/g,"\\'")}'`)),y=Sn(b,s,d,i).replace(/'(nps|npe|s|a|n)'/g,"");return an(y).map((e=>e.escaped?e.value.replace(/\\'/g,"'"):e.value)).join("")};var Cn={name:"bps",regexps:{format:/BPS/,unformat:/BPS/},format:(e,t,a)=>{const n=ja(e,4),i=ln(t,/BPS/,"'BPS'");return xn(n,i,a).replace("BPS","BPS")},unformat:(e,t)=>{const a=Ja(e.replace(/\s?BPS/,""),t);return Ma(a)?ja(a,-4):a}};var Pn={name:"time",regexps:{format:/([0-9]{1,2}:[0-9]{2}) *$/,unformat:/([0-9]{1,2}:[0-9]{2}) *$/},format:e=>{const t=Math.abs(e),a=e<0?"-":"",n=tn(t/3600),i=tn((t-3600*n)/60),l=tn(t-3600*n-60*i);return`${a}${n}:${(i<10?"0":"")+i}:${(l<10?"0":"")+l}`},unformat:e=>{const t=/^ *-/.test(e),a=e.replace(/^ *-/,"").split(":").reverse();let n=0;return n+=+a[0],n+=60*+a[1],n+=3600*(+a[2]||0),t&&0!==n?-n:n}};const Nn=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],Rn=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],Ln=`(${Nn.concat(Rn.slice(1)).join("|").replace(/B/g,"B(?!PS)")})`,Fn=Ga({base:"B",scale:Ua(Nn,((e,t)=>[e,Math.pow(1e3,t)]))}),kn=Ga({base:"B",scale:Ua(Rn,((e,t)=>[e,Math.pow(1024,t)]))});const Dn={EUR:"",USD:"$",XCD:"EC$",AUD:"A$",INR:"",BRL:"R$",CAD:"CA$",XAF:"FCFA",CNY:"CN",NZD:"NZ$",XPF:"CFPF",GBP:"",HKD:"HK$",ILS:"",JPY:"",KRW:"",XOF:"CFA",MXN:"MX$",TWD:"NT$",VND:""};var Mn=[{name:"percentage",regexps:{format:/%!?/,unformat:/%/},format:(e,t,a)=>{const n=nn(t,"%!"),i=a.scalePercentage&&!n?ja(e,2):e,l=ln(t,/%!?/,"'%'");return xn(i,l,a).replace("%","%")},unformat:(e,t)=>{const a=Ja(e.replace(/\s?%/,""),t);return a&&t.scalePercentage?ja(a,-2):a}},{name:"currency",regexps:{format:/(\$)/},format:(e,t,a)=>{var n;const i=null===(n=a.currency)||void 0===n?void 0:n.toUpperCase(),l=Dn[i]||i||"",r=ln(t,/\$/,"'currency'");return xn(e,r,a).replace("currency",(e=>l))}},{name:"ordinal",regexps:{format:/o/},format:(e,t,a)=>{var n,i;const l=(null===(i=(n=a.locale).ordinal)||void 0===i?void 0:i.call(n,e))||"",r=ln(t,/o/,"'ord'");return xn(e,r,a).replace("ord",(e=>l))}},Pn,{name:"bytes",regexps:{format:/([0\s]b[bd])|(b[bd][0\s])/,unformat:(e,t)=>"bytes"===t.type&&new RegExp(Ln).test(e)},format:(e,t,a)=>{const n=nn(t,"bb")?kn:Fn,[i,l]=n.toBest(e,"B"),r=ln(t,/b[bd]/,"'bytes'");return xn(i,r,a).replace("bytes",l||"")},unformat:(e,t)=>{var a;const n=Ja(e.replace(new RegExp(Ln),""),t),i=(null===(a=e.match(Ln))||void 0===a?void 0:a[0])||"",l=kn.scaleDefinition.scale[i]?kn:Fn;return n?l.toBase(n,i):n}},{name:"exponential",regexps:{format:/[eE][+-][0-9]+/,unformat:/[eE][+-][0-9]+/},format:(e,t,a)=>{const n="number"!=typeof e||Da(e)?"0e+0":e.toExponential(),i=un(n,"e"),l=ln(t,/e[+|-]{1}0/i,"");return xn(+i[0],l,a)+"e"+i[1]},unformat:(e,t)=>{var a;const n=Ja(e.replace(/e[+-]{1}[0-9]{1,3}/i,""),t),i=+((null===(a=e.match(/e([+-]{1}[0-9]{1,3})/i))||void 0===a?void 0:a[1])||"0");return Ma(n)?ja(n,i):n}},Cn];var jn=e=>e>=0?Math.round(e):e%.5==0?Math.floor(e):Math.round(e);var $n=e=>{var t,a,n;const i=e||{},l=(e=>{switch(e){case"ceil":return Math.ceil;case"floor":return Math.floor;case"truncate":return tn;case"half-up":return Math.round;case"half-away-from-zero":return jn;default:return ka(e)?e:jn}})(i.rounding),r=(e=>{const t=Xa;return Qa(e)?Za(e,{delimiters:(a=e.delimiters,(null==a?void 0:a.decimal)&&en(null==a?void 0:a.thousands)&&a.decimal!==a.thousands?e.delimiters:t.delimiters),abbreviations:e.abbreviations||t.abbreviations,ordinal:e.ordinal||t.ordinal}):t;var a})(i.locale),o=(s=i.formatters)?ka(s)?s(Mn):[...s,...Mn]:Mn;var s;return{defaultPattern:i.defaultPattern||"0,0.##########",nullFormat:i.nullFormat||"",nanFormat:i.nanFormat,zeroFormat:i.zeroFormat,locale:r,rounding:l,type:i.type,scalePercentage:null===(t=i.scalePercentage)||void 0===t||t,trim:null===(a=i.trim)||void 0===a||a,formatters:o,currency:i.currency,signedZero:!!i.signedZero,nonBreakingSpace:null!==(n=i.nonBreakingSpace)&&void 0!==n&&n}};var Un=(e,t)=>{const a=$n(t);let n;if(Fa(e)||Da(e))n=null;else if("number"==typeof e)n=0===e?0:e;else if("string"==typeof e)if(a.zeroFormat&&e===a.zeroFormat)n=0;else if(a.nullFormat&&e===a.nullFormat)n=null;else{const t=e.replace(/\u00A0/," "),i=((e,t)=>{for(const a of t.formatters){const n=a.regexps.unformat;if(n&&(ka(n)?n(e,t):e.match(n)))return a.unformat}})(t,a);n=(i||Ja)(t,a)}else{const t=+e;n=0===t?t:t||null}return n};var Bn=(e,t)=>Un(e,t);var Vn=(e,t,a)=>vn(e,t,a);var Kn=(e,t,a)=>{var n;try{const n=en(e)?parseFloat(e):e,i=$n(a),l=t||i.defaultPattern;let r;if(n===1/0||n===-1/0)r=n>0?"":"-";else{if(Da(n))return en(i.nanFormat)?i.nanFormat:en(i.nullFormat)?i.nullFormat:"";if(Fa(n))r=en(i.nullFormat)?i.nullFormat:"";else if(0===n&&en(i.zeroFormat))r=i.zeroFormat;else{const e=n||0,t=((e,t)=>{const a=rn(e);for(const n of t.formatters){const i=n.regexps.format;if(i&&(ka(i)?i(e,t):a.match(i)))return n.format}})(l,i);r=(t||xn)(e,l,i)}}return r=en(r)?r:"",r=i.nonBreakingSpace?r.replace(/ /g,(e=>"")):r,r=i.trim?r.trim():r,r}catch(e){return(null===(n=a)||void 0===n?void 0:n._errorFormat)||""}};function qn(e,t,a){const n=en(t)?t:null,i=Qa(t)?t:Qa(a)?a:{};return Kn(e,n,i)}qn.withOptions=e=>{const t=Za(e,{locale:ka(e.locale)?e.locale():e.locale});return(e,a,n)=>{const i=en(a)?a:null,l=Qa(a)?a:Qa(n)?n:{};return Kn(e,i,Za(t,l))}};var Hn=e=>e?e.filter(((e,t,a)=>a.indexOf(e)===t)):[];const Wn="---",Gn=new RegExp("^[^"+Wn+"]*?["+Wn+"]"),Yn=e=>(e=>Gn.test(e))(e)?e+"":e,zn=[],Jn=(e,t,a)=>{try{if("object"!=typeof Intl||!Intl||"function"!=typeof Intl.NumberFormat)return null;const n={notation:"compact",useGrouping:!1,compactDisplay:a},[i,l,r]=t.split("");let o="";for(let t=1;t<50;t++){const s=(+(1+Ya("0",t))).toLocaleString(e,n);if(new RegExp(`^${l}[^${i}]+$`).test(s))if("long"===a){const a=(+(2+Ya("0",t))).toLocaleString(e,n),i=s.replace(new RegExp(`${l}`,"g"),"").trim(),d=a.replace(new RegExp(`${r}`,"g"),"").trim();o+="|"+Yn(i)+":::"+Yn(d)}else{const e=s.replace(new RegExp(`${l}`,"g"),"").trim();o+="|"+Yn(e)}else o+="|"}let s=o,d=s.length;for(;d--&&"|"===s[d];)s=s.slice(0,-1);return s}catch(e){return null}};var Xn=Va((e=>{const t=e||"en",a=(e=>{try{const t=1234567890..toLocaleString(e,{useGrouping:!1}),a={},n=t.split("").find((e=>{if(a[e])return!0;a[e]=!0})),i=(n?t.replace(new RegExp(Ba(n||""),"g"),""):t).split("");return[i[i.length-1],...i.slice(0,-1)].join("")}catch(e){return null}})(t),n=a||"0123456789",i=((e,t)=>{try{const a=12345678.123.toLocaleString(e).replace(new RegExp(`[${Ba(t)}]`,"g"),""),[n=",",i="."]=Hn(a.split(""));return[n,i]}catch(e){return null}})(t,n),[l,r]=i&&i.length>=2?i:[",","."],o=((e,t)=>{if(zn.some((t=>0===e.indexOf(t))))return[4];try{const a=[];let n=0;1e11.toLocaleString(e).split("").reverse().forEach((e=>{e===t?(a.push(n),n=0):n+=1}));let i=a.length;for(;i--&&a[i]===a[i-1];)a.pop();return a}catch(e){return null}})(t,l),s=Jn(t,n,"short");return{_abbreviationsLong:Jn(t,n,"long")||Xa.abbreviations,code:t,delimiters:{thousands:l,decimal:r},abbreviations:s||Xa.abbreviations,digitGroupingStyle:(null==o?void 0:o.length)?o:void 0,numeralSystem:"0123456789"!==a?null==a?void 0:a.split("").map(Yn):void 0,ordinal:Xa.ordinal}}));var Zn={__proto__:null,parse:Bn,round:Vn,format:qn,getLocaleFromPlatform:e=>Xn(e)};Object.assign(i.default,Zn)}(ew,jQuery,luxon);
//# sourceMappingURL=ew.min.js.map
